"use strict";!function(o){"object"==typeof module&&module.exports?module.exports=o.default=o:"function"==typeof define&&define.amd?define("highcharts/modules/annotations",["highcharts"],function(t){return o(t),o.Highcharts=t,o}):o("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function o(t,o,i,n){t.hasOwnProperty(o)||(t[o]=n.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:o,module:t[o]}})))}o(t=t?t._modules:{},"Extensions/Annotations/AnnotationChart.js",[t["Core/Utilities.js"]],function(n){function e(t,o){return t=this.initAnnotation(t),this.options.annotations.push(t.options),i(o,!0)&&(t.redraw(),t.graphic.attr({opacity:1})),t}function s(){var p=this;p.plotBoxClip=this.renderer.clipRect(this.plotBox),p.controlPointsGroup=p.renderer.g("control-points").attr({zIndex:99}).clip(p.plotBoxClip).add(),p.options.annotations.forEach(function(o,t){var i;p.annotations.some(function(t){return t.options===o})||(i=p.initAnnotation(o),p.options.annotations[t]=i.options)}),p.drawAnnotations(),c(p,"redraw",p.drawAnnotations),c(p,"destroy",function(){p.plotBoxClip.destroy(),p.controlPointsGroup.destroy()}),c(p,"exportData",function(r){var i=(this.options.exporting&&this.options.exporting.csv||{}).columnHeaderFormatter,n=!r.dataRows[1].xValues,e=p.options.lang&&p.options.lang.exportData&&p.options.lang.exportData.annotationHeader,h=r.dataRows[0].length,l=p.options.exporting&&p.options.exporting.csv&&p.options.exporting.csv.annotations&&p.options.exporting.csv.annotations.itemDelimiter,c=p.options.exporting&&p.options.exporting.csv&&p.options.exporting.csv.annotations&&p.options.exporting.csv.annotations.join,o=(p.annotations.forEach(function(t){t.options.labelOptions&&t.options.labelOptions.includeInDataExport&&t.labels.forEach(function(t){var a;t.options.text&&(a=t.options.text,t.points.forEach(function(t){var o=t.x,i=t.series.xAxis?t.series.xAxis.options.index:-1,n=!1;if(-1===i){t=r.dataRows[0].length;for(var e=Array(t),s=0;s<t;++s)e[s]="";e.push(a),e.xValues=[],e.xValues[i]=o,r.dataRows.push(e),n=!0}if(n||r.dataRows.forEach(function(t){!n&&t.xValues&&void 0!==i&&o===t.xValues[i]&&(c&&t.length>h?t[t.length-1]+=l+a:t.push(a),n=!0)}),!n){for(t=r.dataRows[0].length,e=Array(t),s=0;s<t;++s)e[s]="";e[0]=o,e.push(a),e.xValues=[],void 0!==i&&(e.xValues[i]=o),r.dataRows.push(e)}}))})}),0);r.dataRows.forEach(function(t){o=Math.max(o,t.length)});for(var t=o-r.dataRows[0].length,s=0;s<t;s++){var a=function(t){if(i){var o=i(t);if(!1!==o)return o}return o=e+" "+t,n?{columnTitle:o,topLevelColumnTitle:o}:o}(s+1);n?(r.dataRows[0].push(a.topLevelColumnTitle),r.dataRows[1].push(a.columnTitle)):r.dataRows[0].push(a)}})}function a(){this.plotBoxClip.attr(this.plotBox),this.annotations.forEach(function(t){t.redraw(),t.graphic.animate({opacity:1},t.animationConfig)})}function r(o){var t=this.annotations,i="annotations"===o.coll?o:u(t,function(t){return t.options.id===o});i&&(d(i,"remove"),p(this.options.annotations,i.options),p(t,i),i.destroy())}function h(){this.annotations=[],this.options.annotations||(this.options.annotations=[])}function l(t){this.chart.hasDraggedAnnotation||t.apply(this,Array.prototype.slice.call(arguments,1))}var t,c=n.addEvent,p=n.erase,u=n.find,d=n.fireEvent,i=n.pick,f=n.wrap,g=[];return(t||(t={})).compose=function(o,t,i){n.pushUnique(g,t)&&(c(t,"afterInit",h),(t=t.prototype).addAnnotation=e,t.callbacks.push(s),t.collectionsWithInit.annotations=[e],t.collectionsWithUpdate.push("annotations"),t.drawAnnotations=a,t.removeAnnotation=r,t.initAnnotation=function(t){return t=new(o.types[t.type]||o)(this,t),this.annotations.push(t),t}),n.pushUnique(g,i)&&f(i.prototype,"onContainerMouseDown",l)},t}),o(t,"Extensions/Annotations/AnnotationDefaults.js",[t["Core/Utilities.js"]],function(t){var o=t.defined;return{visible:!0,animation:{},crop:!0,draggable:"xy",labelOptions:{align:"center",allowOverlap:!1,backgroundColor:"rgba(0, 0, 0, 0.75)",borderColor:"#000000",borderRadius:3,borderWidth:1,className:"highcharts-no-tooltip",crop:!1,formatter:function(){return o(this.y)?""+this.y:"Annotation label"},includeInDataExport:!0,overflow:"justify",padding:5,shadow:!1,shape:"callout",style:{fontSize:"0.7em",fontWeight:"normal",color:"contrast"},useHTML:!1,verticalAlign:"bottom",x:0,y:-16},shapeOptions:{stroke:"rgba(0, 0, 0, 0.75)",strokeWidth:1,fill:"rgba(0, 0, 0, 0.75)",r:0,snap:2},controlPointOptions:{events:{},style:{cursor:"pointer",fill:"#ffffff",stroke:"#000000","stroke-width":2},height:10,symbol:"circle",visible:!1,width:10},events:{},zIndex:6}}),o(t,"Extensions/Annotations/EventEmitter.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(t,o){var s=t.doc,a=t.isTouchDevice,r=o.addEvent,h=o.fireEvent,e=o.objectEach,l=o.pick,i=o.removeEvent;return n.prototype.addEvents=function(){function o(t){r(t,a?"touchstart":"mousedown",function(t){n.onMouseDown(t)},{passive:!1})}var i,n=this;o(this.graphic.element),(n.labels||[]).forEach(function(t){t.options.useHTML&&t.graphic.text&&o(t.graphic.text.element)}),e(n.options.events,function(o,i){function t(t){"click"===i&&n.cancelClick||o.call(n,n.chart.pointer.normalize(t),n.target)}-1===(n.nonDOMEvents||[]).indexOf(i)?n.graphic.on(i,t):r(n,i,t,{passive:!1})}),n.options.draggable&&(r(n,"drag",n.onDrag),!n.graphic.renderer.styledMode)&&(i={cursor:{x:"ew-resize",y:"ns-resize",xy:"move"}[n.options.draggable]},n.graphic.css(i),(n.labels||[]).forEach(function(t){t.options.useHTML&&t.graphic.text&&t.graphic.text.css(i)})),n.isUpdating||h(n,"add")},n.prototype.destroy=function(){this.removeDocEvents(),i(this),this.hcEvents=null},n.prototype.mouseMoveToRadians=function(t,o,i){var n=t.prevChartY-i,e=t.prevChartX-o;return i=t.chartY-i,t=t.chartX-o,this.chart.inverted&&(o=e,e=n,n=o,o=t,t=i,i=o),Math.atan2(i,t)-Math.atan2(n,e)},n.prototype.mouseMoveToScale=function(t,o,i){return o=(t.chartX-o||1)/(t.prevChartX-o||1),t=(t.chartY-i||1)/(t.prevChartY-i||1),this.chart.inverted&&(i=t,t=o,o=i),{x:o,y:t}},n.prototype.mouseMoveToTranslation=function(t){var o,i=t.chartX-t.prevChartX;return t=t.chartY-t.prevChartY,this.chart.inverted&&(o=t,t=i,i=o),{x:i,y:t}},n.prototype.onDrag=function(t){var o;this.chart.isInsidePlot(t.chartX-this.chart.plotLeft,t.chartY-this.chart.plotTop,{visiblePlotOnly:!0})&&(o=this.mouseMoveToTranslation(t),"x"===this.options.draggable&&(o.y=0),"y"===this.options.draggable&&(o.x=0),this.points.length?this.translate(o.x,o.y):(this.shapes.forEach(function(t){return t.translate(o.x,o.y)}),this.labels.forEach(function(t){return t.translate(o.x,o.y)})),this.redraw(!1))},n.prototype.onMouseDown=function(t){var i,o,n,e;t.preventDefault&&t.preventDefault(),2!==t.button&&(o=(i=this).chart.pointer,n=(t=o.normalize(t)).chartX,e=t.chartY,i.cancelClick=!1,i.chart.hasDraggedAnnotation=!0,i.removeDrag=r(s,a?"touchmove":"mousemove",function(t){i.hasDragged=!0,(t=o.normalize(t)).prevChartX=n,t.prevChartY=e,h(i,"drag",t),n=t.chartX,e=t.chartY},a?{passive:!1}:void 0),i.removeMouseUp=r(s,a?"touchend":"mouseup",function(t){var o=l(i.target&&i.target.annotation,i.target);o&&(o.cancelClick=i.hasDragged),i.cancelClick=i.hasDragged,i.hasDragged=!1,i.chart.hasDraggedAnnotation=!1,h(l(o,i),"afterUpdate"),i.onMouseUp(t)},a?{passive:!1}:void 0))},n.prototype.onMouseUp=function(t){var o=this.chart,i=(t=this.target||this,o.options.annotations),o=o.annotations.indexOf(t);this.removeDocEvents(),i[o]=t.options},n.prototype.removeDocEvents=function(){this.removeDrag&&(this.removeDrag=this.removeDrag()),this.removeMouseUp&&(this.removeMouseUp=this.removeMouseUp())},n;function n(){}}),o(t,"Extensions/Annotations/ControlPoint.js",[t["Extensions/Annotations/EventEmitter.js"],t["Core/Utilities.js"]],function(t,o){var n,s,i=this&&this.__extends||(n=function(t,o){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])})(t,o)},function(t,o){function i(){this.constructor=t}if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");n(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}),e=o.merge,a=o.pick;function r(t,o,i,n){var e=s.call(this)||this;return e.graphic=void 0,e.nonDOMEvents=["drag"],e.chart=t,e.target=o,e.options=i,e.index=a(i.index,n),e}return i(r,s=t),r.prototype.destroy=function(){s.prototype.destroy.call(this),this.graphic&&(this.graphic=this.graphic.destroy()),this.options=this.target=this.chart=null},r.prototype.redraw=function(t){this.graphic[t?"animate":"attr"](this.options.positioner.call(this,this.target))},r.prototype.render=function(){var t=this.chart,o=this.options;this.graphic=t.renderer.symbol(o.symbol,0,0,o.width,o.height).add(t.controlPointsGroup).css(o.style),this.setVisibility(o.visible),this.addEvents()},r.prototype.setVisibility=function(t){this.graphic[t?"show":"hide"](),this.options.visible=t},r.prototype.update=function(t){var o=this.chart,i=this.target,n=this.index;t=e(!0,this.options,t),this.destroy(),this.constructor(o,i,t,n),this.render(o.controlPointsGroup),this.redraw()},t=r}),o(t,"Extensions/Annotations/MockPoint.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,o){var n=t.series.prototype,s=o.defined,a=o.fireEvent;function i(t,o,i){this.plotY=this.plotX=void 0,this.mock=!0,this.series={visible:!0,chart:t,getPlotBox:n.getPlotBox},this.target=o||null,this.options=i,this.applyOptions(this.getOptions())}return i.fromPoint=function(t){return new i(t.series.chart,null,{x:t.x,y:t.y,xAxis:t.series.xAxis,yAxis:t.series.yAxis})},i.pointToPixels=function(t,o){var i=t.series,n=i.chart,e=t.plotX||0,s=t.plotY||0;return n.inverted&&(s=t.mock?(e=t.plotY,t.plotX):(e=n.plotWidth-(t.plotY||0),n.plotHeight-(t.plotX||0))),i&&!o&&(e+=(t=i.getPlotBox()).translateX,s+=t.translateY),{x:e,y:s}},i.pointToOptions=function(t){return{x:t.x,y:t.y,xAxis:t.series.xAxis,yAxis:t.series.yAxis}},i.prototype.applyOptions=function(t){this.command=t.command,this.setAxis(t,"x"),this.setAxis(t,"y"),this.refresh()},i.prototype.getLabelConfig=function(){return{x:this.x,y:this.y,point:this}},i.prototype.getOptions=function(){return this.hasDynamicOptions()?this.options(this.target):this.options},i.prototype.hasDynamicOptions=function(){return"function"==typeof this.options},i.prototype.isInsidePlot=function(){var t=this.plotX,o=this.plotY,i=this.series.xAxis,n=this.series.yAxis,e={x:t,y:o,isInsidePlot:!0,options:{}};return i&&(e.isInsidePlot=s(t)&&0<=t&&t<=i.len),n&&(e.isInsidePlot=e.isInsidePlot&&s(o)&&0<=o&&o<=n.len),a(this.series.chart,"afterIsInsidePlot",e),e.isInsidePlot},i.prototype.refresh=function(){var t=(o=this.series).xAxis,o=o.yAxis,i=this.getOptions();t?(this.x=i.x,this.plotX=t.toPixels(i.x,!0)):(this.x=void 0,this.plotX=i.x),o?(this.y=i.y,this.plotY=o.toPixels(i.y,!0)):(this.y=null,this.plotY=i.y),this.isInside=this.isInsidePlot()},i.prototype.refreshOptions=function(){var t=(o=this.series).xAxis,o=o.yAxis;this.x=this.options.x=t?this.options.x=t.toValue(this.plotX,!0):this.plotX,this.y=this.options.y=o?o.toValue(this.plotY,!0):this.plotY},i.prototype.rotate=function(t,o,i){var n,e,s;this.hasDynamicOptions()||(n=Math.cos(i),i=Math.sin(i),e=this.plotX-t,s=this.plotY-o,this.plotX=e*n-s*i+t,this.plotY=e*i+s*n+o,this.refreshOptions())},i.prototype.scale=function(t,o,i,n){var e;this.hasDynamicOptions()||(e=this.plotY*n,this.plotX=(1-i)*t+this.plotX*i,this.plotY=(1-n)*o+e,this.refreshOptions())},i.prototype.setAxis=function(t,o){t=t[o+="Axis"];var i=this.series.chart;this.series[o]="object"==typeof t?t:s(t)?i[o][t]||i.get(t):null},i.prototype.toAnchor=function(){var t=[this.plotX,this.plotY,0,0];return this.series.chart.inverted&&(t[0]=this.plotY,t[1]=this.plotX),t},i.prototype.translate=function(t,o,i,n){this.hasDynamicOptions()||(this.plotX+=i,this.plotY+=n,this.refreshOptions())},t=i}),o(t,"Extensions/Annotations/ControlTarget.js",[t["Extensions/Annotations/ControlPoint.js"],t["Extensions/Annotations/MockPoint.js"],t["Core/Utilities.js"]],function(s,r,a){var t,o;function i(){var i=this,n=this.controlPoints,e=this.options.controlPoints||[];e.forEach(function(t,o){(t=a.merge(i.options.controlPointOptions,t)).index||(t.index=o),e[o]=t,n.push(new s(i.chart,i,t))})}function n(t){var o=t.series.getPlotBox(),i=t.series.chart,n=t.mock?t.toAnchor():i.tooltip&&i.tooltip.getAnchor.call({chart:t.series.chart},t)||[0,0,0,0];return{relativePosition:n={x:n[0]+(this.options.x||0),y:n[1]+(this.options.y||0),height:n[2]||0,width:n[3]||0},absolutePosition:a.merge(n,{x:n.x+(t.mock?o.translateX:i.plotLeft),y:n.y+(t.mock?o.translateY:i.plotTop)})}}function e(){this.controlPoints.forEach(function(t){return t.destroy()}),this.options=this.points=this.controlPoints=this.chart=null,this.annotation&&(this.annotation=null)}function h(){var t=this.options;return t.points||t.point&&a.splat(t.point)}function l(){for(var t=this.getPointsOptions(),o=this.points,i=t&&t.length||0,n=0;n<i;n++){var e=this.point(t[n],o[n]);if(!e)return void(o.length=0);e.mock&&e.refresh(),o[n]=e}return o}function c(t,o){return t&&t.series?t:(o&&null!==o.series||(a.isObject(t)?o=new r(this.chart,this,t):a.isString(t)?o=this.chart.get(t)||null:"function"==typeof t&&(o=(o=t.call(o,this)).series?o:new r(this.chart,this,t))),o)}function p(o){this.controlPoints.forEach(function(t){return t.redraw(o)})}function u(){this.controlPoints.forEach(function(t){return t.render()})}function d(i,n,e,s,a){var t,r=this;this.chart.inverted&&(t=n,n=e,e=t),this.points.forEach(function(t,o){return r.transformPoint(i,n,e,s,a,o)},this)}function f(t,o,i,n,e,s){var a=this.points[s];(a=a.mock?a:this.points[s]=r.fromPoint(a))[t](o,i,n,e)}function g(t,o){this.transform("translate",null,null,t,o)}function y(t,o,i){this.transformPoint("translate",null,null,t,o,i)}return t=t||{},o=[],t.compose=function(t){a.pushUnique(o,t)&&a.merge(!0,t.prototype,{addControlPoints:i,anchor:n,destroyControlTarget:e,getPointsOptions:h,linkPoints:l,point:c,redrawControlPoints:p,renderControlPoints:u,transform:d,transformPoint:f,translate:g,translatePoint:y})},t}),o(t,"Extensions/Annotations/Controllables/Controllable.js",[t["Extensions/Annotations/ControlTarget.js"],t["Core/Utilities.js"]],function(t,o){var e=o.merge;function i(t,o,i,n){this.graphic=void 0,this.annotation=t,this.chart=t.chart,this.collection="label"===n?"labels":"shapes",this.controlPoints=[],this.options=o,this.points=[],this.index=i,this.itemType=n,this.init(t,o,i)}return i.prototype.attr=function(){for(var t=0;t<arguments.length;t++);this.graphic.attr.apply(this.graphic,arguments)},i.prototype.attrsFromOptions=function(t){var o,i=this.constructor.attrsMap,n={},e=this.chart.styledMode;for(o in t){var s=i[o];void 0===i[o]||e&&-1!==["fill","stroke","stroke-width"].indexOf(s)||(n[s]=t[o])}return n},i.prototype.destroy=function(){this.graphic&&(this.graphic=this.graphic.destroy()),this.tracker&&(this.tracker=this.tracker.destroy()),this.destroyControlTarget()},i.prototype.init=function(t,o,i){this.annotation=t,this.chart=t.chart,this.options=o,this.points=[],this.controlPoints=[],this.index=i,this.linkPoints(),this.addControlPoints()},i.prototype.redraw=function(t){this.redrawControlPoints(t)},i.prototype.render=function(t){this.renderControlPoints()},i.prototype.rotate=function(t,o,i){this.transform("rotate",t,o,i)},i.prototype.scale=function(t,o,i,n){this.transform("scale",t,o,i,n)},i.prototype.setControlPointsVisibility=function(o){this.controlPoints.forEach(function(t){t.setVisibility(o)})},i.prototype.shouldBeDrawn=function(){return!!this.points.length},i.prototype.translateShape=function(t,o,i){var n=this.annotation.chart,e=this.annotation.userOptions,s=n.annotations.indexOf(this.annotation),n=n.options.annotations[s];this.translatePoint(t,o,0),i&&this.translatePoint(t,o,1),n[this.collection][this.index].point=this.options.point,e[this.collection][this.index].point=this.options.point},i.prototype.update=function(t){var o=this.annotation,i=e(!0,this.options,t),n=(t=this.graphic.parentGroup,this.constructor);this.destroy(),o=new n(o,i,this.index,this.itemType),e(!0,this,o),this.render(t),this.redraw()},t.compose(o=i),o}),o(t,"Extensions/Annotations/Controllables/ControllableDefaults.js",[],function(){return{defaultMarkers:{arrow:{tagName:"marker",attributes:{id:"arrow",refY:5,refX:9,markerWidth:10,markerHeight:10},children:[{tagName:"path",attributes:{d:"M 0 0 L 10 5 L 0 10 Z","stroke-width":0}}]},"reverse-arrow":{tagName:"marker",attributes:{id:"reverse-arrow",refY:5,refX:1,markerWidth:10,markerHeight:10},children:[{tagName:"path",attributes:{d:"M 0 5 L 10 0 L 10 10 Z","stroke-width":0}}]}}}}),o(t,"Extensions/Annotations/Controllables/ControllablePath.js",[t["Extensions/Annotations/Controllables/Controllable.js"],t["Extensions/Annotations/Controllables/ControllableDefaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(t,o,i,n){function e(o){return function(t){this.attr(o,"url(#"+t+")")}}function s(){this.options.defs=f(c,this.options.defs||{})}function a(t,o){var i={attributes:{id:t}},n={stroke:o.color||"none",fill:o.color||"rgba(0, 0, 0, 0.75)"};return i.children=o.children&&o.children.map(function(t){return f(n,t)}),o=f(!0,{attributes:{markerWidth:20,markerHeight:20,refX:0,refY:0,orient:"auto"}},o,i),(o=this.definition(o)).id=t,o}var r,h,l=this&&this.__extends||(r=function(t,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])})(t,o)},function(t,o){function i(){this.constructor=t}if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");r(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}),c=o.defaultMarkers,p=n.addEvent,u=n.defined,d=n.extend,f=n.merge,g=n.uniqueKey,y=[],v=e("marker-end"),m=e("marker-start"),x="rgba(192,192,192,"+(i.svg?1e-4:.002)+")";return l(b,h=t),b.compose=function(t,o){n.pushUnique(y,t)&&p(t,"afterGetContainer",s),n.pushUnique(y,o)&&(o.prototype.addMarker=a)},b.prototype.toD=function(){var t=this.options.d;if(t)return"function"==typeof t?t.call(this):t;var o=(t=this.points).length,i=[],n=o,e=t[0],s=n&&this.anchor(e).absolutePosition,a=0;if(s)for(i.push(["M",s.x,s.y]);++a<o&&n;)n=(e=t[a]).command||"L",s=this.anchor(e).absolutePosition,"M"===n||"L"===n?i.push([n,s.x,s.y]):"Z"===n&&i.push([n]),n=e.series.visible;return n&&this.graphic?this.chart.renderer.crispLine(i,this.graphic.strokeWidth()):null},b.prototype.shouldBeDrawn=function(){return h.prototype.shouldBeDrawn.call(this)||!!this.options.d},b.prototype.render=function(t){var o=this.options,i=this.attrsFromOptions(o);this.graphic=this.annotation.chart.renderer.path([["M",0,0]]).attr(i).add(t),o.className&&this.graphic.addClass(o.className),this.tracker=this.annotation.chart.renderer.path([["M",0,0]]).addClass("highcharts-tracker-line").attr({zIndex:2}).add(t),this.annotation.chart.styledMode||this.tracker.attr({"stroke-linejoin":"round",stroke:x,fill:x,"stroke-width":this.graphic.strokeWidth()+2*o.snap}),h.prototype.render.call(this),d(this.graphic,{markerStartSetter:m,markerEndSetter:v}),this.setMarkers(this)},b.prototype.redraw=function(t){var o,i;this.graphic&&(i=t?"animate":"attr",(o=this.toD())?(this.graphic[i]({d:o}),this.tracker[i]({d:o})):(this.graphic.attr({d:"M 0 -9000000000"}),this.tracker.attr({d:"M 0 -9000000000"})),this.graphic.placed=this.tracker.placed=!!o),h.prototype.redraw.call(this,t)},b.prototype.setMarkers=function(s){var a=s.options,r=s.chart,h=r.options.defs,t=a.fill,l=u(t)&&"none"!==t?t:a.stroke;["markerStart","markerEnd"].forEach(function(t){var o,i=a[t];if(i){for(o in h){var n=h[o];if((i===(n.attributes&&n.attributes.id)||i===n.id)&&"marker"===n.tagName){var e=n;break}}e&&(i=s[t]=r.renderer.addMarker((a.id||g())+"-"+i,f(e,{color:l})),s.attr(t,i.getAttribute("id")))}})},b.attrsMap={dashStyle:"dashstyle",strokeWidth:"stroke-width",stroke:"stroke",fill:"fill",zIndex:"zIndex"},b;function b(t,o,i){return(t=h.call(this,t,o,i,"shape")||this).type="path",t}}),o(t,"Extensions/Annotations/Controllables/ControllableRect.js",[t["Extensions/Annotations/Controllables/Controllable.js"],t["Extensions/Annotations/Controllables/ControllablePath.js"],t["Core/Utilities.js"]],function(t,o,i){var n,e,s=this&&this.__extends||(n=function(t,o){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])})(t,o)},function(t,o){function i(){this.constructor=t}if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");n(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}),i=i.merge;return s(a,e=t),a.prototype.render=function(t){var o=this.attrsFromOptions(this.options);this.graphic=this.annotation.chart.renderer.rect(0,-9e9,0,0).attr(o).add(t),e.prototype.render.call(this)},a.prototype.redraw=function(t){var o;this.graphic&&((o=this.anchor(this.points[0]).absolutePosition)?this.graphic[t?"animate":"attr"]({x:o.x,y:o.y,width:this.options.width,height:this.options.height}):this.attr({x:0,y:-9e9}),this.graphic.placed=!!o),e.prototype.redraw.call(this,t)},a.attrsMap=i(o.attrsMap,{width:"width",height:"height"}),a;function a(t,o,i){return(t=e.call(this,t,o,i,"shape")||this).type="rect",t.translate=e.prototype.translateShape,t}}),o(t,"Extensions/Annotations/Controllables/ControllableCircle.js",[t["Extensions/Annotations/Controllables/Controllable.js"],t["Extensions/Annotations/Controllables/ControllablePath.js"],t["Core/Utilities.js"]],function(t,o,i){var n,e,s=this&&this.__extends||(n=function(t,o){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])})(t,o)},function(t,o){function i(){this.constructor=t}if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");n(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}),i=i.merge;return s(a,e=t),a.prototype.redraw=function(t){var o;this.graphic&&((o=this.anchor(this.points[0]).absolutePosition)?this.graphic[t?"animate":"attr"]({x:o.x,y:o.y,r:this.options.r}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!o),e.prototype.redraw.call(this,t)},a.prototype.render=function(t){var o=this.attrsFromOptions(this.options);this.graphic=this.annotation.chart.renderer.circle(0,-9e9,0).attr(o).add(t),e.prototype.render.call(this)},a.prototype.setRadius=function(t){this.options.r=t},a.attrsMap=i(o.attrsMap,{r:"r"}),a;function a(t,o,i){return(t=e.call(this,t,o,i,"shape")||this).type="circle",t.translate=e.prototype.translateShape,t}}),o(t,"Extensions/Annotations/Controllables/ControllableEllipse.js",[t["Extensions/Annotations/Controllables/Controllable.js"],t["Extensions/Annotations/Controllables/ControllablePath.js"],t["Core/Utilities.js"]],function(t,o,i){var n,e,s=this&&this.__extends||(n=function(t,o){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])})(t,o)},function(t,o){function i(){this.constructor=t}if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");n(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}),a=i.merge,r=i.defined;return s(h,e=t),h.prototype.init=function(t,o,i){r(o.yAxis)&&o.points.forEach(function(t){t.yAxis=o.yAxis}),r(o.xAxis)&&o.points.forEach(function(t){t.xAxis=o.xAxis}),e.prototype.init.call(this,t,o,i)},h.prototype.render=function(t){this.graphic=this.annotation.chart.renderer.createElement("ellipse").attr(this.attrsFromOptions(this.options)).add(t),e.prototype.render.call(this)},h.prototype.translate=function(t,o){e.prototype.translateShape.call(this,t,o,!0)},h.prototype.getDistanceFromLine=function(t,o,i,n){return Math.abs((o.y-t.y)*i-(o.x-t.x)*n+o.x*t.y-o.y*t.x)/Math.sqrt((o.y-t.y)*(o.y-t.y)+(o.x-t.x)*(o.x-t.x))},h.prototype.getAttrs=function(t,o){var i=t.x,n=t.y,e=o.x,s=o.y,a=(o=(i+e)/2,t=(n+s)/2,Math.sqrt((i-e)*(i-e)/4+(n-s)*(n-s)/4)),n=180*Math.atan((s-n)/(e-i))/Math.PI;return o<i&&(n+=180),{cx:o,cy:t,rx:a,ry:this.getRY(),angle:n}},h.prototype.getRY=function(){var t=this.getYAxis();return r(t)?Math.abs(t.toPixels(this.options.ry)-t.toPixels(0)):this.options.ry},h.prototype.getYAxis=function(){return this.chart.yAxis[this.options.yAxis]},h.prototype.getAbsolutePosition=function(t){return this.anchor(t).absolutePosition},h.prototype.redraw=function(t){var o,i;this.graphic&&(o=this.getAbsolutePosition(this.points[0]),i=this.getAbsolutePosition(this.points[1]),i=this.getAttrs(o,i),o?this.graphic[t?"animate":"attr"]({cx:i.cx,cy:i.cy,rx:i.rx,ry:i.ry,rotation:i.angle,rotationOriginX:i.cx,rotationOriginY:i.cy}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!o),e.prototype.redraw.call(this,t)},h.prototype.setYRadius=function(t){var o=this.annotation.userOptions.shapes;this.options.ry=t,o&&o[0]&&(o[0].ry=t,o[0].ry=t)},h.attrsMap=a(o.attrsMap,{ry:"ry"}),h;function h(t,o,i){return(t=e.call(this,t,o,i,"shape")||this).type="ellipse",t}}),o(t,"Extensions/Annotations/Controllables/ControllableLabel.js",[t["Extensions/Annotations/Controllables/Controllable.js"],t["Core/FormatUtilities.js"],t["Extensions/Annotations/MockPoint.js"],t["Core/Utilities.js"]],function(t,o,p,i){function n(t,o,i,n,e){var s,a,r=e&&e.anchorX,h=(e=e&&e.anchorY,i/2);return l(r)&&l(e)&&(s=[["M",r,e]],(a=(a=o-e)<0?-n-a:a)<i&&(h=r<t+i/2?a:i-a),o+n<e?s.push(["L",t+h,o+n]):e<o?s.push(["L",t+h,o]):r<t?s.push(["L",t,o+n/2]):t+i<r&&s.push(["L",t+i,o+n/2])),s||[]}var e,s,a=this&&this.__extends||(e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])})(t,o)},function(t,o){function i(){this.constructor=t}if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}),r=o.format,u=i.extend,l=i.isNumber,d=i.pick,h=[];return a(f,s=t),f.alignedPosition=function(t,o){var i,n,e=t.align,s=t.verticalAlign,a=(o.x||0)+(t.x||0),r=(o.y||0)+(t.y||0);return"right"===e?i=1:"center"===e&&(i=2),i&&(a+=(o.width-(t.width||0))/i),"bottom"===s?n=1:"middle"===s&&(n=2),n&&(r+=(o.height-(t.height||0))/n),{x:Math.round(a),y:Math.round(r)}},f.compose=function(t){i.pushUnique(h,t)&&(t.prototype.symbols.connector=n)},f.justifiedOptions=function(t,o,i,n){var e=i.align,s=i.verticalAlign,a=!o.box&&o.padding||0,r=o.getBBox(),h=(o={align:e,verticalAlign:s,x:i.x,y:i.y,width:o.width,height:o.height},i=(n.x||0)-t.plotLeft,n=(n.y||0)-t.plotTop,i+a);return h<0&&("right"===e?o.align="left":o.x=(o.x||0)-h),(h=i+r.width-a)>t.plotWidth&&("left"===e?o.align="right":o.x=(o.x||0)+t.plotWidth-h),(h=n+a)<0&&("bottom"===s?o.verticalAlign="top":o.y=(o.y||0)-h),(h=n+r.height-a)>t.plotHeight&&("top"===s?o.verticalAlign="bottom":o.y=(o.y||0)+t.plotHeight-h),o},f.prototype.translatePoint=function(t,o){s.prototype.translatePoint.call(this,t,o,0)},f.prototype.translate=function(t,o){var i=this.annotation.chart,n=this.annotation.userOptions,e=i.annotations.indexOf(this.annotation),e=i.options.annotations[e];i.inverted&&(i=t,t=o,o=i),this.options.x+=t,this.options.y+=o,e[this.collection][this.index].x=this.options.x,e[this.collection][this.index].y=this.options.y,n[this.collection][this.index].x=this.options.x,n[this.collection][this.index].y=this.options.y},f.prototype.render=function(t){var o=this.options,i=this.attrsFromOptions(o),n=o.style;this.graphic=this.annotation.chart.renderer.label("",0,-9999,o.shape,null,null,o.useHTML,null,"annotation-label").attr(i).add(t),this.annotation.chart.styledMode||("contrast"===n.color&&(n.color=this.annotation.chart.renderer.getContrast(-1<f.shapesWithoutBackground.indexOf(o.shape)?"#FFFFFF":o.backgroundColor)),this.graphic.css(o.style).shadow(o.shadow)),o.className&&this.graphic.addClass(o.className),this.graphic.labelrank=o.labelrank,s.prototype.render.call(this)},f.prototype.redraw=function(t){var o=this.options,i=this.text||o.format||o.text,n=this.graphic,e=this.points[0];n?(n.attr({text:i?r(String(i),e.getLabelConfig(),this.annotation.chart):o.formatter.call(e,this)}),o=this.anchor(e),(i=this.position(o))?((n.alignAttr=i).anchorX=o.absolutePosition.x,i.anchorY=o.absolutePosition.y,n[t?"animate":"attr"](i)):n.attr({x:0,y:-9999}),n.placed=!!i,s.prototype.redraw.call(this,t)):this.redraw(t)},f.prototype.anchor=function(t){var o=s.prototype.anchor.apply(this,arguments),i=this.options.x||0,n=this.options.y||0;return o.absolutePosition.x-=i,o.absolutePosition.y-=n,o.relativePosition.x-=i,o.relativePosition.y-=n,o},f.prototype.position=function(t){var o,i,n=this.graphic,e=this.annotation.chart,s=e.tooltip,a=this.points[0],r=this.options,h=t.absolutePosition,l=t.relativePosition,c=a.series.visible&&p.prototype.isInsidePlot.call(a);return n&&c&&(t=void 0===(o=n.width)?0:o,i=void 0===(o=n.height)?0:o,r.distance&&s?o=s.getPosition.call({chart:e,distance:d(r.distance,16),getPlayingField:s.getPlayingField},t,i,{plotX:l.x,plotY:l.y,negative:a.negative,ttBelow:a.ttBelow,h:l.height||l.width}):r.positioner?o=r.positioner.call(this):(s={x:h.x,y:h.y,width:0,height:0},o=f.alignedPosition(u(r,{width:t,height:i}),s),"justify"===this.options.overflow&&(o=f.alignedPosition(f.justifiedOptions(e,n,r,o),s))),r.crop&&(n=o.x-e.plotLeft,r=o.y-e.plotTop,c=e.isInsidePlot(n,r)&&e.isInsidePlot(n+t,r+i))),c?o:null},f.attrsMap={backgroundColor:"fill",borderColor:"stroke",borderWidth:"stroke-width",zIndex:"zIndex",borderRadius:"r",padding:"padding"},f.shapesWithoutBackground=["connector"],f;function f(t,o,i){return s.call(this,t,o,i,"label")||this}}),o(t,"Extensions/Annotations/Controllables/ControllableImage.js",[t["Extensions/Annotations/Controllables/Controllable.js"],t["Extensions/Annotations/Controllables/ControllableLabel.js"]],function(t,i){var n,e;return(this&&this.__extends||(n=function(t,o){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])})(t,o)},function(t,o){function i(){this.constructor=t}if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");n(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}))(o,e=t),o.prototype.render=function(t){var o=this.attrsFromOptions(this.options),i=this.options;this.graphic=this.annotation.chart.renderer.image(i.src,0,-9e9,i.width,i.height).attr(o).add(t),this.graphic.width=i.width,this.graphic.height=i.height,e.prototype.render.call(this)},o.prototype.redraw=function(t){var o;this.graphic&&(o=this.anchor(this.points[0]),(o=i.prototype.position.call(this,o))?this.graphic[t?"animate":"attr"]({x:o.x,y:o.y}):this.graphic.attr({x:0,y:-9e9}),this.graphic.placed=!!o),e.prototype.redraw.call(this,t)},o.attrsMap={width:"width",height:"height",zIndex:"zIndex"},o;function o(t,o,i){return(t=e.call(this,t,o,i,"shape")||this).type="image",t.translate=e.prototype.translateShape,t}}),o(t,"Core/Chart/ChartNavigationComposition.js",[],function(){var t,o=t=t||{},i=(o.compose=function(t){return t.navigation||(t.navigation=new i(t)),t},n.prototype.addUpdate=function(t){this.chart.navigation.updates.push(t)},n.prototype.update=function(o,i){var n=this;this.updates.forEach(function(t){t.call(n.chart,o,i)})},n);function n(t){this.updates=[],this.chart=t}return o.Additions=i,t}),o(t,"Extensions/Annotations/NavigationBindingsUtilities.js",[t["Core/Utilities.js"]],function(t){var i=t.defined,e=t.isNumber,s=t.pick,n={backgroundColor:"string",borderColor:"string",borderRadius:"string",color:"string",fill:"string",fontSize:"string",labels:"string",name:"string",stroke:"string",title:"string"};return{annotationsFieldsTypes:n,getAssignedAxis:function(t){return t.filter(function(t){var o=(i=t.axis.getExtremes()).min,i=i.max,n=s(t.axis.minPointOffset,0);return e(o)&&e(i)&&t.value>=o-n&&t.value<=i+n&&!t.axis.options.isInternal})[0]},getFieldType:function(t,o){return o=typeof o,{string:"text",number:"number",boolean:"checkbox"}[o=i(t=n[t])?t:o]}}}),o(t,"Extensions/Annotations/NavigationBindingsDefaults.js",[t["Extensions/Annotations/NavigationBindingsUtilities.js"],t["Core/Utilities.js"]],function(t,o){var s=t.getAssignedAxis,a=o.isNumber,r=o.merge;return{lang:{navigation:{popup:{simpleShapes:"Simple shapes",lines:"Lines",circle:"Circle",ellipse:"Ellipse",rectangle:"Rectangle",label:"Label",shapeOptions:"Shape options",typeOptions:"Details",fill:"Fill",format:"Text",strokeWidth:"Line width",stroke:"Line color",title:"Title",name:"Name",labelOptions:"Label options",labels:"Labels",backgroundColor:"Background color",backgroundColors:"Background colors",borderColor:"Border color",borderRadius:"Border radius",borderWidth:"Border width",style:"Style",padding:"Padding",fontSize:"Font size",color:"Color",height:"Height",shapes:"Shape options"}}},navigation:{bindingsClassName:"highcharts-bindings-container",bindings:{circleAnnotation:{className:"highcharts-circle-annotation",start:function(t){var o=this.chart.pointer.getCoordinates(t),i=(t=s(o.xAxis),o=s(o.yAxis),this.chart.options.navigation);if(t&&o)return this.chart.addAnnotation(r({langKey:"circle",type:"basicAnnotation",shapes:[{type:"circle",point:{x:t.value,y:o.value,xAxis:t.axis.options.index,yAxis:o.axis.options.index},r:5}]},i.annotationsOptions,i.bindings.circleAnnotation.annotationsOptions))},steps:[function(t,o){var i,n,e=o.options.shapes;e=e&&e[0]&&e[0].point||{},a(e.xAxis)&&a(e.yAxis)&&(n=this.chart.inverted,i=this.chart.xAxis[e.xAxis].toPixels(e.x),e=this.chart.yAxis[e.yAxis].toPixels(e.y),n=Math.max(Math.sqrt(Math.pow(n?e-t.chartX:i-t.chartX,2)+Math.pow(n?i-t.chartY:e-t.chartY,2)),5)),o.update({shapes:[{r:n}]})}]},ellipseAnnotation:{className:"highcharts-ellipse-annotation",start:function(t){var o=this.chart.pointer.getCoordinates(t),i=(t=s(o.xAxis),o=s(o.yAxis),this.chart.options.navigation);if(t&&o)return this.chart.addAnnotation(r({langKey:"ellipse",type:"basicAnnotation",shapes:[{type:"ellipse",xAxis:t.axis.options.index,yAxis:o.axis.options.index,points:[{x:t.value,y:o.value},{x:t.value,y:o.value}],ry:1}]},i.annotationsOptions,i.bindings.ellipseAnnotation.annotationOptions))},steps:[function(t,o){var i=(o=o.shapes[0]).getAbsolutePosition(o.points[1]);o.translatePoint(t.chartX-i.x,t.chartY-i.y,1),o.redraw(!1)},function(t,o){var i=(o=o.shapes[0]).getAbsolutePosition(o.points[0]),n=o.getAbsolutePosition(o.points[1]);t=o.getDistanceFromLine(i,n,t.chartX,t.chartY),i=o.getYAxis(),t=Math.abs(i.toValue(0)-i.toValue(t)),o.setYRadius(t),o.redraw(!1)}]},rectangleAnnotation:{className:"highcharts-rectangle-annotation",start:function(t){t=this.chart.pointer.getCoordinates(t);var o,i,n=s(t.xAxis),e=s(t.yAxis);if(n&&e)return t=n.value,o=e.value,n=n.axis.options.index,e=e.axis.options.index,i=this.chart.options.navigation,this.chart.addAnnotation(r({langKey:"rectangle",type:"basicAnnotation",shapes:[{type:"path",points:[{xAxis:n,yAxis:e,x:t,y:o},{xAxis:n,yAxis:e,x:t,y:o},{xAxis:n,yAxis:e,x:t,y:o},{xAxis:n,yAxis:e,x:t,y:o},{command:"Z"}]}]},i.annotationsOptions,i.bindings.rectangleAnnotation.annotationsOptions))},steps:[function(t,o){var i=(i=o.options.shapes)&&i[0]&&i[0].points||[],n=this.chart.pointer.getCoordinates(t);t=s(n.xAxis),n=s(n.yAxis),t&&n&&(t=t.value,n=n.value,i[1].x=t,i[2].x=t,i[2].y=n,i[3].y=n,o.update({shapes:[{points:i}]}))}]},labelAnnotation:{className:"highcharts-label-annotation",start:function(t){var o=this.chart.pointer.getCoordinates(t),i=(t=s(o.xAxis),o=s(o.yAxis),this.chart.options.navigation);if(t&&o)return this.chart.addAnnotation(r({langKey:"label",type:"basicAnnotation",labelOptions:{format:"{y:.2f}"},labels:[{point:{xAxis:t.axis.options.index,yAxis:o.axis.options.index,x:t.value,y:o.value},overflow:"none",crop:!0}]},i.annotationsOptions,i.bindings.labelAnnotation.annotationsOptions))}}},events:{},annotationsOptions:{animation:{defer:0}}}}}),o(t,"Extensions/Annotations/NavigationBindings.js",[t["Core/Chart/ChartNavigationComposition.js"],t["Core/Defaults.js"],t["Core/FormatUtilities.js"],t["Core/Globals.js"],t["Extensions/Annotations/NavigationBindingsDefaults.js"],t["Extensions/Annotations/NavigationBindingsUtilities.js"],t["Core/Utilities.js"]],function(t,o,i,e,n,s,a){function r(){this.chart.navigationBindings&&this.chart.navigationBindings.deselectAnnotation()}function h(){this.navigationBindings&&this.navigationBindings.destroy()}function l(){var t=this.options;t&&t.navigation&&t.navigation.bindings&&(this.navigationBindings=new T(this,t.navigation),this.navigationBindings.initEvents(),this.navigationBindings.initUpdate())}function c(){var s,a,t=this.navigationBindings;this&&t&&(s=!1,this.series.forEach(function(t){!t.options.isInternal&&t.visible&&(s=!0)}),this.navigationBindings&&this.navigationBindings.container&&this.navigationBindings.container[0]&&(a=this.navigationBindings.container[0],O(t.boundClassNames,function(t,o){if(o=a.querySelectorAll("."+o))for(var i=0;i<o.length;i++){var n=o[i],e=n.className;"normal"===t.noDataState||s?-1!==e.indexOf("highcharts-disabled-btn")&&n.classList.remove("highcharts-disabled-btn"):-1===e.indexOf("highcharts-disabled-btn")&&(n.className+=" highcharts-disabled-btn")}})))}function p(){this.deselectAnnotation()}function u(){this.selectedButtonElement=null}function d(t){function o(t){var i=this,n=i.chart.navigationBindings,o=n.activeAnnotation;e&&e.call(i,t),o!==i?(n.deselectAnnotation(),(n.activeAnnotation=i).setControlPointsVisibility(!0),A(n,"showPopup",{annotation:i,formType:"annotation-toolbar",options:n.annotationToFields(i),onSubmit:function(t){var o;"remove"===t.actionType?(n.activeAnnotation=!1,n.chart.removeAnnotation(i)):(n.fieldsToOptions(t.fields,o={}),n.deselectAnnotation(),t=o.typeOptions,"measure"===i.options.type&&(t.crosshairY.enabled=0!==t.crosshairY.strokeWidth,t.crosshairX.enabled=0!==t.crosshairX.strokeWidth),i.update(o))}})):A(n,"closePopup"),t.activeAnnotation=!0}var i,n,e=t.prototype.defaultOptions.events&&t.prototype.defaultOptions.events.click;k(!0,t.prototype.defaultOptions.events,{click:o,touchstart:function(t){i=t.touches[0].clientX,n=t.touches[0].clientY},touchend:function(t){i&&4<=Math.sqrt(Math.pow(i-t.changedTouches[0].clientX,2)+Math.pow(n-t.changedTouches[0].clientY,2))||o.call(this,t)}})}var f=o.setOptions,g=i.format,y=e.doc,v=e.win,m=s.getFieldType,x=a.addEvent,b=a.attr,A=a.fireEvent,C=a.isArray,E=a.isFunction,w=a.isNumber,P=a.isObject,k=a.merge,O=a.objectEach,j=a.pick,B=[],T=(N.compose=function(t,o){a.pushUnique(B,t)&&(x(t,"remove",r),d(t),O(t.types,function(t){d(t)})),a.pushUnique(B,o)&&(x(o,"destroy",h),x(o,"load",l),x(o,"render",c)),a.pushUnique(B,N)&&(x(N,"closePopup",p),x(N,"deselectButton",u)),a.pushUnique(B,f)&&f(n)},N.prototype.initEvents=function(){var n=this,o=n.chart,t=n.container,i=n.options;n.boundClassNames={},O(i.bindings||{},function(t){n.boundClassNames[t.className]=t}),[].forEach.call(t,function(i){n.eventsToUnbind.push(x(i,"click",function(t){var o=n.getButtonEvents(i,t);o&&!o.button.classList.contains("highcharts-disabled-btn")&&n.bindingsButtonClick(o.button,o.events,t)}))}),O(i.events||{},function(t,o){E(t)&&n.eventsToUnbind.push(x(n,o,t,{passive:!1}))}),n.eventsToUnbind.push(x(o.container,"click",function(t){!o.cancelClick&&o.isInsidePlot(t.chartX-o.plotLeft,t.chartY-o.plotTop,{visiblePlotOnly:!0})&&n.bindingsChartClick(this,t)})),n.eventsToUnbind.push(x(o.container,e.isTouchDevice?"touchmove":"mousemove",function(t){n.bindingsContainerMouseMove(this,t)},e.isTouchDevice?{passive:!1}:void 0))},N.prototype.initUpdate=function(){var o=this;t.compose(this.chart).navigation.addUpdate(function(t){o.update(t)})},N.prototype.bindingsButtonClick=function(t,o,i){var n=this.chart,e=n.renderer.boxWrapper,s=!0;this.selectedButtonElement&&(this.selectedButtonElement.classList===t.classList&&(s=!1),A(this,"deselectButton",{button:this.selectedButtonElement}),this.nextEvent&&(this.currentUserDetails&&"annotations"===this.currentUserDetails.coll&&n.removeAnnotation(this.currentUserDetails),this.mouseMoveEvent=this.nextEvent=!1)),s?(this.selectedButton=o,this.selectedButtonElement=t,A(this,"selectButton",{button:t}),o.init&&o.init.call(this,t,i),(o.start||o.steps)&&n.renderer.boxWrapper.addClass("highcharts-draw-mode")):(n.stockTools&&n.stockTools.toggleButtonActiveClass(t),e.removeClass("highcharts-draw-mode"),this.mouseMoveEvent=this.nextEvent=!1,this.selectedButton=null)},N.prototype.bindingsChartClick=function(t,o){t=this.chart;var i=this.activeAnnotation,n=this.selectedButton;t=t.renderer.boxWrapper,i&&(i.cancelClick||o.activeAnnotation||!o.target.parentNode||function(t,o){var i=v.Element.prototype,n=i.matches||i.msMatchesSelector||i.webkitMatchesSelector,e=null;if(i.closest)e=i.closest.call(t,o);else do{if(n.call(t,o))return t}while(null!==(t=t.parentElement||t.parentNode)&&1===t.nodeType);return e}(o.target,".highcharts-popup")?i.cancelClick&&setTimeout(function(){i.cancelClick=!1},0):A(this,"closePopup")),n&&n.start&&(this.nextEvent?(this.nextEvent(o,this.currentUserDetails),this.steps&&(this.stepIndex++,n.steps[this.stepIndex]?this.mouseMoveEvent=this.nextEvent=n.steps[this.stepIndex]:(A(this,"deselectButton",{button:this.selectedButtonElement}),t.removeClass("highcharts-draw-mode"),n.end&&n.end.call(this,o,this.currentUserDetails),this.mouseMoveEvent=this.nextEvent=!1,this.selectedButton=null))):(this.currentUserDetails=n.start.call(this,o))&&n.steps?(this.stepIndex=0,this.steps=!0,this.mouseMoveEvent=this.nextEvent=n.steps[this.stepIndex]):(A(this,"deselectButton",{button:this.selectedButtonElement}),t.removeClass("highcharts-draw-mode"),this.steps=!1,this.selectedButton=null,n.end&&n.end.call(this,o,this.currentUserDetails)))},N.prototype.bindingsContainerMouseMove=function(t,o){this.mouseMoveEvent&&this.mouseMoveEvent(o,this.currentUserDetails)},N.prototype.fieldsToOptions=function(t,i){return O(t,function(n,t){var e,o=parseFloat(n),s=t.split("."),a=s.length-1;"undefined"!==(n=!w(o)||n.match(/px/g)||t.match(/format/g)?n:o)&&(e=i,s.forEach(function(t,o){var i=j(s[o+1],"");a===o?e[t]=n:(e[t]||(e[t]=i.match(/\d/g)?[]:{}),e=e[t])}))}),i},N.prototype.deselectAnnotation=function(){this.activeAnnotation&&(this.activeAnnotation.setControlPointsVisibility(!1),this.activeAnnotation=!1)},N.prototype.annotationToFields=function(a){function r(t,n,i,e,o){var s;i&&t&&-1===l.indexOf(n)&&(0<=(i.indexOf&&i.indexOf(n))||i[n]||!0===i)&&(C(t)?(e[n]=[],t.forEach(function(t,i){P(t)?(e[n][i]={},O(t,function(t,o){r(t,o,h[n],e[n][i],n)})):r(t,0,h[n],e[n],n)})):P(t)?(s={},C(e)?(e.push(s),s[n]={},s=s[n]):e[n]=s,O(t,function(t,o){r(t,o,0===n?i:h[n],s,n)})):"format"===n?e[n]=[g(t,a.labels[0].points[0]).toString(),"text"]:C(e)?e.push([t,m(o,t)]):e[n]=[t,m(n,t)])}var o=a.options,n=N.annotationsEditable,h=n.nestedOptions,e=j(o.type,o.shapes&&o.shapes[0]&&o.shapes[0].type,o.labels&&o.labels[0]&&o.labels[0].type,"label"),l=N.annotationsNonEditable[o.langKey]||[],s={langKey:o.langKey,type:e};return O(o,function(t,i){"typeOptions"===i?(s[i]={},O(o[i],function(t,o){r(t,o,h,s[i],o)})):r(t,i,n[e],s,i)}),s},N.prototype.getClickedClassNames=function(t,o){var i,n=o.target;for(o=[];n&&n.tagName&&((i=b(n,"class"))&&(o=o.concat(i.split(" ").map(function(t){return[t,n]}))),(n=n.parentNode)!==t););return o},N.prototype.getButtonEvents=function(t,o){var i,n=this;return this.getClickedClassNames(t,o).forEach(function(t){n.boundClassNames[t[0]]&&!i&&(i={events:n.boundClassNames[t[0]],button:t[1]})}),i},N.prototype.update=function(t){this.options=k(!0,this.options,t),this.removeEvents(),this.initEvents()},N.prototype.removeEvents=function(){this.eventsToUnbind.forEach(function(t){return t()})},N.prototype.destroy=function(){this.removeEvents()},N.annotationsEditable={nestedOptions:{labelOptions:["style","format","backgroundColor"],labels:["style"],label:["style"],style:["fontSize","color"],background:["fill","strokeWidth","stroke"],innerBackground:["fill","strokeWidth","stroke"],outerBackground:["fill","strokeWidth","stroke"],shapeOptions:["fill","strokeWidth","stroke"],shapes:["fill","strokeWidth","stroke"],line:["strokeWidth","stroke"],backgroundColors:[!0],connector:["fill","strokeWidth","stroke"],crosshairX:["strokeWidth","stroke"],crosshairY:["strokeWidth","stroke"]},circle:["shapes"],ellipse:["shapes"],verticalLine:[],label:["labelOptions"],measure:["background","crosshairY","crosshairX"],fibonacci:[],tunnel:["background","line","height"],pitchfork:["innerBackground","outerBackground"],rect:["shapes"],crookedLine:[],basicAnnotation:["shapes","labelOptions"]},N.annotationsNonEditable={rectangle:["crosshairX","crosshairY","labelOptions"],ellipse:["labelOptions"],circle:["labelOptions"]},N);function N(t,o){this.selectedButton=this.boundClassNames=void 0,this.chart=t,this.options=o,this.eventsToUnbind=[],this.container=this.chart.container.getElementsByClassName(this.options.bindingsClassName||""),this.container.length||(this.container=y.getElementsByClassName(this.options.bindingsClassName||""))}return T}),o(t,"Shared/BaseForm.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Utilities.js"]],function(n,t){var e=t.addEvent,s=t.createElement;return o.prototype.createPopupContainer=function(t,o){return s("div",{className:o=void 0===o?"highcharts-popup highcharts-no-tooltip":o},void 0,t)},o.prototype.addCloseButton=function(t){var o=this,i=this.iconsURL,n=s("div",{className:t=void 0===t?"highcharts-popup-close":t},void 0,this.container);return n.style["background-image"]="url("+(i.match(/png|svg|jpeg|jpg|gif/gi)?i:i+"close.svg")+")",["click","touchstart"].forEach(function(t){e(n,t,o.closeButtonEvents.bind(o))}),n},o.prototype.closeButtonEvents=function(){this.closePopup()},o.prototype.showPopup=function(t){void 0===t&&(t="highcharts-annotation-toolbar");var o=this.container,i=this.closeButton;this.type=void 0,o.innerHTML=n.emptyHTML,0<=o.className.indexOf(t)&&(o.classList.remove(t),o.removeAttribute("style")),o.appendChild(i),o.style.display="block",o.style.height=""},o.prototype.closePopup=function(){this.container.style.display="none"},o;function o(t,o){this.iconsURL=o,this.container=this.createPopupContainer(t),this.closeButton=this.addCloseButton()}}),o(t,"Extensions/Annotations/Popup/PopupAnnotations.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(t,o){function p(i,n,e,t,s,o){var a,r,h,l,c=this;n&&(a=this.addInput,r=this.lang,v(t,function(t,o){h=""!==e?e+"."+o:o,y(t)&&(!g(t)||g(t)&&y(t[0])?((l=r[o]||o).match(/\d/g)||s.push([!0,l,i]),p.call(c,i,n,h,t,s,!1)):s.push([c,h,"annotation",i,t]))}),o&&(m(s,function(t){return t[1].match(/format/g)?-1:1}),d&&s.reverse(),s.forEach(function(t){!0===t[0]?f("span",{className:"highcharts-annotation-title"},void 0,t[2]).appendChild(u.createTextNode(t[1])):(t[4]={value:t[4][0],type:t[4][1]},a.apply(t[0],t.splice(1)))})))}var u=t.doc,d=t.isFirefox,f=o.createElement,g=o.isArray,y=o.isObject,v=o.objectEach,h=o.pick,m=o.stableSort;return{addForm:function(t,o,i,n){var e,s,a,r;t&&(e=this.container,s=this.lang,(a=f("h2",{className:"highcharts-popup-main-title"},void 0,e)).appendChild(u.createTextNode(s[o.langKey]||o.langKey||"")),a=f("div",{className:"highcharts-popup-lhs-col highcharts-popup-lhs-full"},void 0,e),r=f("div",{className:"highcharts-popup-bottom-row"},void 0,e),p.call(this,a,t,"",o,[],!0),this.addButton(r,n?s.addButton||"Add":s.saveButton||"Save",n?"add":"save",e,i))},addToolbar:function(t,o,i){var n=this,e=this.lang,s=this.container,a=this.showForm,r=(-1===s.className.indexOf("highcharts-annotation-toolbar")&&(s.className+=" highcharts-annotation-toolbar"),t&&(s.style.top=t.plotTop+10+"px"),f("span",void 0,void 0,s).appendChild(u.createTextNode(h(e[o.langKey]||o.langKey,o.shapes&&o.shapes[0].type,""))),this.addButton(s,e.removeButton||"Remove","remove",s,i));r.className+=" highcharts-annotation-remove-button",r.style["background-image"]="url("+this.iconsURL+"destroy.svg)",(r=this.addButton(s,e.editButton||"Edit","edit",s,function(){a.call(n,"annotation-edit",t,o,i)})).className+=" highcharts-annotation-edit-button",r.style["background-image"]="url("+this.iconsURL+"edit.svg)"}}}),o(t,"Extensions/Annotations/Popup/PopupIndicators.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Globals.js"],t["Extensions/Annotations/NavigationBindingsUtilities.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(u,t,o,i,n){function s(t){m("div",{className:"highcharts-popup-lhs-col"},void 0,t);t=m("div",{className:"highcharts-popup-rhs-col"},void 0,t),m("div",{className:"highcharts-popup-rhs-col-wrapper"},void 0,t)}function a(e,t,o,i){var s,n,a,r,h=this,l=h.lang,c=t.querySelectorAll(".highcharts-popup-lhs-col")[0],p=(t=t.querySelectorAll(".highcharts-popup-rhs-col")[0],"edit"===o);o=p?e.series:e.options.plotOptions||{},!e&&o||(n=[],p||b(o)?b(o)&&(n=function(t){var o=[];return t.forEach(function(t){t.is("sma")&&o.push({indicatorFullName:t.name,indicatorType:t.type,series:t})}),o}.call(this,o)):n=function(t,s){var a,o=this.chart&&this.chart.options.lang,r=o&&o.navigation&&o.navigation.popup&&o.navigation.popup.indicatorAliases,h=[];return C(t,function(t,o){var i,n,e=t&&t.options;(t.params||e&&e.params)&&(o=(e=f(t,o)).indicatorFullName,e=e.indicatorType,s?(i=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),i=new RegExp(i,"i"),n=r&&r[e]&&r[e].join(" ")||"",(o.match(i)||n.match(i))&&(a={indicatorFullName:o,indicatorType:e,series:t},h.push(a))):(a={indicatorFullName:o,indicatorType:e,series:t},h.push(a)))}),h}.call(this,o,i),E(n,function(t,o){return(t=t.indicatorFullName.toLowerCase())<(o=o.indicatorFullName.toLowerCase())?-1:o<t?1:0}),c.children[1]&&c.children[1].remove(),a=m("ul",{className:"highcharts-indicator-list"},void 0,c),r=t.querySelectorAll(".highcharts-popup-rhs-col-wrapper")[0],n.forEach(function(t){var o=t.indicatorFullName,i=t.indicatorType,n=t.series;(s=m("li",{className:"highcharts-indicator-list"},void 0,a)).appendChild(y.createTextNode(o)),["click","touchstart"].forEach(function(t){v(s,t,function(){var t=r.parentNode.children[1],o=n.params||n.options.params;r.innerHTML=u.emptyHTML,m("h3",{className:"highcharts-indicator-title"},void 0,r).appendChild(y.createTextNode(f(n,i).indicatorFullName)),m("input",{type:"hidden",name:"highcharts-type-"+i,value:i},void 0,r),g.call(h,i,"series",e,r,n,n.linkedParent&&n.linkedParent.options.id),o.volumeSeriesID&&g.call(h,i,"volume",e,r,n,n.linkedParent&&o.volumeSeriesID),d.call(h,e,"params",o,i,r),t&&(t.style.display="block"),p&&n.options&&m("input",{type:"hidden",name:"highcharts-id-"+i,value:n.options.id},void 0,r).setAttribute("highcharts-data-series-id",n.options.id)})})}),0<a.childNodes.length?a.childNodes[0].click():p||(u.setElementHTML(r.parentNode.children[0],l.noFilterMatch||""),r.parentNode.children[1].style.display="none"))}function d(n,e,t,s,a){var r,h=this;n&&(r=this.addInput,C(t,function(t,o){var i=e+"."+o;x(t)&&i&&(A(t)&&(r.call(h,i,s,a,{}),d.call(h,n,i,t,s,a)),i in p?(i=l.call(h,s,i,a),c.call(h,n,e,i,s,o,t)):"params.volumeSeriesID"===i||b(t)||r.call(h,i,s,a,{value:t,type:"number"}))}))}function l(t,o,i){var n=(n=o.split("."))[n.length-1],e=this.lang;return m("label",{htmlFor:t="highcharts-"+o+"-type-"+t},null,i).appendChild(y.createTextNode(e[n]||o)),(i=m("select",{name:t,className:"highcharts-popup-field",id:"highcharts-select-"+o},null,i)).setAttribute("id","highcharts-select-"+o),i}function c(t,n,e,o,i,s,a){"series"===n||"volume"===n?t.series.forEach(function(t){var o=t.options,i=o.name||o.params?t.name:o.id||"";"highcharts-navigator-series"!==o.id&&o.id!==(a&&a.options&&a.options.id)&&(x(s)||"volume"!==n||"column"!==t.type||(s=o.id),m("option",{value:o.id},void 0,e).appendChild(y.createTextNode(i)))}):o&&i&&r[i+"-"+o].forEach(function(t){m("option",{value:t},void 0,e).appendChild(y.createTextNode(t))}),x(s)&&(e.value=s)}function f(t,o){var i=t.options,n=e[o]&&e[o].prototype.nameBase||o.toUpperCase();return i&&i.type&&(o=t.options.type,n=t.name),{indicatorFullName:n,indicatorType:o}}function g(t,o,i,n,e,s){i&&(t=l.call(this,t,o,n),c.call(this,i,o,t,void 0,void 0,void 0,e),x(s)&&(t.value=s))}var p,y=t.doc,e=i.seriesTypes,v=n.addEvent,m=n.createElement,x=n.defined,b=n.isArray,A=n.isObject,C=n.objectEach,E=n.stableSort,r=((t=p=p||{})[t["params.algorithm"]=0]="params.algorithm",t[t["params.average"]=1]="params.average",{"algorithm-pivotpoints":["standard","fibonacci","camarilla"],"average-disparityindex":["sma","ema","dema","tema","wma"]});return{addForm:function(t,o,i){var n,e;o=this.lang,t&&(this.tabs.init.call(this,t),s((n=this.container.querySelectorAll(".highcharts-tab-item-content"))[0]),function(o,t){var i=this,n=t.querySelectorAll(".highcharts-popup-lhs-col")[0],e=(t=this.lang.clearFilter,n=m("div",{className:"highcharts-input-wrapper"},void 0,n),this.addInput("searchIndicators","input",n,{value:"",type:"text",htmlFor:"search-indicators",labelClassName:"highcharts-input-search-indicators-label"})),s=m("a",{textContent:t},void 0,n);e.classList.add("highcharts-input-search-indicators"),s.classList.add("clear-filter-button"),v(e,"input",function(t){a.call(i,o,i.container,"add",this.value),s.style.display=this.value.length?"inline-block":"none"}),["click","touchstart"].forEach(function(t){v(s,t,function(){e.value="",a.call(i,o,i.container,"add",""),s.style.display="none"})})}.call(this,t,n[0]),a.call(this,t,n[0],"add"),e=n[0].querySelectorAll(".highcharts-popup-rhs-col")[0],this.addButton(e,o.addButton||"add","add",e,i),s(n[1]),a.call(this,t,n[1],"edit"),e=n[1].querySelectorAll(".highcharts-popup-rhs-col")[0],this.addButton(e,o.saveButton||"save","edit",e,i),this.addButton(e,o.removeButton||"remove","remove",e,i))},getAmount:function(){var o=0;return this.series.forEach(function(t){(t.params||t.options.params)&&o++}),o}}}),o(t,"Extensions/Annotations/Popup/PopupTabs.js",[t["Core/Globals.js"],t["Core/Utilities.js"]],function(t,o){function i(){return h("div",{className:"highcharts-tab-item-content highcharts-no-mousewheel"},void 0,this.container)}function n(t,o){var i=this.container,n=this.lang,e="highcharts-tab-item";return 0===o&&(e+=" highcharts-tab-disabled"),(o=h("span",{className:e},void 0,i)).appendChild(a.createTextNode(n[t+"Button"]||t)),o.setAttribute("highcharts-data-tab-type",t),o}function s(t,o){var i=this.container.querySelectorAll(".highcharts-tab-item-content");t.className+=" highcharts-tab-item-active",i[o].className+=" highcharts-tab-item-show"}var a=t.doc,r=o.addEvent,h=o.createElement;return{init:function(t){var o;t&&(t=this.indicators.getAmount.call(t),o=n.call(this,"add"),n.call(this,"edit",t),i.call(this),i.call(this),function(t){var e=this;this.container.querySelectorAll(".highcharts-tab-item").forEach(function(o,n){0===t&&"edit"===o.getAttribute("highcharts-data-tab-type")||["click","touchstart"].forEach(function(t){r(o,t,function(){for(var t=(o=e.container).querySelectorAll(".highcharts-tab-item"),o=o.querySelectorAll(".highcharts-tab-item-content"),i=0;i<t.length;i++)t[i].classList.remove("highcharts-tab-item-active"),o[i].classList.remove("highcharts-tab-item-show");s.call(e,this,n)})})})}.call(this,t),s.call(this,o,0))}}}),o(t,"Extensions/Annotations/Popup/Popup.js",[t["Shared/BaseForm.js"],t["Core/Globals.js"],t["Core/Defaults.js"],t["Extensions/Annotations/Popup/PopupAnnotations.js"],t["Extensions/Annotations/Popup/PopupIndicators.js"],t["Extensions/Annotations/Popup/PopupTabs.js"],t["Core/Utilities.js"]],function(t,o,i,n,e,s,a){var r,h,l=this&&this.__extends||(r=function(t,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])})(t,o)},function(t,o){function i(){this.constructor=t}if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");r(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}),c=o.doc,p=i.getOptions,u=a.addEvent,d=a.createElement,f=(o=a.extend,a.fireEvent),g=a.pick;function y(t,o,i){return(t=h.call(this,t,o)||this).chart=i,t.lang=p().lang.navigation.popup,u(t.container,"mousedown",function(){var t,o=i&&i.navigationBindings&&i.navigationBindings.activeAnnotation;o&&(o.cancelClick=!0,t=u(c,"click",function(){setTimeout(function(){o.cancelClick=!1},0),t()}))}),t}return l(y,h=t),y.prototype.addInput=function(t,o,i,n){var e=(e=t.split("."))[e.length-1],s=this.lang;return o="highcharts-"+o+"-"+g(n.htmlFor,e),e.match(/^\d+$/)||d("label",{htmlFor:o,className:n.labelClassName},void 0,i).appendChild(c.createTextNode(s[e]||e)),(i=d("input",{name:o,value:n.value,type:n.type,className:"highcharts-popup-field"},void 0,i)).setAttribute("highcharts-data-name",t),i},y.prototype.closeButtonEvents=function(){var t;this.chart?(t=this.chart.navigationBindings,f(t,"closePopup"),t&&t.selectedButtonElement&&f(t,"deselectButton",{button:t.selectedButtonElement})):h.prototype.closeButtonEvents.call(this)},y.prototype.addButton=function(t,o,a,r,h){var l=this,i=d("button",void 0,void 0,t);return i.appendChild(c.createTextNode(o)),h&&["click","touchstart"].forEach(function(t){u(i,t,function(){return l.closePopup(),h((t=r,o=a,i=Array.prototype.slice.call(t.querySelectorAll("input")),n=Array.prototype.slice.call(t.querySelectorAll("select")),e=t.querySelectorAll("#highcharts-select-series > option:checked")[0],t=t.querySelectorAll("#highcharts-select-volume > option:checked")[0],s={actionType:o,linkedTo:e&&e.getAttribute("value")||"",fields:{}},i.forEach(function(t){var o=t.getAttribute("highcharts-data-name");t.getAttribute("highcharts-data-series-id")?s.seriesId=t.value:o?s.fields[o]=t.value:s.type=t.value}),n.forEach(function(t){var o=t.id;"highcharts-select-series"!==o&&"highcharts-select-volume"!==o&&(o=o.split("highcharts-select-")[1],s.fields[o]=t.value)}),t&&(s.fields["params.volumeSeriesID"]=t.getAttribute("value")||""),s));var t,o,i,n,e,s})}),i},y.prototype.showForm=function(t,o,i,n){o&&(this.showPopup(),"indicators"===t&&this.indicators.addForm.call(this,o,i,n),"annotation-toolbar"===t&&this.annotations.addToolbar.call(this,o,i,n),"annotation-edit"===t&&this.annotations.addForm.call(this,o,i,n),"flag"===t&&this.annotations.addForm.call(this,o,i,n,!0),this.type=t,this.container.style.height=this.container.offsetHeight+"px")},o((t=y).prototype,{annotations:n,indicators:e,tabs:s}),t}),o(t,"Extensions/Annotations/Popup/PopupComposition.js",[t["Extensions/Annotations/Popup/Popup.js"],t["Core/Utilities.js"]],function(o,i){function n(){this.popup&&this.popup.closePopup()}function e(t){this.popup||(this.popup=new o(this.chart.container,this.chart.options.navigation.iconsURL||this.chart.options.stockTools&&this.chart.options.stockTools.gui.iconsURL||"https://code.highcharts.com/11.0.1/gfx/stock-icons/",this.chart)),this.popup.showForm(t.formType,this.chart,t.options,t.onSubmit)}function s(t,o){this.inClass(o.target,"highcharts-popup")||t.apply(this,Array.prototype.slice.call(arguments,1))}var a=i.addEvent,r=i.wrap,h=[];return{compose:function(t,o){i.pushUnique(h,t)&&(a(t,"closePopup",n),a(t,"showPopup",e)),i.pushUnique(h,o)&&r(o.prototype,"onContainerMouseDown",s)}}}),o(t,"Extensions/Annotations/Annotation.js",[t["Core/Animation/AnimationUtilities.js"],t["Extensions/Annotations/AnnotationChart.js"],t["Extensions/Annotations/AnnotationDefaults.js"],t["Extensions/Annotations/Controllables/ControllableRect.js"],t["Extensions/Annotations/Controllables/ControllableCircle.js"],t["Extensions/Annotations/Controllables/ControllableEllipse.js"],t["Extensions/Annotations/Controllables/ControllablePath.js"],t["Extensions/Annotations/Controllables/ControllableImage.js"],t["Extensions/Annotations/Controllables/ControllableLabel.js"],t["Extensions/Annotations/ControlPoint.js"],t["Extensions/Annotations/ControlTarget.js"],t["Extensions/Annotations/EventEmitter.js"],t["Extensions/Annotations/MockPoint.js"],t["Extensions/Annotations/NavigationBindings.js"],t["Extensions/Annotations/Popup/PopupComposition.js"],t["Core/Utilities.js"]],function(t,n,o,i,e,s,a,r,h,l,c,p,u,d,f,g){function y(o,n){var e={};return["labels","shapes"].forEach(function(t){var i=o[t];i&&(e[t]=n[t]?k(n[t]).map(function(t,o){return w(i[o],t)}):o[t])}),e}var v,m,x=this&&this.__extends||(v=function(t,o){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])})(t,o)},function(t,o){function i(){this.constructor=t}if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");v(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}),b=t.getDeferredAnimation,A=g.destroyObjectProperties,C=g.erase,E=g.fireEvent,w=g.merge,P=g.pick,k=g.splat;function O(t,o){var i=m.call(this)||this;return i.coll="annotations",i.animationConfig=void 0,i.graphic=void 0,i.group=void 0,i.labelCollector=void 0,i.labelsGroup=void 0,i.shapesGroup=void 0,i.chart=t,i.points=[],i.controlPoints=[],i.coll="annotations",i.index=-1,i.labels=[],i.shapes=[],i.options=w(i.defaultOptions,o),i.userOptions=o,o=y(i.options,o),i.options.labels=o.labels,i.options.shapes=o.shapes,i.init(t,i.options),i}return x(O,m=p),O.compose=function(t,o,i){n.compose(O,t,o),h.compose(i),a.compose(t,i),d.compose(O,t),f.compose(d,o)},O.prototype.addClipPaths=function(){this.setClipAxes(),this.clipXAxis&&this.clipYAxis&&this.options.crop&&(this.clipRect=this.chart.renderer.clipRect(this.getClipBox()))},O.prototype.addLabels=function(){var i=this,n=this.options.labels||[];n.forEach(function(t,o){t=i.initLabel(t,o),w(!0,n[o],t.options)})},O.prototype.addShapes=function(){var i=this,n=this.options.shapes||[];n.forEach(function(t,o){t=i.initShape(t,o),w(!0,n[o],t.options)})},O.prototype.destroy=function(){function t(t){t.destroy()}var o=this.chart;this.labels.forEach(t),this.shapes.forEach(t),this.clipYAxis=this.clipXAxis=null,C(o.labelCollectors,this.labelCollector),m.prototype.destroy.call(this),this.destroyControlTarget(),A(this,o)},O.prototype.destroyItem=function(t){C(this[t.itemType+"s"],t),t.destroy()},O.prototype.getClipBox=function(){if(this.clipXAxis&&this.clipYAxis)return{x:this.clipXAxis.left,y:this.clipYAxis.top,width:this.clipXAxis.width,height:this.clipYAxis.height}},O.prototype.initProperties=function(t,o){this.setOptions(o);var i=y(this.options,o);this.options.labels=i.labels,this.options.shapes=i.shapes,this.chart=t,this.points=[],this.controlPoints=[],this.coll="annotations",this.userOptions=o,this.labels=[],this.shapes=[]},O.prototype.init=function(t,o,i){void 0===i&&(i=this.index),t=this.chart,o=this.options.animation,this.index=i,this.linkPoints(),this.addControlPoints(),this.addShapes(),this.addLabels(),this.setLabelCollector(),this.animationConfig=b(t,o)},O.prototype.initLabel=function(t,o){return t=w(this.options.labelOptions,{controlPointOptions:this.options.controlPointOptions},t),(o=new h(this,t,o)).itemType="label",this.labels.push(o),o},O.prototype.initShape=function(t,o){return t=w(this.options.shapeOptions,{controlPointOptions:this.options.controlPointOptions},t),(o=new O.shapesMap[t.type](this,t,o)).itemType="shape",this.shapes.push(o),o},O.prototype.redraw=function(t){this.linkPoints(),this.graphic||this.render(),this.clipRect&&this.clipRect.animate(this.getClipBox()),this.redrawItems(this.shapes,t),this.redrawItems(this.labels,t),this.redrawControlPoints(t)},O.prototype.redrawItem=function(t,o){var i;t.linkPoints(),t.shouldBeDrawn()?(t.graphic||this.renderItem(t),t.redraw(P(o,!0)&&t.graphic.placed),t.points.length&&(i=(o=t).graphic,o=t.points.some(function(t){return!1!==t.series.visible&&!1!==t.visible}),i&&(o?"hidden"===i.visibility&&i.show():i.hide()))):this.destroyItem(t)},O.prototype.redrawItems=function(t,o){for(var i=t.length;i--;)this.redrawItem(t[i],o)},O.prototype.remove=function(){return this.chart.removeAnnotation(this)},O.prototype.render=function(){var t=this.chart.renderer;this.graphic=t.g("annotation").attr({opacity:0,zIndex:this.options.zIndex,visibility:this.options.visible?"inherit":"hidden"}).add(),this.shapesGroup=t.g("annotation-shapes").add(this.graphic),this.options.crop&&this.shapesGroup.clip(this.chart.plotBoxClip),this.labelsGroup=t.g("annotation-labels").attr({translateX:0,translateY:0}).add(this.graphic),this.addClipPaths(),this.clipRect&&this.graphic.clip(this.clipRect),this.renderItems(this.shapes),this.renderItems(this.labels),this.addEvents(),this.renderControlPoints()},O.prototype.renderItem=function(t){t.render("label"===t.itemType?this.labelsGroup:this.shapesGroup)},O.prototype.renderItems=function(t){for(var o=t.length;o--;)this.renderItem(t[o])},O.prototype.setClipAxes=function(){var i=this.chart.xAxis,n=this.chart.yAxis,t=(this.options.labels||[]).concat(this.options.shapes||[]).reduce(function(t,o){return o=o&&(o.point||o.points&&o.points[0]),[i[o&&o.xAxis]||t[0],n[o&&o.yAxis]||t[1]]},[]);this.clipXAxis=t[0],this.clipYAxis=t[1]},O.prototype.setControlPointsVisibility=function(o){function t(t){t.setControlPointsVisibility(o)}this.controlPoints.forEach(function(t){t.setVisibility(o)}),this.shapes.forEach(t),this.labels.forEach(t)},O.prototype.setLabelCollector=function(){var t=this;t.labelCollector=function(){return t.labels.reduce(function(t,o){return o.options.allowOverlap||t.push(o.graphic),t},[])},t.chart.labelCollectors.push(t.labelCollector)},O.prototype.setOptions=function(t){this.options=w(this.defaultOptions,t)},O.prototype.setVisibility=function(t){var o=this.options,i=this.chart.navigationBindings,n=P(t,!o.visible);this.graphic.attr("visibility",n?"inherit":"hidden"),n||(this.shapes.forEach(t=function(t){t.setControlPointsVisibility(n)}),this.labels.forEach(t),i.activeAnnotation===this&&i.popup&&"annotation-toolbar"===i.popup.type&&E(i,"closePopup")),o.visible=n},O.prototype.update=function(t,o){var i=this.chart,n=y(this.userOptions,t),e=i.annotations.indexOf(this);(t=w(!0,this.userOptions,t)).labels=n.labels,t.shapes=n.shapes,this.destroy(),this.initProperties(i,t),this.init(i,t),i.options.annotations[e]=t,this.isUpdating=!0,P(o,!0)&&i.redraw(),E(this,"afterUpdate"),this.isUpdating=!1},O.ControlPoint=l,O.MockPoint=u,O.shapesMap={rect:i,circle:e,ellipse:s,path:a,image:r},O.types={},(t=O).prototype.defaultOptions=o,t.prototype.nonDOMEvents=["add","afterUpdate","drag","remove"],c.compose(t),t}),o(t,"masters/modules/annotations.src.js",[t["Core/Globals.js"],t["Extensions/Annotations/Annotation.js"]],function(t,o){(t.Annotation=o).compose(t.Chart,t.Pointer,t.SVGRenderer)})});