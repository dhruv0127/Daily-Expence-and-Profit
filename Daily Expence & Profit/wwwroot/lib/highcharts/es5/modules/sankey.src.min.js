!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/sankey",["highcharts"],function(o){return t(o),t.Highcharts=o,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){"use strict";o=o?o._modules:{};function t(o,t,e,i){o.hasOwnProperty(t)||(o[t]=i.apply(null,e),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:o[t]}})))}t(o,"Series/NodesComposition.js",[o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"]],function(o,e){var t,i,o=o.series,n=o.prototype,d=o.prototype.pointClass.prototype,s=e.defined,r=e.extend,a=e.find,p=e.merge,h=e.pick;function l(){return this.data=[].concat(this.points||[],this.nodes),n.destroy.apply(this,arguments)}function c(){this.nodes&&(this.nodes.forEach(function(o){o.destroy()}),this.nodes.length=0),n.setData.apply(this,arguments)}function u(o){var t=arguments,e=this.isNode?this.linksTo.concat(this.linksFrom):[this.fromNode,this.toNode];"select"!==o&&e.forEach(function(o){o&&o.series&&(d.setState.apply(o,t),o.isNode||(o.fromNode.graphic&&d.setState.apply(o.fromNode,t),o.toNode&&o.toNode.graphic&&d.setState.apply(o.toNode,t)))}),d.setState.apply(this,t)}function f(o,t,e,i){var n=this,s=this.series.options.nodes,r=this.series.options.data,a=r&&r.length||0,l=r&&r[this.index];d.update.call(this,o,!this.isNode&&t,e,i),this.isNode&&(o=(s||[]).reduce(function(o,t,e){return n.id===t.id?e:o},-1),i=p(s&&s[o]||{},r&&r[this.index]||{}),r&&(l?r[this.index]=l:r.length=a),s?0<=o?s[o]=i:s.push(i):this.series.options.nodes=[i],h(t,!0)&&this.series.chart.redraw(e))}return o=t=t||{},i=[],o.compose=function(o,t){return e.pushUnique(i,o)&&((o=o.prototype).setNodeState=u,o.setState=u,o.update=f),e.pushUnique(i,t)&&((o=t.prototype).destroy=l,o.setData=c),t},o.createNode=function(o){function t(o,t){return a(o,function(o){return o.id===t})}var e,n,i=this.pointClass,s=t(this.nodes,o);return s||(e=this.options.nodes&&t(this.options.nodes,o),(n=(new i).init(this,r({className:"highcharts-node",isNode:!0,id:o,y:1},e))).linksTo=[],n.linksFrom=[],n.getSum=function(){var t=0,e=0;return n.linksTo.forEach(function(o){t+=o.weight||0}),n.linksFrom.forEach(function(o){e+=o.weight||0}),Math.max(t,e)},n.offset=function(o,t){for(var e=0,i=0;i<n[t].length;i++){if(n[t][i]===o)return e;e+=n[t][i].weight}},n.hasShape=function(){var t=0;return n.linksTo.forEach(function(o){o.outgoing&&t++}),!n.linksTo.length||t!==n.linksTo.length},n.index=this.nodes.push(n)-1,s=n),s.formatPrefix="node",s.name=s.name||s.options.id||"",s.mass=h(s.options.mass,s.options.marker&&s.options.marker.radius,this.options.marker&&this.options.marker.radius,4),s},o.destroy=l,o.generatePoints=function(){var t=this,e=this.chart,i={};n.generatePoints.call(this),this.nodes||(this.nodes=[]),this.colorCounter=0,this.nodes.forEach(function(o){o.linksFrom.length=0,o.linksTo.length=0,o.level=o.options.level}),this.points.forEach(function(o){s(o.from)&&(i[o.from]||(i[o.from]=t.createNode(o.from)),i[o.from].linksFrom.push(o),o.fromNode=i[o.from],e.styledMode?o.colorIndex=h(o.options.colorIndex,i[o.from].colorIndex):o.color=o.options.color||i[o.from].color),s(o.to)&&(i[o.to]||(i[o.to]=t.createNode(o.to)),i[o.to].linksTo.push(o),o.toNode=i[o.to]),o.name=o.name||o.id},this),this.nodeLookup=i},o.setNodeState=u,o.updateNode=f,t}),t(o,"Series/Sankey/SankeyPoint.js",[o["Core/Series/Point.js"],o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"]],function(e,o,t){var i,n,s=this&&this.__extends||(i=function(o,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(o,t)},function(o,t){function e(){this.constructor=o}i(o,t),o.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),o=o.seriesTypes.column,r=t.defined;function a(){var o=null!==n&&n.apply(this,arguments)||this;return o.className=void 0,o.fromNode=void 0,o.level=void 0,o.linkBase=void 0,o.linksFrom=void 0,o.linksTo=void 0,o.mass=void 0,o.nodeX=void 0,o.nodeY=void 0,o.options=void 0,o.series=void 0,o.toNode=void 0,o}return n=o.prototype.pointClass,s(a,n),a.prototype.applyOptions=function(o,t){return e.prototype.applyOptions.call(this,o,t),r(this.options.level)&&(this.options.column=this.column=this.options.level),this},a.prototype.getClassName=function(){return(this.isNode?"highcharts-node ":"highcharts-link ")+e.prototype.getClassName.call(this)},a.prototype.getFromNode=function(){for(var o,t=-1,e=0;e<this.linksTo.length;e++){var i=this.linksTo[e];i.fromNode.column>t&&i.fromNode!==this&&(t=(o=i.fromNode).column)}return{fromNode:o,fromColumn:t}},a.prototype.setNodeColumn=function(){var o=this;r(o.options.column)||(0===o.linksTo.length?o.column=0:o.column=o.getFromNode().fromColumn+1)},a.prototype.isValid=function(){return this.isNode||"number"==typeof this.weight},a}),t(o,"Series/Sankey/SankeySeriesDefaults.js",[],function(){return{borderWidth:0,colorByPoint:!0,curveFactor:.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},format:void 0,formatter:function(){},inside:!0},inactiveOtherPoints:!0,linkOpacity:.5,opacity:1,minLinkWidth:0,nodeWidth:20,nodePadding:10,showInLegend:!1,states:{hover:{linkOpacity:1,opacity:1},inactive:{linkOpacity:.1,opacity:.1,animation:{duration:50}}},tooltip:{followPointer:!0,headerFormat:'<span style="font-size: 0.8em">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} â†’ {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}}}),t(o,"Series/Sankey/SankeyColumnComposition.js",[o["Core/Utilities.js"]],function(o){var t,h=o.defined,c=o.relativeLength,o=t=t||{},e=(o.compose=function(o,t){return o.sankeyColumn=new e(o,t),o},i.prototype.getTranslationFactor=function(o){for(var t,e,i=this.points,n=i.slice(),s=o.chart,r=o.options.minLinkWidth||0,a=0,l=(s.plotSizeY||0)-(o.options.borderWidth||0)-(i.length-1)*o.nodePadding;i.length;){for(a=l/i.sankeyColumn.sum(),t=!1,e=i.length;e--;)i[e].getSum()*a<r&&(i.splice(e,1),l-=r,t=!0);if(!t)break}return i.length=0,n.forEach(function(o){i.push(o)}),a},i.prototype.top=function(e){var i=this.series,n=i.nodePadding,o=this.points.reduce(function(o,t){return 0<o&&(o+=n),o+=Math.max(t.getSum()*e,i.options.minLinkWidth||0)},0);return((i.chart.plotSizeY||0)-o)/2},i.prototype.left=function(e){var i=this.series,o=i.chart,n=i.options.equalNodes,s=o.inverted?o.plotHeight:o.plotWidth,r=i.nodePadding,t=this.points.reduce(function(o,t){return 0<o&&(o+=r),o+=n?s/t.series.nodes.length-r:Math.max(t.getSum()*e,i.options.minLinkWidth||0)},0);return((o.plotSizeX||0)-Math.round(t))/2},i.prototype.sum=function(){return this.points.reduce(function(o,t){return o+t.getSum()},0)},i.prototype.offset=function(o,t){var e=this.points,i=this.series,n=i.nodePadding,s=0;if(i.is("organization")&&o.hangsFrom)return{absoluteTop:o.hangsFrom.nodeY};for(var r=0;r<e.length;r++){var a=e[r].getSum(),l=Math.max(a*t,i.options.minLinkWidth||0),d=o.options[i.chart.inverted?"offsetHorizontal":"offsetVertical"],p=o.options.offset||0,a=a?l+n:0;if(e[r]===o)return{relativeTop:s+(h(d)?c(d,l):c(p,a))};s+=a}},i);function i(o,t){this.points=o,this.series=t}return o.SankeyColumnAdditions=e,t}),t(o,"Series/TreeUtilities.js",[o["Core/Color/Color.js"],o["Core/Utilities.js"]],function(f,o){var h=o.extend,l=o.isArray,d=o.isNumber,p=o.isObject,c=o.merge,m=o.pick;return{getColor:function(o,t){var e,i,n,s=t.index,r=t.mapOptionsToLevel,a=t.parentColor,l=t.parentColorIndex,d=t.series,p=t.colors,h=t.siblings,c=d.points,u=d.chart.options.chart;return o&&(c=c[o.i],r=r[o.level]||{},c&&r.colorByPoint&&(e=c.index%(p?p.length:u.colorCount),n=p&&p[e]),d.chart.styledMode||(i=m(c&&c.options.color,r&&r.color,n,a&&(o=a,(u=r&&r.colorVariation)&&"brightness"===u.key&&s&&h?f.parse(o).brighten(u.to*(s/h)).get():o),d.color)),n=m(c&&c.options.colorIndex,r&&r.colorIndex,e,l,t.colorIndex)),{color:i,colorIndex:n}},getLevelOptions:function(o){var n,t,e,s,i,r,a={};if(p(o))for(s=d(o.from)?o.from:1,r=o.levels,t={},n=p(o.defaults)?o.defaults:{},l(r)&&(t=r.reduce(function(o,t){var e,i;return p(t)&&d(t.level)&&(i=c({},t),e=m(i.levelIsConstant,n.levelIsConstant),delete i.levelIsConstant,delete i.level,t=t.level+(e?0:s-1),p(o[t])?c(!0,o[t],i):o[t]=i),o},{})),i=d(o.to)?o.to:1,e=0;e<=i;e++)a[e]=c({},n,p(t[e])?t[e]:{});return a},setTreeValues:function i(n,s){var o=s.before,t=s.idRoot,e=s.mapIdToNode[t],r=!1!==s.levelIsConstant,a=s.points[n.i],l=a&&a.options||{},d=[],p=0,r=(n.levelDynamic=n.level-(r?0:e.level),n.name=m(a&&a.name,""),n.visible=t===n.id||!0===s.visible,(n="function"==typeof o?o(n,s):n).children.forEach(function(o,t){var e=h({},s);h(e,{index:t,siblings:n.children.length,visible:n.visible}),o=i(o,e),d.push(o),o.visible&&(p+=o.val)}),m(l.value,p));return n.visible=0<=r&&(0<p||n.visible),n.children=d,n.childrenTotal=p,n.isLeaf=n.visible&&!p,n.val=r,n},updateRootId:function(o){var t;return p(o)&&(t=p(o.options)?o.options:{},t=m(o.rootNode,t.rootId,""),p(o.userOptions)&&(o.userOptions.rootId=t),o.rootNode=t),t}}}),t(o,"Series/Sankey/SankeySeries.js",[o["Core/Color/Color.js"],o["Core/Globals.js"],o["Series/NodesComposition.js"],o["Series/Sankey/SankeyPoint.js"],o["Series/Sankey/SankeySeriesDefaults.js"],o["Core/Series/SeriesRegistry.js"],o["Series/Sankey/SankeyColumnComposition.js"],o["Series/TreeUtilities.js"],o["Core/Utilities.js"]],function(a,o,e,t,i,n,s,r,l){var d,p,h=this&&this.__extends||(d=function(o,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(o,t)},function(o,t){function e(){this.constructor=o}d(o,t),o.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),c=n.series,u=n.seriesTypes.column,f=r.getLevelOptions,r=l.extend,m=l.isObject,y=l.merge,v=l.pick,g=l.relativeLength,k=l.stableSort,l=(h(C,p=u),C.getDLOptions=function(o){var t=m(o.optionsPoint)?o.optionsPoint.dataLabels:{},o=m(o.level)?o.level.dataLabels:{};return y({style:{}},o,t)},C.prototype.createNodeColumns=function(){var t=[];this.nodes.forEach(function(o){o.setNodeColumn(),t[o.column]||(t[o.column]=s.compose([],this)),t[o.column].push(o)},this);for(var o=0;o<t.length;o++)void 0===t[o]&&(t[o]=s.compose([],this));return t},C.prototype.order=function(o,t){var e=this;void 0===o.level&&(o.level=t,o.linksFrom.forEach(function(o){o.toNode&&e.order(o.toNode,t+1)}))},C.prototype.generatePoints=function(){e.generatePoints.apply(this,arguments);var t=this;this.orderNodes&&(this.nodes.filter(function(o){return 0===o.linksTo.length}).forEach(function(o){t.order(o,0)}),k(this.nodes,function(o,t){return o.level-t.level}))},C.prototype.getNodePadding=function(){var o,t=this.options.nodePadding||0;return t=this.nodeColumns&&(o=this.nodeColumns.reduce(function(o,t){return Math.max(o,t.length)},0))*t>this.chart.plotSizeY?this.chart.plotSizeY/o:t},C.prototype.hasData=function(){return!!this.processedXData.length},C.prototype.pointAttribs=function(o,t){if(!o)return{};var e=this,i=(o.isNode?o:o.fromNode).level,n=e.mapOptionsToLevel[i||0]||{},s=o.options,r=n.states&&n.states[t||""]||{},i=["colorByPoint","borderColor","borderWidth","linkOpacity","opacity"].reduce(function(o,t){return o[t]=v(r[t],s[t],n[t],e.options[t]),o},{}),t=v(r.color,s.color,(i.colorByPoint?o:n).color);return o.isNode?{fill:t,stroke:i.borderColor,"stroke-width":i.borderWidth,opacity:i.opacity}:{fill:a.parse(t).setOpacity(i.linkOpacity).get()}},C.prototype.drawTracker=function(){u.prototype.drawTracker.call(this,this.points),u.prototype.drawTracker.call(this,this.nodes)},C.prototype.drawPoints=function(){u.prototype.drawPoints.call(this,this.points),u.prototype.drawPoints.call(this,this.nodes)},C.prototype.drawDataLabels=function(){u.prototype.drawDataLabels.call(this,this.points),u.prototype.drawDataLabels.call(this,this.nodes)},C.prototype.translate=function(){this.processedXData||this.processData(),this.generatePoints(),this.nodeColumns=this.createNodeColumns(),this.nodeWidth=g(this.options.nodeWidth,this.chart.plotSizeX);var e=this,o=this.chart,t=this.options,i=this.nodeWidth,n=this.nodeColumns;this.nodePadding=this.getNodePadding(),this.translationFactor=n.reduce(function(o,t){return Math.min(o,t.sankeyColumn.getTranslationFactor(e))},1/0),this.colDistance=(o.plotSizeX-i-t.borderWidth)/Math.max(1,n.length-1),e.mapOptionsToLevel=f({from:1,levels:t.levels,to:n.length-1,defaults:{borderColor:t.borderColor,borderRadius:t.borderRadius,borderWidth:t.borderWidth,color:e.color,colorByPoint:t.colorByPoint,levelIsConstant:!0,linkColor:t.linkColor,linkLineWidth:t.linkLineWidth,linkOpacity:t.linkOpacity,states:t.states}}),n.forEach(function(t){t.forEach(function(o){e.translateNode(o,t)})},this),this.nodes.forEach(function(o){o.linksFrom.forEach(function(o){(o.weight||o.isNull)&&o.to&&(e.translateLink(o),o.allowShadow=!1)})})},C.prototype.translateLink=function(e){function o(o,t){return t=o.offset(e,t)*k,Math.min(o.nodeY+t,o.nodeY+(o.shapeArgs&&o.shapeArgs.height||0)-C)}var t,i,n,s,r,a,l,d,p,h,c,u,f,m,y=e.fromNode,v=e.toNode,g=this.chart,k=this.translationFactor,C=Math.max(e.weight*k,this.options.minLinkWidth),S=this.options,S=(g.inverted?-this.colDistance:this.colDistance)*S.curveFactor,b=o(y,"linksFrom"),N=o(v,"linksTo"),L=y.nodeX,x=this.nodeWidth,v=v.nodeX,P=e.outgoing,w=L+x<v;g.inverted&&(b=g.plotSizeY-b,N=(g.plotSizeY||0)-N,x=-x,C=-C,w=v<L),e.shapeType="path",e.linkBase=[b,b+C,N,N+C],w&&"number"==typeof N?e.shapeArgs={d:[["M",L+x,b],["C",L+x+S,b,v-S,N,v,N],["L",v+(P?x:0),N+C/2],["L",v,N+C],["C",v-S,N+C,L+x+S,b+C,L+x,b+C],["Z"]]}:"number"==typeof N&&(w=g.plotHeight-b-C,P=v-20-C,i=(t=(S=L+x)+20)+C,a=(r=(w=(s=(n=(p=b)+C)+20)+w)+20)+C,h=n-.7*C,c=r+.7*C,u=(d=(l=N)+C)-.7*C,f=v-.7*C,m=S+.7*C,e.shapeArgs={d:[["M",S,p],["C",m,p,i,h,i,s],["L",i,w],["C",i,c,m,a,S,a],["L",v,a],["C",f,a,P,c,P,w],["L",P,p=d+20],["C",P,u,f,l,v,l],["L",v,d],["C",h=v-20,d,h,d,h,p],["L",h,w],["C",h,r,h,r,v,r],["L",S,r],["C",t,r,t,r,t,w],["L",t,s],["C",t,n,t,n,S,n],["Z"]]}),e.dlBox={x:L+(v-L+x)/2,y:b+(N-b)/2,height:C,width:0},e.tooltipPos=g.inverted?[g.plotSizeY-e.dlBox.y-C/2,g.plotSizeX-e.dlBox.x]:[e.dlBox.x,e.dlBox.y+C/2],e.y=e.plotY=1,e.x=e.plotX=1,e.color||(e.color=y.color)},C.prototype.translateNode=function(o,t){var e=this.translationFactor,i=this.chart,n=this.options,s=n.borderRadius,r=n.borderWidth,r=void 0===r?0:r,a=o.getSum(),l=Math.max(Math.round(a*e),this.options.minLinkWidth),d=Math.round(this.nodeWidth),p=Math.round(r)%2/2,h=t.sankeyColumn.offset(o,e),t=Math.floor(v(h.absoluteTop,t.sankeyColumn.top(e)+h.relativeTop))+p,e=Math.floor(this.colDistance*o.column+r/2)+g(o.options.offsetHorizontal||0,d)+p,h=i.inverted?i.plotSizeX-e:e;(o.sum=a)?(o.shapeType="roundedRect",r=o.nodeX=h,p=o.nodeY=t,e=o.options.width||n.width||d,a=o.options.height||n.height||l,s=g("object"==typeof s?s.radius:s||0,e),i.inverted&&(r=h-d,p=i.plotSizeY-t-l,e=o.options.height||n.height||d,a=o.options.width||n.width||l),o.dlOptions=C.getDLOptions({level:this.mapOptionsToLevel[o.level],optionsPoint:o.options}),o.plotX=1,o.plotY=1,o.tooltipPos=i.inverted?[i.plotSizeY-p-a/2,i.plotSizeX-r-e/2]:[r+e/2,p+a/2],o.shapeArgs={x:r,y:p,width:e,height:a,r:s,display:o.hasShape()?"":"none"}):o.dlOptions={enabled:!1}},C.defaultOptions=y(u.defaultOptions,i),C);function C(){var o=null!==p&&p.apply(this,arguments)||this;return o.colDistance=void 0,o.data=void 0,o.group=void 0,o.nodeLookup=void 0,o.nodePadding=void 0,o.nodes=void 0,o.nodeWidth=void 0,o.options=void 0,o.points=void 0,o.translationFactor=void 0,o}return e.compose(t,l),r(l.prototype,{animate:c.prototype.animate,createNode:e.createNode,forceDL:!0,invertible:!0,isCartesian:!1,orderNodes:!0,noSharedTooltip:!0,pointArrayMap:["from","to","weight"],pointClass:t,searchPoint:o.noop}),n.registerSeriesType("sankey",l),l}),t(o,"masters/modules/sankey.src.js",[],function(){})});