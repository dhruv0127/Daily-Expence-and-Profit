!function(r){"object"==typeof module&&module.exports?module.exports=r.default=r:"function"==typeof define&&define.amd?define("highcharts/modules/draggable-points",["highcharts"],function(e){return r(e),r.Highcharts=e,r}):r("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function r(e,r,t,o){e.hasOwnProperty(r)||(e[r]=o.apply(null,t),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:r,module:e[r]}})))}r(e,"Extensions/DraggablePoints.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Chart/Chart.js"],e["Core/Globals.js"],e["Core/Series/Point.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(e,r,o,t,a,i,n){var s=e.animObject,d=i.seriesTypes,u=n.addEvent,m=n.clamp,f=n.isNumber,y=n.merge,v=n.objectEach,D=n.pick;function h(e){return{left:"right",right:"left",top:"bottom",bottom:"top"}[e]}function p(e){var r=(e=e.shapeArgs||e.graphic.getBBox()).r||0,t=e.height-r,e=e.height/2;return[["M",0,r],["L",0,e-5],["A",1,1,0,0,0,0,5+e],["A",1,1,0,0,0,0,e-5],["M",0,5+e],["L",0,t]]}var g,e=a.prototype.dragDropProps={x:{axis:"x",move:!0},y:{axis:"y",move:!0}},l=(d.flags&&(d.flags.prototype.dragDropProps=e),d.column.prototype.dragDropProps={x:{axis:"x",move:!0},y:{axis:"y",move:!1,resize:!0,beforeResize:function(e,r,t){var o=D(t.yBottom,t.series.translatedThreshold),a=e.attr("y"),i=f(t.stackY)?t.stackY-(t.y||0):t.series.options.threshold||0,r=i+r.y;(t.series.yAxis.reversed?r<i:i<=r)?(t=e.attr("height"),e.attr({height:Math.max(0,Math.round(t+(o?o-a-t:0)))})):e.attr({y:Math.round(a+(o?o-a:0))})},resizeSide:function(e,r){var t=r.series.chart.dragHandles,e=e.y>=(r.series.options.threshold||0)?"top":"bottom",r=h(e);return t&&t[r]&&(t[r].destroy(),delete t[r]),e},handlePositioner:function(e){var r=e.shapeArgs||e.graphic&&e.graphic.getBBox()||{},t=e.series.yAxis.reversed,o=e.series.options.threshold||0,e=e.y||0;return{x:r.x||0,y:!t&&o<=e||t&&e<o?r.y||0:(r.y||0)+(r.height||0)}},handleFormatter:function(e){var e=e.shapeArgs||{},r=e.r||0,e=e.width||0,t=e/2;return[["M",r,0],["L",t-5,0],["A",1,1,0,0,0,5+t,0],["A",1,1,0,0,0,t-5,0],["M",5+t,0],["L",e-r,0]]}}}),P=(d.bullet&&(d.bullet.prototype.dragDropProps={x:l.x,y:l.y,target:{optionName:"draggableTarget",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){var r=e.targetGraphic.getBBox();return{x:e.barX,y:r.y+r.height/2}},handleFormatter:l.y.handleFormatter}}),d.columnrange&&(d.columnrange.prototype.dragDropProps={x:{axis:"x",move:!0},low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){e=e.shapeArgs||e.graphic.getBBox();return{x:e.x||0,y:(e.y||0)+(e.height||0)}},handleFormatter:l.y.handleFormatter,propValidate:function(e,r){return e<=r.high}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){e=e.shapeArgs||e.graphic.getBBox();return{x:e.x||0,y:e.y||0}},handleFormatter:l.y.handleFormatter,propValidate:function(e,r){return e>=r.low}}}),d.boxplot&&(d.boxplot.prototype.dragDropProps={x:l.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.lowPlot}},handleFormatter:l.y.handleFormatter,propValidate:function(e,r){return e<=r.q1}},q1:{optionName:"draggableQ1",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.q1Plot}},handleFormatter:l.y.handleFormatter,propValidate:function(e,r){return e<=r.median&&e>=r.low}},median:{axis:"y",move:!0},q3:{optionName:"draggableQ3",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.q3Plot}},handleFormatter:l.y.handleFormatter,propValidate:function(e,r){return e<=r.high&&e>=r.median}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.highPlot}},handleFormatter:l.y.handleFormatter,propValidate:function(e,r){return e>=r.q3}}}),d.ohlc&&(d.ohlc.prototype.dragDropProps={x:l.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotLow}},handleFormatter:l.y.handleFormatter,propValidate:function(e,r){return e<=r.open&&e<=r.close}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotHigh}},handleFormatter:l.y.handleFormatter,propValidate:function(e,r){return e>=r.open&&e>=r.close}},open:{optionName:"draggableOpen",axis:"y",move:!0,resize:!0,resizeSide:function(e){return e.open>=e.close?"top":"bottom"},handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotOpen}},handleFormatter:l.y.handleFormatter,propValidate:function(e,r){return e<=r.high&&e>=r.low}},close:{optionName:"draggableClose",axis:"y",move:!0,resize:!0,resizeSide:function(e){return e.open>=e.close?"bottom":"top"},handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotClose}},handleFormatter:l.y.handleFormatter,propValidate:function(e,r){return e<=r.high&&e>=r.low}}}),d.arearange&&(i=d.columnrange.prototype.dragDropProps,d.arearange.prototype.dragDropProps={x:i.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){e=e.graphics&&e.graphics[0]&&e.graphics[0].getBBox();return e?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:-999,y:-999}},handleFormatter:n=function(e){e=e.graphic?e.graphic.getBBox().width/2+1:4;return[["M",0-e,0],["a",e,e,0,1,0,2*e,0],["a",e,e,0,1,0,-2*e,0]]},propValidate:i.low.propValidate},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){e=e.graphics&&e.graphics[1]&&e.graphics[1].getBBox();return e?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:-999,y:-999}},handleFormatter:n,propValidate:i.high.propValidate}}),d.waterfall&&(d.waterfall.prototype.dragDropProps={x:l.x,y:y(l.y,{handleFormatter:function(e){return e.isSum||e.isIntermediateSum?null:l.y.handleFormatter(e)}})}),d.xrange&&(g=function(e,r){var t=e.series,o=t.xAxis,a=t.yAxis,i=t.chart.inverted,t=t.columnMetrics?t.columnMetrics.offset:-e.shapeArgs.height/2,r=o.toPixels(e[r],!0),e=a.toPixels(e.y,!0);return i&&(r=o.len-r,e=a.len-e),e+=t,{x:Math.round(r),y:Math.round(e)}},e=d.xrange.prototype.dragDropProps={y:{axis:"y",move:!0},x:{optionName:"draggableX1",axis:"x",move:!0,resize:!0,resizeSide:"left",handlePositioner:function(e){return g(e,"x")},handleFormatter:p,propValidate:function(e,r){return e<=r.x2}},x2:{optionName:"draggableX2",axis:"x",move:!0,resize:!0,resizeSide:"right",handlePositioner:function(e){return g(e,"x2")},handleFormatter:p,propValidate:function(e,r){return e>=r.x}}},d.gantt&&(d.gantt.prototype.dragDropProps={y:e.y,start:y(e.x,{optionName:"draggableStart",validateIndividualDrag:function(e){return!e.milestone}}),end:y(e.x2,{optionName:"draggableEnd",validateIndividualDrag:function(e){return!e.milestone}})})),["gauge","pie","sunburst","wordcloud","sankey","histogram","pareto","vector","windbarb","treemap","bellcurve","sma","map","mapline"].forEach(function(e){d[e]&&(d[e].prototype.dragDropProps=null)}),2),c={default:{className:"highcharts-drag-box-default",lineWidth:1,lineColor:"#888",color:"rgba(0, 0, 0, 0.1)",cursor:"move",zIndex:900}},x={className:"highcharts-drag-handle",color:"#fff",lineColor:"rgba(0, 0, 0, 0.6)",lineWidth:1,zIndex:901};function w(e){var r=e.series?e.series.length:0;if(e.hasCartesianSeries&&!e.polar||e.mapView)for(;r--;)if(e.series[r].options.dragDrop&&function(e){for(var r=["draggableX","draggableY"],t=(v(e.dragDropProps,function(e){e.optionName&&r.push(e.optionName)}),r.length);t--;)if(e.options.dragDrop[r[t]])return 1}(e.series[r]))return 1}function b(e,r){return void 0===e.chartX||void 0===e.chartY?r.pointer.normalize(e):e}function z(r,e,t,o){var a=e.map(function(e){return u(r,e,t,o)});return function(){a.forEach(function(e){e()})}}function H(e,r){o=(t=r).series,a=o.options.dragDrop.groupBy,i=[],o.boosted?o.options.data.forEach(function(e,r){i.push((new o.pointClass).init(o,e)),i[i.length-1].index=r}):i=o.points;var t,o,a,i,n,s,d,p=t.options[a]?i.filter(function(e){return e.options[a]===t.options[a]}):[t],g=r.series,l=g.chart;D(g.options.dragDrop&&g.options.dragDrop.liveRedraw,!0)||(l.dragGuideBox=n=g.getGuideBox(p),l.setGuideBoxState("default",g.options.dragDrop.guideBox).add(g.group)),l.dragDropData={origin:(g=p,l=n,d={chartX:(s=e).chartX,chartY:s.chartY,guideBox:l&&{x:l.attr("x"),y:l.attr("y"),width:l.attr("width"),height:l.attr("height")},points:{}},g.forEach(function(t){var o={};v(t.series.dragDropProps,function(e,r){e=t.series[e.axis+"Axis"];o[r]=t[r],t.series.chart.mapView&&t.plotX&&t.plotY?o[r+"Offset"]="x"===r?t.plotX:t.plotY:o[r+"Offset"]=e.toPixels(t[r])-(e.horiz?s.chartX:s.chartY)}),o.point=t,d.points[t.id]=o}),d),point:r,groupedPoints:p,isDragging:!0}}function A(e,r){var t=e.dragDropData.newPoints,r=s(r);e.isDragDropAnimating=!0,v(t,function(e){e.point.update(e.newValues,!1)}),e.redraw(r),setTimeout(function(){delete e.isDragDropAnimating,e.hoverPoint&&!e.dragHandles&&e.hoverPoint.showDragHandles()},r.duration)}function S(e,r,t){var o,a=e.series,i=a.chart,n=i.dragDropData,s=a.dragDropProps[n.updateProp],d=n.newPoints[e.id].newValues,p="function"==typeof s.resizeSide?s.resizeSide(d,e):s.resizeSide,g=(s.beforeResize&&s.beforeResize(i.dragGuideBox,d,e),i.dragGuideBox),d="x"===s.axis&&a.xAxis.reversed||"y"===s.axis&&a.yAxis.reversed?h(p):p,l={x:"x"===s.axis?r-(n.origin.prevdX||0):0,y:"y"===s.axis?t-(n.origin.prevdY||0):0};switch(d){case"left":o={x:g.attr("x")+l.x,width:Math.max(1,g.attr("width")-l.x)};break;case"right":o={width:Math.max(1,g.attr("width")+l.x)};break;case"top":o={y:g.attr("y")+l.y,height:Math.max(1,g.attr("height")-l.y)};break;case"bottom":o={height:Math.max(1,g.attr("height")+l.y)}}g.attr(o)}function B(e){var r=e.series&&e.series.chart,t=r&&r.dragDropData;!r||!r.dragHandles||t&&(t.isDragging&&t.draggedPastSensitivity||t.isHoveringHandle===e.id)||r.hideDragHandles()}function N(e){var r,t=0;for(r in e)Object.hasOwnProperty.call(e,r)&&t++;return t}function F(e){for(var r in e)if(Object.hasOwnProperty.call(e,r))return e[r]}function M(g,e){var r,l,t,o,a,i,n,s,d,p,h,u,c,x;e.zoomOrPanKeyPressed(g)||(t=0,(r=e.dragDropData)&&r.isDragging&&r.point.series&&(u=(l=r.point).series.options.dragDrop,g.preventDefault(),r.draggedPastSensitivity||(r.draggedPastSensitivity=(h=g,e=e,u=D(l.options.dragDrop&&l.options.dragDrop.dragSensitivity,u&&u.dragSensitivity,P),c=(e=e.dragDropData.origin).chartX,e=e.chartY,x=h.chartX,h=h.chartY,u<Math.sqrt((x-c)*(x-c)+(h-e)*(h-e)))),r.draggedPastSensitivity&&(r.newPoints=(a=g,u=(o=r).point,x=u.series,i=x.chart,n=y(x.options.dragDrop,u.options.dragDrop),s={},d=o.updateProp,p={},v(u.series.dragDropProps,function(e,r){d&&(d!==r||!e.resize||e.optionName&&!1===n[e.optionName])||(d||e.move&&("x"===e.axis&&n.draggableX||"y"===e.axis&&n.draggableY))&&(i.mapView?s["x"===r?"lon":"lat"]=e:s[r]=e)}),(d?[u]:o.groupedPoints).forEach(function(e){p[e.id]={point:e,newValues:e.getDropValues(o.origin,a,s)}}),p),h=1===(t=N(c=r.newPoints))?F(c):null,l.firePointEvent("drag",{origin:r.origin,newPoints:r.newPoints,newPoint:h&&h.newValues,newPointId:h&&h.point.id,numNewPoints:t,chartX:g.chartX,chartY:g.chartY},function(){var e,r,t,o,a,i,n,s,d,p;e=g,t=(r=l).series,o=t.chart,a=o.dragDropData,i=(t=y(t.options.dragDrop,r.options.dragDrop)).draggableX,n=t.draggableY,s=a.origin,a=a.updateProp,d=e.chartX-s.chartX,e=e.chartY-s.chartY,p=d,o.inverted&&(d=-e,e=-p),D(t.liveRedraw,!0)?(A(o,!1),r.showDragHandles()):a?S(r,d,e):o.dragGuideBox.translate(i?d:0,n?e:0),s.prevdX=d,s.prevdY=e}))))}function V(e,r){var t,o,a,i,n=r.dragDropData;n&&n.isDragging&&n.draggedPastSensitivity&&n.point.series&&(t=n.point,i=1===(a=N(o=n.newPoints))?F(o):null,r.dragHandles&&r.hideDragHandles(),e.preventDefault(),r.cancelClick=!0,t.firePointEvent("drop",{origin:n.origin,chartX:e.chartX,chartY:e.chartY,newPoints:o,numNewPoints:a,newPoint:i&&i.newValues,newPointId:i&&i.point.id},function(){A(r)})),delete r.dragDropData,r.dragGuideBox&&(r.dragGuideBox.destroy(),delete r.dragGuideBox)}function X(e,r){var t,o,a,i,n,s=r.hoverPoint,d=y(s&&s.series.options.dragDrop,s&&s.options.dragDrop),p=d.draggableX||!1,d=d.draggableY||!1;r.cancelClick=!1,!p&&!d||r.zoomOrPanKeyPressed(e)||r.hasDraggedAnnotation||(r.dragDropData&&r.dragDropData.isDragging?V(e,r):s&&(d=(p=s).series,a=d.chart,i=d.options.dragDrop||{},p=p.options&&p.options.dragDrop,n=d.dragDropProps,v(n,function(e){"x"===e.axis&&e.move?t=!0:"y"===e.axis&&e.move&&(o=!0)}),(i.draggableX&&t||i.draggableY&&o)&&(!p||!1!==p.draggableX||!1!==p.draggableY)&&(d.yAxis&&d.xAxis||a.mapView))&&(r.mouseIsDown=!1,H(e,s),s.firePointEvent("dragStart",e)))}r.prototype.setGuideBoxState=function(e,r){var t=this.dragGuideBox,r=y(c,r),r=y(r.default,r[e]);return t.attr({class:r.className,stroke:r.lineColor,strokeWidth:r.lineWidth,fill:r.color,cursor:r.cursor,zIndex:r.zIndex}).css({pointerEvents:"none"})},t.prototype.getDropValues=function(e,s,r){var d,t,p=this,g=p.series,l=g.chart,h=l.mapView,u=y(g.options.dragDrop,p.options.dragDrop),c={},x=e.points[p.id];for(t in r)if(Object.hasOwnProperty.call(r,t)){if(void 0!==d){d=!1;break}d=!0}return v(r,function(e,r){var t,o,a=x.point[r],i=g[e.axis+"Axis"],n=h?function(e,r,t){var o,a,i,n;if(h)return o=D(u["dragPrecision"+r],0),i=h.pixelsToLonLat({x:0,y:0}),a=h.pixelsToLonLat({x:l.plotBox.width,y:l.plotBox.height}),i=D(u["dragMin"+r],i&&i[t],-1/0),r=D(u["dragMax"+r],a&&a[t],1/0),a=e[t],"Orthographic"===h.projection.options.name?a:("lat"===t&&((isNaN(i)||i>h.projection.maxLatitude)&&(i=h.projection.maxLatitude),n=r=isNaN(r)||r<-1*h.projection.maxLatitude?-1*h.projection.maxLatitude:r,r=i,i=n),h.projection.hasCoordinates||(n=h.pixelsToLonLat({x:e.chartX-l.plotLeft,y:l.plotHeight-e.chartY+l.plotTop}))&&(a=n[t]),o&&(a=Math.round(a/o)*o),m(a,i,r))}(s,e.axis.toUpperCase(),r):(i=i.toValue((i.horiz?s.chartX:s.chartY)+x[r+"Offset"]),t=e.axis.toUpperCase(),n=g[t.toLowerCase()+"Axis"].categories?1:0,n=D(u["dragPrecision"+t],n),o=D(u["dragMin"+t],-1/0),t=D(u["dragMax"+t],1/0),n&&(i=Math.round(i/n)*n),m(i,o,t));!f(n)||d&&e.propValidate&&!e.propValidate(n,p)||void 0===a||(c[r]=n)}),c},a.prototype.getGuideBox=function(e){var a,r=this.chart,i=1/0,n=-1/0,s=1/0,d=-1/0;return e.forEach(function(e){var r,t,o=e.graphic&&e.graphic.getBBox()||e.shapeArgs;o&&(r=void 0,t=e.x2,f(t)&&(r=e.series.xAxis.translate(t,!1,!1,!1,!0)),t=!(o.width||o.height||o.x||o.y),a=!0,i=Math.min(e.plotX||0,r||0,t?1/0:o.x||0,i),n=Math.max(e.plotX||0,r||0,(o.x||0)+(o.width||0),n),s=Math.min(e.plotY||0,t?1/0:o.y||0,s),d=Math.max((o.y||0)+(o.height||0),d))}),a?r.renderer.rect(i,s,n-i,d-s):r.renderer.g()},t.prototype.showDragHandles=function(){var s=this,d=s.series,p=d.chart,g=p.inverted,l=p.renderer,h=y(d.options.dragDrop,s.options.dragDrop);v(d.dragDropProps,function(e,a){var r=y(x,e.handleOptions,h.dragHandle),t={class:r.className,"stroke-width":r.lineWidth,fill:r.color,stroke:r.lineColor},o=r.pathFormatter||e.handleFormatter,i=e.handlePositioner,n=!e.validateIndividualDrag||e.validateIndividualDrag(s);e.resize&&n&&e.resizeSide&&o&&(h["draggable"+e.axis.toUpperCase()]||h[e.optionName])&&!1!==h[e.optionName]&&(p.dragHandles||(p.dragHandles={group:l.g("drag-drop-handles").add(d.markerGroup||d.group)}),p.dragHandles.point=s.id,n=i(s),t.d=i=o(s),o=s.series.xAxis.categories?-.5:0,!i||n.x<o||n.y<0||(t.cursor=r.cursor||("x"===e.axis!=!!g?"ew-resize":"ns-resize"),i=(i=p.dragHandles[e.optionName])||(p.dragHandles[e.optionName]=l.path().add(p.dragHandles.group)),t.translateX=g?d.yAxis.len-n.y:n.x,t.translateY=g?d.xAxis.len-n.x:n.y,g&&(t.rotation=-90),i.attr(t),z(i.element,["touchstart","mousedown"],function(e){var r,t,o;e=b(e,p),t=a,(o=(r=s).series.chart).zoomOrPanKeyPressed(e)||(o.mouseIsDown=!1,H(e,r),o.dragDropData.updateProp=e.updateProp=t,r.firePointEvent("dragStart",e),e.stopPropagation(),e.preventDefault())},{passive:!1}),u(p.dragHandles.group.element,"mouseover",function(){p.dragDropData=p.dragDropData||{},p.dragDropData.isHoveringHandle=s.id}),z(p.dragHandles.group.element,["touchend","mouseout"],function(){var e,r;(r=(e=s).series.chart).dragDropData&&e.id===r.dragDropData.isHoveringHandle&&delete r.dragDropData.isHoveringHandle,r.hoverPoint||B(e)})))})},r.prototype.hideDragHandles=function(){var e=this;e.dragHandles&&(v(e.dragHandles,function(e,r){"group"!==r&&e.destroy&&e.destroy()}),e.dragHandles.group&&e.dragHandles.group.destroy&&e.dragHandles.group.destroy(),delete e.dragHandles)},u(t,"mouseOver",function(){var i=this;setTimeout(function(){var e,r,t,o,a;r=(e=i).series,t=r&&r.chart,o=t&&t.dragDropData,a=t&&t.is3d&&t.is3d(),!t||o&&o.isDragging&&o.draggedPastSensitivity||t.isDragDropAnimating||!r.options.dragDrop||a||(t.dragHandles&&t.hideDragHandles(),e.showDragHandles())},12)}),u(t,"mouseOut",function(){var e=this;setTimeout(function(){e.series&&B(e)},10)}),u(t,"remove",function(){var e=this.series.chart,r=e.dragHandles;r&&r.point===this.id&&e.hideDragHandles()}),r.prototype.zoomOrPanKeyPressed=function(e){var r=this.options.chart||{},t=r.panKey&&r.panKey+"Key";return e[r.zooming.key&&r.zooming.key+"Key"]||e[t]},u(r,"render",function(){var r,e,t;this.hasAddedDragDropEvents||(e=(r=this).container,t=o.doc,w(r)&&(z(e,["mousedown","touchstart"],function(e){X(b(e,r),r)}),z(e,["mousemove","touchmove"],function(e){M(b(e,r),r)},{passive:!1}),u(e,"mouseleave",function(e){V(b(e,r),r)}),r.unbindDragDropMouseUp=z(t,["mouseup","touchend"],function(e){V(b(e,r),r)},{passive:!1}),r.hasAddedDragDropEvents=!0,u(r,"destroy",function(){r.unbindDragDropMouseUp&&r.unbindDragDropMouseUp()})))})}),r(e,"masters/modules/draggable-points.src.js",[],function(){})});