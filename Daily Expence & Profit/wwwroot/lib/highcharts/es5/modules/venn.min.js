"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/venn",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,r,n){t.hasOwnProperty(e)||(t[e]=n.apply(null,r),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t=t?t._modules:{},"Core/Geometry/GeometryUtilities.js",[],function(){var t,e;return(e=t=t||{}).getCenterOfPoints=function(t){var e=t.reduce(function(t,e){return t.x+=e.x,t.y+=e.y,t},{x:0,y:0});return{x:e.x/t.length,y:e.y/t.length}},e.getDistanceBetweenPoints=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},e.getAngleBetweenPoints=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)},t}),e(t,"Core/Geometry/CircleUtilities.js",[t["Core/Geometry/GeometryUtilities.js"]],function(t){var e,c=t.getAngleBetweenPoints,u=t.getCenterOfPoints,l=t.getDistanceBetweenPoints;function f(t,e){return e=Math.pow(10,e),Math.round(t*e)/e}function i(t){if(t<=0)throw Error("radius of circle must be a positive number.");return Math.PI*t*t}function o(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function a(t,e){var r,n,i=l(t,e),o=t.r,s=e.r,a=[];return i<o+s&&i>Math.abs(o-s)&&(r=((o*=o)-s*s+i*i)/(2*i),s=Math.sqrt(o-r*r),o=t.x,a=e.x,t=t.y,n=e.y,e=o+r*(a-o)/i,r=t+r*(n-t)/i,t=s/i*-(n-t),i=s/i*-(a-o),a=[{x:f(e+t,14),y:f(r-i,14)},{x:f(e-t,14),y:f(r+i,14)}]),a}function r(t){return t.reduce(function(t,o,s,e){return e=e.slice(s+1).reduce(function(t,e,r,n){var i=[s,r+s+1];return t.concat(a(o,e).map(function(t){return t.indexes=i,t}))},[]),t.concat(e)},[])}function n(t,e){return l(t,e)<=e.r+1e-10}function s(e,t){return!t.some(function(t){return!n(e,t)})}function p(e){return r(e).filter(function(t){return s(t,e)})}return(t=e=e||{}).round=f,t.getAreaOfCircle=i,t.getCircularSegmentArea=o,t.getOverlapBetweenCircles=function(t,e,r){var n=0;return n=r<t+e?f(n=r<=Math.abs(e-t)?i(t<e?t:e):(r-=n=(t*t-e*e+r*r)/(2*r),o(t,t-n)+o(e,e-r)),14):n},t.getCircleCircleIntersection=a,t.getCirclesIntersectionPoints=r,t.isCircle1CompletelyOverlappingCircle2=function(t,e){return l(t,e)+e.r<t.r+1e-10},t.isPointInsideCircle=n,t.isPointInsideAllCircles=s,t.isPointOutsideAllCircles=function(e,t){return!t.some(function(t){return n(e,t)})},t.getCirclesIntersectionPolygon=p,t.getAreaOfIntersectionBetweenCircles=function(a){var e,t,r,n=p(a);return 1<n.length&&(e=u(n),t=(n=n.map(function(t){return t.angle=c(e,t),t}).sort(function(t,e){return e.angle-t.angle}))[n.length-1],0!==(n=n.reduce(function(t,i){var e,o=t.startPoint,s=u([o,i]),r=i.indexes.filter(function(t){return-1<o.indexes.indexOf(t)}).reduce(function(t,e){e=a[e];var r=c(e,i),n=c(e,o),r=n-(n-r+(n<r?2*Math.PI:0))/2;return r=l(s,{x:e.x+e.r*Math.sin(r),y:e.y+e.r*Math.cos(r)}),2*(e=e.r)<r&&(r=2*e),t=!t||t.width>r?{r:e,largeArc:e<r?1:0,width:r,x:i.x,y:i.y}:t},null);return r&&(e=r.r,t.arcs.push(["A",e,e,0,r.largeArc,1,r.x,r.y]),t.startPoint=i),t},{startPoint:t,arcs:[]}).arcs).length&&1!==n.length&&(n.unshift(["M",t.x,t.y]),r={center:e,d:n})),r},e}),e(t,"Series/DrawPointUtilities.js",[t["Core/Utilities.js"]],function(t){var c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};return{draw:function(t,e){var r=e.animatableAttribs,n=e.onComplete,i=e.css,o=e.renderer,s=t.series&&t.series.chart.hasRendered?void 0:t.series&&t.series.options.animation,a=t.graphic;e.attribs=c(c({},e.attribs),{class:t.getClassName()})||{},t.shouldDraw()?(a||(t.graphic=a="text"===e.shapeType?o.text():o[e.shapeType](e.shapeArgs||{}),a.add(e.group)),i&&a.css(i),a.attr(e.attribs).animate(r,!e.isNew&&s,n)):a&&(o=function(){t.graphic=a=a&&a.destroy(),"function"==typeof n&&n()},Object.keys(r).length?a.animate(r,void 0,o):o())}}}),e(t,"Series/Venn/VennPoint.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e){var n,r,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=e.isNumber;return r=t.seriesTypes.scatter.prototype.pointClass,i(s,r),s.prototype.isValid=function(){return o(this.value)},s.prototype.shouldDraw=function(){return!!this.shapeArgs},s;function s(){var t=null!==r&&r.apply(this,arguments)||this;return t.options=void 0,t.series=void 0,t}}),e(t,"Series/Venn/VennUtils.js",[t["Core/Geometry/CircleUtilities.js"],t["Core/Geometry/GeometryUtilities.js"],t["Core/Utilities.js"]],function(t,e,r){function n(t){var i={};return t.filter(function(t){return 2===t.sets.length}).forEach(function(n){n.sets.forEach(function(t,e,r){O(i[t])||(i[t]={totalOverlap:0,overlapping:{}}),i[t]={totalOverlap:(i[t].totalOverlap||0)+n.value,overlapping:c(c({},i[t].overlapping||{}),((t={})[r[1-e]]=n.value,t))}})}),t.filter(o).forEach(function(t){m(t,i[t.sets[0]])}),t}function a(t,e,r,n,i){var o=t(e),s=t(r),a=(i=i||100,n=n||1e-10,r-e),c=1;if(r<=e)throw Error("a must be smaller than b.");if(0<o*s)throw Error("f(a) and f(b) must have opposite signs.");if(0===o)var u=e;else if(0===s)u=r;else for(;c++<=i&&0!==l&&n<a;){var l=t(u=e+(a=(r-e)/2));0<o*l?e=u:r=u}return u}function p(t){for(var e=(t=t.slice(0,-1)).length,r=[],n=function(t,e){return t.sum+=e[t.i],t},i=0;i<e;i++)r[i]=t.reduce(n,{sum:0,i:i}).sum/e;return r}function h(e,r,n){var t=e+r;return n<=0?t:u(e<r?e:r)<=n?0:a(function(t){return t=l(e,r,t),n-t},0,t)}function o(t){return b(t.sets)&&1===t.sets.length}function s(t){var r={};return O(t)&&C(t.value)&&-1<t.value&&b(t.sets)&&0<t.sets.length&&!t.sets.some(function(t){var e=!1;return!r[t]&&A(t)?r[t]=!0:e=!0,e})}function d(o,t){return t.reduce(function(t,e){var r,n,i=0;return 1<e.sets.length&&(i=e.value,r=e.sets.map(function(t){return o[t]}),n=0,2===r.length&&(n=r[0],r=r[1],n=l(n.r,r.r,x(n,r))),e=i-(e=n),i=Math.round(e*e*1e11)/1e11),t+i},0)}function i(t,e){return void 0!==e.totalOverlap&&void 0!==t.totalOverlap?e.totalOverlap-t.totalOverlap:NaN}var c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=t.getAreaOfCircle,y=t.getCircleCircleIntersection,l=t.getOverlapBetweenCircles,f=t.isPointInsideAllCircles,g=t.isPointInsideCircle,v=t.isPointOutsideAllCircles,x=e.getDistanceBetweenPoints,m=r.extend,b=r.isArray,C=r.isNumber,O=r.isObject,A=r.isString;return{geometry:e,geometryCircles:t,addOverlapToSets:n,getCentroid:p,getDistanceBetweenCirclesByOverlap:h,getLabelWidth:function(i,o,t){var e=o.reduce(function(t,e){return Math.min(e.r,t)},1/0),s=t.filter(function(t){return!g(i,t)});return t=function(r,n){return a(function(t){var e={x:i.x+n*t,y:i.y},e=f(e,o)&&v(e,s);return-(r-t)+(e?0:Number.MAX_VALUE)},0,r)},2*Math.min(t(e,-1),t(e,1))},getMarginFromCircles:function(r,t,e){return t=t.reduce(function(t,e){return(e=e.r-x(r,e))<=t?e:t},Number.MAX_VALUE),e.reduce(function(t,e){return(e=x(r,e)-e.r)<=t?e:t},t)},isSet:o,layoutGreedyVenn:function(t){function r(t,e){var r=t.circle;r&&(r.x=e.x,r.y=e.y),u.push(t)}var u=[],l={},e=(t.filter(function(t){return 1===t.sets.length}).forEach(function(t){l[t.sets[0]]=t.circle={x:Number.MAX_VALUE,y:Number.MAX_VALUE,r:Math.sqrt(t.value/Math.PI)}}),n(t),t.filter(o).sort(i)),f=(r(e.shift(),{x:0,y:0}),t.filter(function(t){return 2===t.sets.length}));return e.forEach(function(t){var s,a,e,c=t.circle;c&&(s=c.r,a=t.overlapping,e=u.reduce(function(r,t,e){var n=t.circle;if(!n||!a)return r;var i=h(s,n.r,a[t.sets[0]]),o=[{x:n.x+i,y:n.y},{x:n.x-i,y:n.y},{x:n.x,y:n.y+i},{x:n.x,y:n.y-i}];return u.slice(e+1).forEach(function(t){var e=t.circle;e&&(t=h(s,e.r,a[t.sets[0]]),o=o.concat(y({x:n.x,y:n.y,r:i},{x:e.x,y:e.y,r:t})))}),o.forEach(function(t){c.x=t.x,c.y=t.y;var e=d(l,f);e<r.loss&&(r.loss=e,r.coordinates=t)}),r},{loss:Number.MAX_VALUE,coordinates:void 0}),r(t,e.coordinates))}),l},loss:d,nelderMead:function(o,t){function e(t,e){return t.fx-e.fx}function i(r,t,n,i){return t.map(function(t,e){return r*t+n*i[e]})}function r(t,e){return e.fx=o(e),t[t.length-1]=e,t}function n(t){var e=t[0];return t.map(function(t){return(t=i(.5,e,.5,t)).fx=o(t),t})}function s(t,e,r,n){return(t=i(r,t,n,e)).fx=o(t),t}t=function(t){var e=t.length,r=Array(e+1);r[0]=t,r[0].fx=o(t);for(var n=0;n<e;++n){var i=t.slice();i[n]=i[n]?1.05*i[n]:.001,i.fx=o(i),r[n+1]=i}return r}(t);for(var a=0;a<100;a++){t.sort(e);var c,u=t[t.length-1],l=p(t),f=s(l,u,2,-1);t=f.fx<t[0].fx?r(t,(u=s(l,u,3,-2)).fx<f.fx?u:f):f.fx>=t[t.length-2].fx?(c=void 0,f.fx>u.fx?(c=s(l,u,.5,.5)).fx<u.fx?r(t,c):n(t):(c=s(l,u,1.5,-.5)).fx<f.fx?r(t,c):n(t)):r(t,f)}return t[0]},processVennData:function(t,i){var r=(t=b(t)?t:[]).reduce(function(t,e){var r;return(r=(r=e.sets)?s(e)&&o(e)&&0<e.value:r)&&-1===t.indexOf(e.sets[0])&&t.push(e.sets[0]),t},[]).sort(),n=t.reduce(function(t,e){return e.sets&&s(e)&&!e.sets.some(function(t){return-1===r.indexOf(t)})&&(t[e.sets.sort().join(i)]={sets:e.sets,value:e.value||0}),t},{});return r.reduce(function(e,r,t,n){return n.slice(t+1).forEach(function(t){e.push(r+i+t)}),e},[]).forEach(function(t){var e;n[t]||(e={sets:t.split(i),value:0},n[t]=e)}),Object.keys(n).map(function(t){return n[t]})},sortByTotalOverlap:i}}),e(t,"Series/Venn/VennSeries.js",[t["Core/Animation/AnimationUtilities.js"],t["Core/Color/Color.js"],t["Core/Geometry/CircleUtilities.js"],t["Series/DrawPointUtilities.js"],t["Core/Geometry/GeometryUtilities.js"],t["Core/Series/SeriesRegistry.js"],t["Series/Venn/VennPoint.js"],t["Series/Venn/VennUtils.js"],t["Core/Utilities.js"]],function(t,e,r,a,n,i,o,p,s){var c,u,l=this&&this.__extends||(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),f=t.animObject,h=e.parse,d=r.getAreaOfIntersectionBetweenCircles,y=r.getCirclesIntersectionPolygon,g=r.isCircle1CompletelyOverlappingCircle2,v=r.isPointInsideAllCircles,x=r.isPointOutsideAllCircles,m=n.getCenterOfPoints,b=i.seriesTypes.scatter,C=(t=s.addEvent,s.extend),O=s.isArray,A=s.isNumber,w=s.isObject,j=s.merge;function P(){var t=null!==u&&u.apply(this,arguments)||this;return t.data=void 0,t.mapOfIdToRelation=void 0,t.options=void 0,t.points=void 0,t}return l(P,u=b),P.getLabelPosition=function(n,i){var t=n.reduce(function(t,e){var r=e.r/2;return[{x:e.x,y:e.y},{x:e.x+r,y:e.y},{x:e.x-r,y:e.y},{x:e.x,y:e.y+r},{x:e.x,y:e.y-r}].reduce(function(t,e){var r=p.getMarginFromCircles(e,n,i);return t.margin<r&&(t.point=e,t.margin=r),t},t)},{point:void 0,margin:-Number.MAX_VALUE}).point;return t={x:(t=p.nelderMead(function(t){return-p.getMarginFromCircles({x:t[0],y:t[1]},n,i)},[t.x,t.y]))[0],y:t[1]},t=v(t,n)&&x(t,i)?t:1<n.length?m(y(n)):{x:n[0].x,y:n[0].y}},P.getLabelValues=function(t,e){var n=t.sets,r=e.reduce(function(t,e){var r=-1<n.indexOf(e.sets[0]);return e.circle&&t[r?"internal":"external"].push(e.circle),t},{internal:[],external:[]});return r.external=r.external.filter(function(e){return r.internal.some(function(t){return!g(e,t)})}),{position:t=P.getLabelPosition(r.internal,r.external),width:e=p.getLabelWidth(t,r.internal,r.external)}},P.layout=function(t){var n,i,o={},s={};return 0<t.length&&(n=p.layoutGreedyVenn(t),i=t.filter(p.isSet),t.forEach(function(t){var e=t.sets,r=e.join();(e=p.isSet(t)?n[r]:d(e.map(function(t){return n[t]})))&&(o[r]=e,s[r]=P.getLabelValues(t,i))})),{mapOfIdToShape:o,mapOfIdToLabelValues:s}},P.getScale=function(t,e,r){var n=r.bottom-r.top,i=r.right-r.left;return{scale:n=Math.min(0<i?1/i*t:1,0<n?1/n*e:1),centerX:t/2-(r.right+r.left)/2*n,centerY:e/2-(r.top+r.bottom)/2*n}},P.updateFieldBoundaries=function(t,e){var r=e.x-e.r,n=e.x+e.r,i=e.y+e.r;return e=e.y-e.r,(!A(t.left)||t.left>r)&&(t.left=r),(!A(t.right)||t.right<n)&&(t.right=n),(!A(t.top)||t.top>e)&&(t.top=e),(!A(t.bottom)||t.bottom<i)&&(t.bottom=i),t},P.prototype.animate=function(t){var i;t||(i=f(this.options.animation),this.points.forEach(function(t){var e,r,n=t.shapeArgs;t.graphic&&n&&(e={},r={},n.d?e.opacity=.001:(e.r=0,r.r=n.r),t.graphic.attr(e).animate(r,i),n.d&&setTimeout(function(){t&&t.graphic&&t.graphic.animate({opacity:1})},i.duration))},this))},P.prototype.drawPoints=function(){var n=this,i=n.chart,o=n.group,s=i.renderer;(n.points||[]).forEach(function(t){var e={zIndex:O(t.sets)?t.sets.length:0},r=t.shapeArgs;i.styledMode||C(e,n.pointAttribs(t,t.state)),a.draw(t,{isNew:!t.graphic,animatableAttribs:r,attribs:e,group:o,renderer:s,shapeType:r&&r.d?"path":"circle"})})},P.prototype.init=function(){b.prototype.init.apply(this,arguments),delete this.opacity},P.prototype.pointAttribs=function(t,e){var r=this.options||{};return t=j(r,{color:t&&t.color},t&&t.options||{},e&&r.states[e]||{}),{fill:h(t.color).brighten(t.brightness).get(),opacity:t.opacity,stroke:t.borderColor,"stroke-width":t.borderWidth,dashstyle:t.borderDashStyle}},P.prototype.translate=function(){var t=this.chart,e=(this.processedXData=this.xData,this.generatePoints(),p.processVennData(this.options.data,P.splitter)),a=(e=P.layout(e)).mapOfIdToShape,c=e.mapOfIdToLabelValues,u=(e=Object.keys(a).filter(function(t){return(t=a[t])&&A(t.r)}).reduce(function(t,e){return P.updateFieldBoundaries(t,a[e])},{top:0,bottom:0,left:0,right:0}),(t=P.getScale(t.plotWidth,t.plotHeight,e)).scale),l=t.centerX,f=t.centerY;this.points.forEach(function(t){var e,r=O(t.sets)?t.sets:[],n=r.join(),i=a[n],n=(o=c[n]||{}).width,o=o.position,s=t.options&&t.options.dataLabels;i&&(i.r?e={x:l+i.x*u,y:f+i.y*u,r:i.r*u}:i.d&&((i=i.d).forEach(function(t){"M"===t[0]?(t[1]=l+t[1]*u,t[2]=f+t[2]*u):"A"===t[0]&&(t[1]*=u,t[2]*=u,t[6]=l+t[6]*u,t[7]=f+t[7]*u)}),e={d:i}),o?(o.x=l+o.x*u,o.y=f+o.y*u):o={},A(n)&&(n=Math.round(n*u))),t.shapeArgs=e,o&&e&&(t.plotX=o.x,t.plotY=o.y),n&&e&&(t.dlOptions=j(!0,{style:{width:n}},w(s,!0)?s:void 0)),t.name=t.options.name||r.join("∩")})},P.splitter="highcharts-split",P.defaultOptions=j(b.defaultOptions,{borderColor:"#cccccc",borderDashStyle:"solid",borderWidth:1,brighten:0,clip:!1,colorByPoint:!0,dataLabels:{enabled:!0,verticalAlign:"middle",formatter:function(){return this.point.name}},inactiveOtherPoints:!0,marker:!1,opacity:.75,showInLegend:!1,legendType:"point",states:{hover:{opacity:1,borderColor:"#333333"},select:{color:"#cccccc",borderColor:"#000000",animation:!1},inactive:{opacity:.075}},tooltip:{pointFormat:"{point.name}: {point.value}"},legendSymbol:"rectangle"}),C((s=P).prototype,{axisTypes:[],directTouch:!0,isCartesian:!1,pointArrayMap:["value"],pointClass:o,utils:p}),i.registerSeriesType("venn",s),t(s,"afterSetOptions",function(t){var e=t.options.states;this.is("venn")&&Object.keys(e).forEach(function(t){e[t].halo=!1})}),s}),e(t,"masters/modules/venn.src.js",[],function(){})});