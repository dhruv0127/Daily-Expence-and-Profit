!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){"use strict";t=t?t._modules:{};function e(t,e,a,n){t.hasOwnProperty(e)||(t[e]=n.apply(null,a),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t,"Extensions/ExportData/ExportDataDefaults.js",[],function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}}),e(t,"Extensions/DownloadURL.js",[t["Core/Globals.js"]],function(t){var s=t.isSafari,l=t.win,c=l.document,i=l.URL||l.webkitURL||l,h=t.dataURLtoBlob=function(t){t=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(t&&3<t.length&&l.atob&&l.ArrayBuffer&&l.Uint8Array&&l.Blob&&i.createObjectURL){for(var e=l.atob(t[3]),a=new l.ArrayBuffer(e.length),n=new l.Uint8Array(a),o=0;o<n.length;++o)n[o]=e.charCodeAt(o);a=new l.Blob([n],{type:t[1]});return i.createObjectURL(a)}},t=t.downloadURL=function(e,t){var a=l.navigator,n=c.createElement("a");if("string"==typeof e||e instanceof String||!a.msSaveOrOpenBlob){e="".concat(e);var o=/Edge\/\d+/.test(a.userAgent),i=s&&"string"==typeof e&&0===e.indexOf("data:application/pdf");if((i||o||2e6<e.length)&&!(e=h(e)||""))throw new Error("Failed to convert to blob");if(void 0!==n.download)n.href=e,n.download=t,c.body.appendChild(n),n.click(),c.body.removeChild(n);else try{var r=l.open(e,"chart");if(null==r)throw new Error("Failed to open window")}catch(t){l.location.href=e}}else a.msSaveOrOpenBlob(e,t)};return{dataURLtoBlob:h,downloadURL:t}}),e(t,"Extensions/ExportData/ExportData.js",[t["Core/Renderer/HTML/AST.js"],t["Extensions/ExportData/ExportDataDefaults.js"],t["Core/Globals.js"],t["Core/Defaults.js"],t["Extensions/DownloadURL.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(o,e,t,a,n,i,r){var S=this&&this.__spreadArray||function(t,e,a){if(a||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||((n=n||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},s=t.doc,l=t.win,c=a.getOptions,h=a.setOptions,d=n.downloadURL,p=i.series,t=i.seriesTypes,u=t.arearange,f=t.gantt,m=t.map,g=t.mapbubble,x=t.treemap,b=r.addEvent,C=r.defined,v=r.extend,A=r.find,L=r.fireEvent,O=r.isNumber,k=r.pick,y=[];function w(){var t=this.getCSV(!0);d(H(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")}function D(){var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";d(H(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+l.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")}function T(t){var o="",i=this.getDataRows(),e=this.options.exporting.csv,r=k(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=k(e.itemDelimiter,","===r?";":","),l=e.lineDelimiter;return i.forEach(function(t,e){for(var a="",n=t.length;n--;)"number"==typeof(a="string"==typeof(a=t[n])?'"'+a+'"':a)&&"."!==r&&(a=a.toString().replace(".",r)),t[n]=a;t.length=i.length?i[0].length:0,o+=t.join(s),e<i.length-1&&(o+=l)}),o}function E(o){function e(t,e,a){if(b.columnHeaderFormatter){var n=b.columnHeaderFormatter(t,e,a);if(!1!==n)return n}return t?t instanceof p?o?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):t.options.title&&t.options.title.text||(t.dateTime?u:d):d}function m(a,t,n){var o={},i={};return t.forEach(function(t){var e=(a.keyToAxis&&a.keyToAxis[t]||t)+"Axis",e=O(n)?a.chart[e][n]:a[e];o[t]=e&&e.categories||[],i[t]=e&&e.dateTime}),{categoryMap:o,dateTimeValueAxisMap:i}}var a,t,n,i,r,s,l,g=this.hasParallelCoordinates,x=this.time,b=this.options.exporting&&this.options.exporting.csv||{},v=this.xAxis,y={},c=[],w=[],D=[],h=this.options.lang.exportData,d=h.categoryHeader,u=h.categoryDatetimeHeader,T=[],E=0;for(i in this.series.forEach(function(r){var s,l,t=r.options.keys,c=r.xAxis,h=t||function(t,e){if(!t.data.filter(function(t){return void 0!==t.y&&t.name}).length||!e||e.categories||t.keyToAxis)return t.pointArrayMap||["y"];if(t.pointArrayMap&&t.pointArrayMap.filter(function(t){return"x"===t}).length)return t.pointArrayMap.unshift("x"),t.pointArrayMap;return["x","y"]}(r,c),d=h.length,u=!r.requireSorting&&{},p=v.indexOf(c),f=m(r,h);if(!1!==r.options.includeInDataExport&&!r.options.isInternal&&!1!==r.visible){for(A(T,function(t){return t[0]===p})||T.push([p,E]),l=0;l<d;)n=e(r,h[l],h.length),D.push(n.columnTitle||n),o&&w.push(n.topLevelColumnTitle||n),l++;s={chart:r.chart,autoIncrement:r.autoIncrement,options:r.options,pointArrayMap:r.pointArrayMap,index:r.index},r.options.data.forEach(function(t,e){var a,n,o,i={series:s},t=(g&&(f=m(r,h,e)),r.pointClass.prototype.applyOptions.apply(i,[t]),C(y[o=i.x])&&y[o].seriesIndices.includes(s.index)&&(t=Object.keys(y).filter(function(t){return y[t].seriesIndices.includes(s.index)&&o}).filter(function(t){return 0===t.indexOf(String(o))}),o=o.toString()+","+t.length),r.data[e]&&r.data[e].name);for(l=0,(!c||"name"===r.exportKey||!g&&c&&c.hasNames&&t)&&(o=t),u&&(u[o]&&(o+="|"+e),u[o]=!0),y[o]||(y[o]=[],y[o].xValues=[]),y[o].x=i.x,y[o].name=t,y[o].xValues[p]=i.x,C(y[o].seriesIndices)||(y[o].seriesIndices=[]),y[o].seriesIndices=S(S([],y[o].seriesIndices,!0),[s.index],!1);l<d;)a=h[l],y[o][E+l]=k(f.categoryMap[a][n=i[a]],f.dateTimeValueAxisMap[a]?x.dateFormat(b.dateFormat,n):null,n),l++}),E+=l}}),y)Object.hasOwnProperty.call(y,i)&&c.push(y[i]);for(t=o?[w,D]:[D],E=T.length;E--;)s=T[E][0],l=T[E][1],a=v[s],c.sort(function(t,e){return t.xValues[s]-e.xValues[s]}),r=e(a),t[0].splice(l,0,r),o&&t[1]&&t[1].splice(l,0,r),c.forEach(function(t){var e=t.name;a&&!C(e)&&(e=a.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),x.dateFormat(b.dateFormat,t.x)):a.categories?k(a.names[t.x],a.categories[t.x],t.x):t.x),t.splice(l,0,e)});return t=t.concat(c),L(this,"exportData",{dataRows:t}),t}function U(t){var e=function(t){if(!t.tagName||"#text"===t.tagName)return t.textContent||"";var a=t.attributes,n="<".concat(t.tagName);return a&&Object.keys(a).forEach(function(t){var e=a[t];n+=" ".concat(t,'="').concat(e,'"')}),n=(n+=">")+(t.textContent||""),(t.children||[]).forEach(function(t){n+=e(t)}),n+="</".concat(t.tagName,">")},t=this.getTableAST(t);return e(t)}function R(t){var n=0,e=[],h=this.options,i=t?1.1.toLocaleString()[1]:".",d=k(h.exporting.useMultiLevelHeaders,!0),a=this.getDataRows(d),t=d?a.shift():null,o=a.shift(),u=function(t,e){var a=t.length;if(e.length!==a)return!1;for(;a--;)if(t[a]!==e[a])return!1;return!0},p=function(t,e,a,n){var o=k(n,""),e="highcharts-text"+(e?" "+e:"");return"number"==typeof o?(o=o.toString(),","===i&&(o=o.replace(".",i)),e="highcharts-number"):n||(e="highcharts-empty"),{tagName:t,attributes:a=v({class:e},a),textContent:o}};!1!==h.exporting.tableCaption&&e.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:k(h.exporting.tableCaption,h.title.text||"Chart")});for(var r=0,s=a.length;r<s;++r)a[r].length>n&&(n=a[r].length);e.push(function(t,e,a){var n,o=[],i=0,r=a||e&&e.length,s=0;if(d&&t&&e&&!u(t,e)){for(var l,c=[];i<r;++i)(l=t[i])===t[i+1]?++s:s?(c.push(p("th","highcharts-table-topheading",{scope:"col",colspan:s+1},l)),s=0):(l===e[i]?h.exporting.useRowspanHeaders?(n=2,delete e[i]):(n=1,e[i]=""):n=1,l=p("th","highcharts-table-topheading",{scope:"col"},l),1<n&&l.attributes&&(l.attributes.valign="top",l.attributes.rowspan=n),c.push(l));o.push({tagName:"tr",children:c})}if(e){for(c=[],i=0,r=e.length;i<r;++i)void 0!==e[i]&&c.push(p("th",null,{scope:"col"},e[i]));o.push({tagName:"tr",children:c})}return{tagName:"thead",children:o}}(t,o,Math.max(n,o.length)));var l=[],t=(a.forEach(function(t){for(var e=[],a=0;a<n;a++)e.push(p(a?"td":"th",null,a?{}:{scope:"row"},t[a]));l.push({tagName:"tr",children:e})}),e.push({tagName:"tbody",children:l}),{tree:{tagName:"table",id:"highcharts-data-table-".concat(this.index),children:e}});return L(this,"aftergetTableAST",t),t.tree}function N(){this.toggleDataTable(!1)}function j(t){var e=(t=k(t,!this.isDataTableVisible))&&!this.dataTableDiv,e=(e&&(this.dataTableDiv=s.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv&&(a=(n=this.dataTableDiv.style).display,n.display=t?"block":"none",t&&(this.dataTableDiv.innerHTML=o.emptyHTML,new o([this.getTableAST()]).addToDOM(this.dataTableDiv),L(this,"afterViewData",{element:this.dataTableDiv,wasHidden:e||a!==n.display}))),this.isDataTableVisible=t,this.exportDivElements),a=this.options.exporting,n=a&&a.buttons&&a.buttons.contextButton.menuItems,t=this.options.lang;a&&a.menuItemDefinitions&&t&&t.viewData&&t.hideData&&n&&e&&((a=e[n.indexOf("viewData")])&&o.setElementHTML(a,this.isDataTableVisible?t.hideData:t.viewData))}function M(){this.toggleDataTable(!0)}function H(t,e){var a,n=l.navigator,o=-1<n.userAgent.indexOf("WebKit")&&n.userAgent.indexOf("Chrome")<0,i=l.URL||l.webkitURL||l;try{if(n.msSaveOrOpenBlob&&l.MSBlobBuilder)return(a=new l.MSBlobBuilder).append(t),a.getBlob("image/svg+xml");if(!o)return i.createObjectURL(new l.Blob(["\ufeff"+t],{type:e}))}catch(t){}}function I(){function o(n,o){return function(t,e){var a;return a=s(o?t:e,n),e=s(o?e:t,n),""===a||""===e||isNaN(a)||isNaN(e)?a.toString().localeCompare(e):a-e}}var t,i=this,r=i.dataTableDiv,s=function(t,e){return t.children[e].textContent};r&&i.options.exporting&&i.options.exporting.allowTableSorting&&((t=r.querySelector("thead tr"))&&t.childNodes.forEach(function(a){var n=a.closest("table");a.addEventListener("click",function(){var t=S([],r.querySelectorAll("tr:not(thead tr)"),!0),e=S([],a.parentNode.children,!0);t.sort(o(e.indexOf(a),i.ascendingOrderInTable=!i.ascendingOrderInTable)).forEach(function(t){n.appendChild(t)}),e.forEach(function(e){["highcharts-sort-ascending","highcharts-sort-descending"].forEach(function(t){e.classList.contains(t)&&e.classList.remove(t)})}),a.classList.add(i.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})}))}function V(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}return{compose:function(t){r.pushUnique(y,t)&&(b(t,"afterViewData",I),b(t,"render",V),(t=t.prototype).downloadCSV=w,t.downloadXLS=D,t.getCSV=T,t.getDataRows=E,t.getTable=U,t.getTableAST=R,t.hideData=N,t.toggleDataTable=j,t.viewData=M),r.pushUnique(y,h)&&((t=c().exporting)&&(v(t.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),t.buttons&&t.buttons.contextButton.menuItems&&t.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),h(e)),u&&r.pushUnique(y,u)&&(u.prototype.keyToAxis={low:"y",high:"y"}),f&&r.pushUnique(y,f)&&(f.prototype.keyToAxis={start:"x",end:"x"}),m&&r.pushUnique(y,m)&&(m.prototype.exportKey="name"),g&&r.pushUnique(y,g)&&(g.prototype.exportKey="name"),x&&r.pushUnique(y,x)&&(x.prototype.exportKey="name")}}}),e(t,"masters/modules/export-data.src.js",[t["Core/Globals.js"],t["Extensions/ExportData/ExportData.js"]],function(t,e){e.compose(t.Chart)})});