!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/indicators/ichimoku-kinko-hyo",["highcharts","highcharts/modules/stock"],function(o){return t(o),t.Highcharts=o,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){"use strict";o=o?o._modules:{};function t(o,t,n,e){o.hasOwnProperty(t)||(o[t]=e.apply(null,n),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:o[t]}})))}t(o,"Stock/Indicators/IKH/IKHIndicator.js",[o["Extensions/DataGrouping/ApproximationRegistry.js"],o["Core/Color/Color.js"],o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"]],function(i,o,T,t){var e,n=this&&this.__extends||(e=function(o,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var n in t)t.hasOwnProperty(n)&&(o[n]=t[n])})(o,t)},function(o,t){function n(){this.constructor=o}e(o,t),o.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),p=o.parse,o=T.seriesTypes.sma,L=t.defined,s=t.extend,Y=t.isArray,r=t.isNumber,_=t.merge,M=t.objectEach;function P(o){return{high:o.reduce(function(o,t){return Math.max(o,t[1])},-1/0),low:o.reduce(function(o,t){return Math.min(o,t[2])},1/0)}}function D(o){var t=o.indicator;t.points=o.points,t.nextPoints=o.nextPoints,t.color=o.color,t.options=_(o.options.senkouSpan.styles,o.gap),t.graph=o.graph,t.fillGraph=!0,T.seriesTypes.sma.prototype.drawGraph.call(t)}n(l,a=o),l.prototype.init=function(){a.prototype.init.apply(this,arguments),this.options=_({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:p(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:p(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:p(this.color).setOpacity(.2).get()}}},this.options)},l.prototype.toYData=function(o){return[o.tenkanSen,o.kijunSen,o.chikouSpan,o.senkouSpanA,o.senkouSpanB]},l.prototype.translate=function(){T.seriesTypes.sma.prototype.translate.apply(this);for(var o=0,t=this.points;o<t.length;o++)for(var n=t[o],e=0,i=this.pointArrayMap;e<i.length;e++){var p=i[e],s=n[p];r(s)&&(n["plot"+p]=this.yAxis.toPixels(s,!0),n.plotY=n["plot"+p],n.tooltipPos=[n.plotX,n["plot"+p]],n.isNull=!1)}},l.prototype.drawGraph=function(){var o,t,n,e,i,p,s,r,a,l,h,u,c,f,g=this,d=g.points,k=g.options,y=g.graph,S=g.color,v={options:{gapSize:k.gapSize}},m=g.pointArrayMap.length,A=[[],[],[],[],[],[]],C={tenkanLine:A[0],kijunLine:A[1],chikouLine:A[2],senkouSpanA:A[3],senkouSpanB:A[4],senkouSpan:A[5]},x=[],Y=g.options.senkouSpan,P=Y.color||Y.styles.fill,B=Y.negativeColor,j=[[],[]],b=[[],[]],N=d.length,w=0;for(g.ikhMap=C;N--;){for(t=d[N],n=0;n<m;n++)o=g.pointArrayMap[n],L(t[o])&&A[n].push({plotX:t.plotX,plotY:t["plot"+o],isNull:!1});B&&N!==d.length-1&&(c=C.senkouSpanB.length-1,(f=function(o,t,n,e){if(o&&t&&n&&e){var i=t.plotX-o.plotX,t=t.plotY-o.plotY,p=e.plotX-n.plotX,e=e.plotY-n.plotY,s=o.plotX-n.plotX,n=o.plotY-n.plotY,r=(-t*s+i*n)/(-p*t+i*e),n=(p*n-e*s)/(-p*t+i*e);if(0<=r&&r<=1&&0<=n&&n<=1)return{plotX:o.plotX+n*i,plotY:o.plotY+n*t}}}(C.senkouSpanA[c-1],C.senkouSpanA[c],C.senkouSpanB[c-1],C.senkouSpanB[c]))&&(f={plotX:f.plotX,plotY:f.plotY,isNull:!1,intersectPoint:!0},C.senkouSpanA.splice(c,0,f),C.senkouSpanB.splice(c,0,f),x.push(c)))}if(M(C,function(o,t){k[t]&&"senkouSpan"!==t&&(g.points=A[w],g.options=_(k[t].styles,v),g.graph=g["graph"+t],g.fillGraph=!1,g.color=S,T.seriesTypes.sma.prototype.drawGraph.call(g),g["graph"+t]=g.graph),w++}),g.graphCollection)for(var E=0,G=g.graphCollection;E<G.length;E++){var O=G[E];g[O].destroy(),delete g[O]}if(g.graphCollection=[],B&&C.senkouSpanA[0]&&C.senkouSpanB[0]){for(x.unshift(0),x.push(C.senkouSpanA.length-1),h=0;h<x.length-1;h++)if(X=x[h],e=x[h+1],i=C.senkouSpanB.slice(X,e+1),p=C.senkouSpanA.slice(X,e+1),1<=Math.floor(i.length/2)){var X=Math.floor(i.length/2);if(i[X].plotY===p[X].plotY){for(u=r=s=0;u<i.length;u++)s+=i[u].plotY,r+=p[u].plotY;j[l=r<s?0:1]=j[l].concat(i),b[l]=b[l].concat(p)}else l=i[X].plotY>p[X].plotY?0:1,j[l]=j[l].concat(i),b[l]=b[l].concat(p)}else l=i[0].plotY>p[0].plotY?0:1,j[l]=j[l].concat(i),b[l]=b[l].concat(p);["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(o,t){j[t].length&&b[t].length&&(a=0===t?P:B,D({indicator:g,points:j[t],nextPoints:b[t],color:a,options:k,gap:v,graph:g[o]}),g[o]=g.graph,g.graphCollection.push(o))})}else D({indicator:g,points:C.senkouSpanB,nextPoints:C.senkouSpanA,color:P,options:k,gap:v,graph:g.graphsenkouSpan}),g.graphsenkouSpan=g.graph;delete g.nextPoints,delete g.fillGraph,g.points=d,g.options=k,g.graph=y,g.color=S},l.prototype.getGraphPath=function(o){var t,n=this,e=[];if(o=o||this.points,n.fillGraph&&n.nextPoints){if((t=T.seriesTypes.sma.prototype.getGraphPath.call(n,n.nextPoints))&&t.length){t[0][0]="L";for(var i,e=T.seriesTypes.sma.prototype.getGraphPath.call(n,o),p=(i=t.slice(0,e.length)).length-1;0<=p;p--)e.push(i[p])}}else e=T.seriesTypes.sma.prototype.getGraphPath.apply(n,arguments);return e},l.prototype.getValues=function(o,t){var n,e,i,p,s,r,a,l,h,u,c,f=t.period,g=t.periodTenkan,d=t.periodSenkouSpanB,k=o.xData,y=o.yData,t=o.xAxis,S=y&&y.length||0,v=(t.series.forEach(function(o){if(o.xData)for(p=o.xData,e=o.xIncrement?1:p.length-1,s=e;0<s;s--)i=p[s]-p[s-1],(void 0===n||i<n)&&(n=i)}),n),m=[],A=[];if(!(k.length<=f)&&Y(y[0])&&4===y[0].length){for(var C=k[0]-f*v,x=0;x<f;x++)A.push(C+x*v);for(x=0;x<S;x++)g<=x&&(a=((a=P(y.slice(x-g,x))).high+a.low)/2),f<=x&&(u=(a+(l=((l=P(y.slice(x-f,x))).high+l.low)/2))/2),d<=x&&(c=((c=P(y.slice(x-d,x))).high+c.low)/2),h=y[x][3],r=k[x],void 0===m[x]&&(m[x]=[]),void 0===m[x+f-1]&&(m[x+f-1]=[]),m[x+f-1][0]=a,m[x+f-1][1]=l,(m[x+f-1][2]=void 0)===m[x+1]&&(m[x+1]=[]),m[x+1][2]=h,x<=f&&(m[x+f-1][3]=void 0,m[x+f-1][4]=void 0),void 0===m[x+2*f-2]&&(m[x+2*f-2]=[]),m[x+2*f-2][3]=u,m[x+2*f-2][4]=c,A.push(r);for(x=1;x<=f;x++)A.push(r+x*v);return{values:m,xData:A,yData:m}}},l.defaultOptions=_(o.defaultOptions,{params:{index:void 0,period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}});var a,t=l;function l(){var o=null!==a&&a.apply(this,arguments)||this;return o.data=[],o.options={},o.points=[],o.graphCollection=[],o}return s(t.prototype,{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"]}),i["ichimoku-averages"]=function(){var n,e=[];return[].forEach.call(arguments,function(o,t){e.push(i.average(o)),n=!n&&void 0===e[t]}),n?void 0:e},T.registerSeriesType("ikh",t),t}),t(o,"masters/indicators/ichimoku-kinko-hyo.src.js",[],function(){})});