!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/indicators/volume-by-price",["highcharts","highcharts/modules/stock"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function t(e,t,o,i){e.hasOwnProperty(t)||(e[t]=i.apply(null,o),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Stock/Indicators/VBP/VBPPoint.js",[e["Core/Series/SeriesRegistry.js"]],function(e){var i,t,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),e=e.seriesTypes.sma.prototype.pointClass;function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t=e),n.prototype.destroy=function(){this.negativeGraphic&&(this.negativeGraphic=this.negativeGraphic.destroy()),t.prototype.destroy.apply(this,arguments)},n}),t(e,"Stock/Indicators/VBP/VBPIndicator.js",[e["Stock/Indicators/VBP/VBPPoint.js"],e["Core/Animation/AnimationUtilities.js"],e["Core/Globals.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"],e["Core/Chart/StockChart.js"]],function(e,t,o,i,n,a){var s,r=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),p=t.animObject,t=o.noop,o=i.seriesTypes,y=o.column.prototype,o=o.sma,l=n.addEvent,g=n.arrayMax,v=n.arrayMin,S=n.correctFloat,m=n.defined,u=n.error,d=n.extend,h=n.isArray,n=n.merge,V=Math.abs;r(f,c=o),f.prototype.init=function(o){var i=this,n=(c.prototype.init.apply(i,arguments),l(a,"afterLinkSeries",function(){var e,t;i.options&&(t=i.options.params,e=i.linkedParent,t=o.get(t.volumeSeriesID),i.addCustomEvents(e,t)),n()},{order:1}));return i},f.prototype.addCustomEvents=function(e,t){function o(){i.chart.redraw(),i.setData([]),i.zoneStarts=[],i.zoneLinesSVG&&(i.zoneLinesSVG=i.zoneLinesSVG.destroy())}var i=this;return i.dataEventsToUnbind.push(l(e,"remove",function(){o()})),t&&i.dataEventsToUnbind.push(l(t,"remove",function(){o()})),i},f.prototype.animate=function(e){var o=this,t=o.chart.inverted,i=o.group,n={};!e&&i&&(e=t?o.yAxis.top:o.xAxis.left,t?(i["forceAnimate:translateY"]=!0,n.translateY=e):(i["forceAnimate:translateX"]=!0,n.translateX=e),i.animate(n,d(p(o.options.animation),{step:function(e,t){o.group.attr({scaleX:Math.max(.001,t.pos)})}})))},f.prototype.drawPoints=function(){var e=this;e.options.volumeDivision.enabled&&(e.posNegVolume(!0,!0),y.drawPoints.apply(e,arguments),e.posNegVolume(!1,!1)),y.drawPoints.apply(e,arguments)},f.prototype.posNegVolume=function(e,t){var o,i,n,a,s=this,r=t?["positive","negative"]:["negative","positive"],p=s.options.volumeDivision,l=s.points.length,d=[],u=[],h=0;for(e?(s.posWidths=d,s.negWidths=u):(d=s.posWidths,u=s.negWidths);h<l;h++)(a=s.points[h])[r[0]+"Graphic"]=a.graphic,a.graphic=a[r[1]+"Graphic"],e&&(o=a.shapeArgs.width,(n=(i=s.priceZones[h]).wholeVolumeData)?(d.push(o/n*i.positiveVolumeData),u.push(o/n*i.negativeVolumeData)):(d.push(0),u.push(0))),a.color=t?p.styles.positiveColor:p.styles.negativeColor,a.shapeArgs.width=(t?s.posWidths:s.negWidths)[h],a.shapeArgs.x=t?a.shapeArgs.x:s.posWidths[h]},f.prototype.translate=function(){var o,i,n,e,a,s,r,p,l=this,t=l.options,d=l.chart,u=l.yAxis,h=u.min,c=l.options.zoneLines,f=l.priceZones,v=0,m=(y.translate.apply(l),l.points);m.length&&(t=t.pointPadding<.5?t.pointPadding:.1,e=l.volumeDataArray,o=g(e),i=d.plotWidth/2,r=d.plotTop,n=V(u.toPixels(h)-u.toPixels(h+l.rangeStep)),a=V(u.toPixels(h)-u.toPixels(h+l.rangeStep)),t&&(e=V(n*(1-2*t)),v=V((n-e)/2),n=V(e)),m.forEach(function(e,t){e.barX=e.plotX=0,p=e.plotY=u.toPixels(f[t].start)-r-(u.reversed?n-a:n)-v,s=S(i*f[t].wholeVolumeData/o),e.pointWidth=s,e.shapeArgs=l.crispCol.apply(l,[0,p,s,n]),e.volumeNeg=f[t].negativeVolumeData,e.volumePos=f[t].positiveVolumeData,e.volumeAll=f[t].wholeVolumeData}),c.enabled&&l.drawZones(d,u,l.zoneStarts,c.styles))},f.prototype.getValues=function(e,t){var o,i=e.processedXData,n=e.processedYData,a=this.chart,s=t.ranges,r=[],p=[],l=[],d=a.get(t.volumeSeriesID);if(e.chart){if(d&&d.processedXData.length)return(o=h(n[0]))&&4!==n[0].length?void u("Type of "+e.name+" series is different than line, OHLC or candlestick.",!0,a):((this.priceZones=this.specifyZones(o,i,n,s,d)).forEach(function(e,t){r.push([e.x,e.end]),p.push(r[t][0]),l.push(r[t][1])}),{values:r,xData:p,yData:l});e=d&&!d.processedXData.length?" does not contain any data.":" not found! Check `volumeSeriesID`.",void u("Series "+t.volumeSeriesID+e,!0,a)}else u("Base series not found! In case it has been removed, add a new one.",!0,a)},f.prototype.specifyZones=function(e,t,o,i,n){var a=this,s=!!e&&function(e){for(var t,o=e.length,i=e[0][3],n=i,a=1;a<o;a++)(t=e[a][3])<i&&(i=t),n<t&&(n=t);return{min:i,max:n}}(o),r=a.zoneStarts=[],p=[],l=s?s.min:v(o),s=s?s.max:g(o),d=0,u=1,h=a.linkedParent;if(!a.options.compareToMain&&h.dataModify&&(l=h.dataModify.modifyValue(l),s=h.dataModify.modifyValue(s)),!m(l)||!m(s))return this.points.length&&(this.setData([]),this.zoneStarts=[],this.zoneLinesSVG&&(this.zoneLinesSVG=this.zoneLinesSVG.destroy())),[];var c=a.rangeStep=S(s-l)/i;for(r.push(l);d<i-1;d++)r.push(S(r[d]+c));r.push(s);for(var f=r.length;u<f;u++)p.push({index:u-1,x:t[0],start:r[u-1],end:r[u]});return a.volumePerZone(e,p,n,t,o)},f.prototype.volumePerZone=function(o,e,t,i,n){var a,s,r,p,l,d=this,u=t.processedXData,h=t.processedYData,c=e.length-1,f=n.length,t=h.length;return V(f-t)&&(i[0]!==u[0]&&h.unshift(0),i[f-1]!==u[t-1]&&h.push(0)),d.volumeDataArray=[],e.forEach(function(e){for(e.wholeVolumeData=0,e.positiveVolumeData=0,e.negativeVolumeData=0,l=0;l<f;l++){r=s=!1,p=o?n[l][3]:n[l],a=l?o?n[l-1][3]:n[l-1]:p;var t=d.linkedParent;!d.options.compareToMain&&t.dataModify&&(p=t.dataModify.modifyValue(p),a=t.dataModify.modifyValue(a)),p<=e.start&&0===e.index&&(s=!0),p>=e.end&&e.index===c&&(r=!0),(p>e.start||s)&&(p<e.end||r)&&(e.wholeVolumeData+=h[l],p<a?e.negativeVolumeData+=h[l]:e.positiveVolumeData+=h[l])}d.volumeDataArray.push(e.wholeVolumeData)}),e},f.prototype.drawZones=function(t,o,e,i){var n,a=t.renderer,s=t.plotWidth,r=t.plotTop,p=this.zoneLinesSVG,l=[];e.forEach(function(e){n=o.toPixels(e)-r,l=l.concat(t.renderer.crispLine([["M",0,n],["L",s,n]],i.lineWidth))}),p?p.animate({d:l}):this.zoneLinesSVG=a.path(l).attr({"stroke-width":i.lineWidth,stroke:i.color,dashstyle:i.dashStyle,zIndex:this.group.zIndex+.1}).add(this.group)},f.defaultOptions=n(o.defaultOptions,{params:{index:void 0,period:void 0,ranges:12,volumeSeriesID:"volume"},zoneLines:{enabled:!0,styles:{color:"#0A9AC9",dashStyle:"LongDash",lineWidth:1}},volumeDivision:{enabled:!0,styles:{positiveColor:"rgba(144, 237, 125, 0.8)",negativeColor:"rgba(244, 91, 91, 0.8)"}},animationLimit:1e3,enableMouseTracking:!1,pointPadding:0,zIndex:-1,crisp:!0,dataGrouping:{enabled:!1},dataLabels:{allowOverlap:!0,enabled:!0,format:"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}",padding:0,style:{fontSize:"0.5em"},verticalAlign:"top"}});var c,r=f;function f(){var e=null!==c&&c.apply(this,arguments)||this;return e.data=void 0,e.negWidths=void 0,e.options=void 0,e.points=void 0,e.posWidths=void 0,e.priceZones=void 0,e.rangeStep=void 0,e.volumeDataArray=void 0,e.zoneStarts=void 0,e.zoneLinesSVG=void 0,e}return d(r.prototype,{nameBase:"Volume by Price",nameComponents:["ranges"],calculateOn:{chart:"render",xAxis:"afterSetExtremes"},pointClass:e,markerAttribs:t,drawGraph:t,getColumnMetrics:y.getColumnMetrics,crispCol:y.crispCol}),i.registerSeriesType("vbp",r),r}),t(e,"masters/indicators/volume-by-price.src.js",[],function(){})});