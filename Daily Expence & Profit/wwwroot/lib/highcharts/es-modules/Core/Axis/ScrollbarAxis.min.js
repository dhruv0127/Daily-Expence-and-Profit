"use strict";import U from"../Utilities.js";const{addEvent,defined,pick}=U,composedMembers=[];class ScrollbarAxis{static compose(i,t){if(!U.pushUnique(composedMembers,i))return i;const d=i=>{var t=pick(i.options&&i.options.min,i.min),e=pick(i.options&&i.options.max,i.max);return{axisMin:t,axisMax:e,scrollMin:defined(i.dataMin)?Math.min(t,i.min,i.dataMin,pick(i.threshold,1/0)):t,scrollMax:defined(i.dataMax)?Math.max(e,i.max,i.dataMax,pick(i.threshold,-1/0)):e}};return addEvent(i,"afterInit",function(){const l=this;l.options&&l.options.scrollbar&&l.options.scrollbar.enabled&&(l.options.scrollbar.vertical=!l.horiz,l.options.startOnTick=l.options.endOnTick=!1,l.scrollbar=new t(l.chart.renderer,l.options.scrollbar,l.chart),addEvent(l.scrollbar,"changed",function(i){let{axisMin:t,axisMax:e,scrollMin:o,scrollMax:s}=d(l),r=s-o,a,n;var p;defined(t)&&defined(e)&&(n=l.horiz&&!l.reversed||!l.horiz&&l.reversed?(a=o+r*this.to,o+r*this.from):(a=o+r*(1-this.from),o+r*(1-this.to)),this.shouldUpdateExtremes(i.DOMType)?(p="mousemove"!==i.DOMType&&"touchmove"!==i.DOMType&&void 0,l.setExtremes(n,a,!0,p,i)):this.setRange(this.from,this.to))}))}),addEvent(i,"afterRender",function(){let t=this,{scrollMin:i,scrollMax:e}=d(t),o=t.scrollbar,s=t.axisTitleMargin+(t.titleOffset||0),r=t.chart.scrollbarsOffsets,a=t.options.margin||0,n,p,l;if(o){if(t.horiz)t.opposite||(r[1]+=s),o.position(t.left,t.top+t.height+2+r[1]-(t.opposite?a:0),t.width,t.height),t.opposite||(r[1]+=a),n=1;else{t.opposite&&(r[0]+=s);let i;i=o.options.opposite?t.left+t.width+2+r[0]-(t.opposite?0:a):t.opposite?0:a,o.position(i,t.top,t.width,t.height),t.opposite&&(r[0]+=a),n=0}r[n]+=o.size+(o.options.margin||0),isNaN(i)||isNaN(e)||!defined(t.min)||!defined(t.max)||t.min===t.max?o.setRange(0,1):(p=(t.min-i)/(e-i),l=(t.max-i)/(e-i),t.horiz&&!t.reversed||!t.horiz&&t.reversed?o.setRange(p,l):o.setRange(1-l,1-p))}}),addEvent(i,"afterGetOffset",function(){var i=this,t=i.scrollbar,e=t&&!t.options.opposite,e=i.horiz?2:e?3:1;t&&(i.chart.scrollbarsOffsets=[0,0],i.chart.axisOffset[e]+=t.size+(t.options.margin||0))}),i}}export default ScrollbarAxis;