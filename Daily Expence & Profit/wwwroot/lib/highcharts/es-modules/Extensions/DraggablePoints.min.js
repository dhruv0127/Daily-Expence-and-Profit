"use strict";import A from"../Core/Animation/AnimationUtilities.js";const animObject=A["animObject"];import Chart from"../Core/Chart/Chart.js";import H from"../Core/Globals.js";import Point from"../Core/Series/Point.js";import Series from"../Core/Series/Series.js";import SeriesRegistry from"../Core/Series/SeriesRegistry.js";const seriesTypes=SeriesRegistry["seriesTypes"];import U from"../Core/Utilities.js";const{addEvent,clamp,isNumber,merge,objectEach,pick}=U;function flipResizeSide(e){return{left:"right",right:"left",top:"bottom",bottom:"top"}[e]}const horizHandleFormatter=function(e){var e=e.shapeArgs||e.graphic.getBBox(),r=e.r||0,o=e.height-r,e=e.height/2;return[["M",0,r],["L",0,e-5],["A",1,1,0,0,0,0,5+e],["A",1,1,0,0,0,0,e-5],["M",0,5+e],["L",0,o]]},lineDragDropProps=Series.prototype.dragDropProps={x:{axis:"x",move:!0},y:{axis:"y",move:!0}},columnDragDropProps=(seriesTypes.flags&&(seriesTypes.flags.prototype.dragDropProps=lineDragDropProps),seriesTypes.column.prototype.dragDropProps={x:{axis:"x",move:!0},y:{axis:"y",move:!1,resize:!0,beforeResize:function(e,r,o){var t=pick(o.yBottom,o.series.translatedThreshold),a=e.attr("y"),i=isNumber(o.stackY)?o.stackY-(o.y||0):o.series.options.threshold||0,r=i+r.y;(o.series.yAxis.reversed?r<i:i<=r)?(o=e.attr("height"),e.attr({height:Math.max(0,Math.round(o+(t?t-a-o:0)))})):e.attr({y:Math.round(a+(t?t-a:0))})},resizeSide:function(e,r){const o=r.series.chart,t=o.dragHandles,a=e.y>=(r.series.options.threshold||0)?"top":"bottom",i=flipResizeSide(a);return t&&t[i]&&(t[i].destroy(),delete t[i]),a},handlePositioner:function(e){var r=e.shapeArgs||e.graphic&&e.graphic.getBBox()||{},o=e.series.yAxis.reversed,t=e.series.options.threshold||0,e=e.y||0;return{x:r.x||0,y:!o&&t<=e||o&&e<t?r.y||0:(r.y||0)+(r.height||0)}},handleFormatter:function(e){var e=e.shapeArgs||{},r=e.r||0,e=e.width||0,o=e/2;return[["M",r,0],["L",o-5,0],["A",1,1,0,0,0,5+o,0],["A",1,1,0,0,0,o-5,0],["M",5+o,0],["L",e-r,0]]}}});if(seriesTypes.bullet&&(seriesTypes.bullet.prototype.dragDropProps={x:columnDragDropProps.x,y:columnDragDropProps.y,target:{optionName:"draggableTarget",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){var r=e.targetGraphic.getBBox();return{x:e.barX,y:r.y+r.height/2}},handleFormatter:columnDragDropProps.y.handleFormatter}}),seriesTypes.columnrange&&(seriesTypes.columnrange.prototype.dragDropProps={x:{axis:"x",move:!0},low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){e=e.shapeArgs||e.graphic.getBBox();return{x:e.x||0,y:(e.y||0)+(e.height||0)}},handleFormatter:columnDragDropProps.y.handleFormatter,propValidate:function(e,r){return e<=r.high}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){e=e.shapeArgs||e.graphic.getBBox();return{x:e.x||0,y:e.y||0}},handleFormatter:columnDragDropProps.y.handleFormatter,propValidate:function(e,r){return e>=r.low}}}),seriesTypes.boxplot&&(seriesTypes.boxplot.prototype.dragDropProps={x:columnDragDropProps.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.lowPlot}},handleFormatter:columnDragDropProps.y.handleFormatter,propValidate:function(e,r){return e<=r.q1}},q1:{optionName:"draggableQ1",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.q1Plot}},handleFormatter:columnDragDropProps.y.handleFormatter,propValidate:function(e,r){return e<=r.median&&e>=r.low}},median:{axis:"y",move:!0},q3:{optionName:"draggableQ3",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.q3Plot}},handleFormatter:columnDragDropProps.y.handleFormatter,propValidate:function(e,r){return e<=r.high&&e>=r.median}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.highPlot}},handleFormatter:columnDragDropProps.y.handleFormatter,propValidate:function(e,r){return e>=r.q3}}}),seriesTypes.ohlc&&(seriesTypes.ohlc.prototype.dragDropProps={x:columnDragDropProps.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotLow}},handleFormatter:columnDragDropProps.y.handleFormatter,propValidate:function(e,r){return e<=r.open&&e<=r.close}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotHigh}},handleFormatter:columnDragDropProps.y.handleFormatter,propValidate:function(e,r){return e>=r.open&&e>=r.close}},open:{optionName:"draggableOpen",axis:"y",move:!0,resize:!0,resizeSide:function(e){return e.open>=e.close?"top":"bottom"},handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotOpen}},handleFormatter:columnDragDropProps.y.handleFormatter,propValidate:function(e,r){return e<=r.high&&e>=r.low}},close:{optionName:"draggableClose",axis:"y",move:!0,resize:!0,resizeSide:function(e){return e.open>=e.close?"bottom":"top"},handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotClose}},handleFormatter:columnDragDropProps.y.handleFormatter,propValidate:function(e,r){return e<=r.high&&e>=r.low}}}),seriesTypes.arearange){const ra=seriesTypes.columnrange.prototype.dragDropProps,sa=function(e){e=e.graphic?e.graphic.getBBox().width/2+1:4;return[["M",0-e,0],["a",e,e,0,1,0,2*e,0],["a",e,e,0,1,0,-2*e,0]]};seriesTypes.arearange.prototype.dragDropProps={x:ra.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){e=e.graphics&&e.graphics[0]&&e.graphics[0].getBBox();return e?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:-999,y:-999}},handleFormatter:sa,propValidate:ra.low.propValidate},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){e=e.graphics&&e.graphics[1]&&e.graphics[1].getBBox();return e?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:-999,y:-999}},handleFormatter:sa,propValidate:ra.high.propValidate}}}if(seriesTypes.waterfall&&(seriesTypes.waterfall.prototype.dragDropProps={x:columnDragDropProps.x,y:merge(columnDragDropProps.y,{handleFormatter:function(e){return e.isSum||e.isIntermediateSum?null:columnDragDropProps.y.handleFormatter(e)}})}),seriesTypes.xrange){const Aa=function(e,r){const o=e.series,t=o.xAxis,a=o.yAxis,i=o.chart.inverted,n=o.columnMetrics?o.columnMetrics.offset:-e.shapeArgs.height/2;let s=t.toPixels(e[r],!0),d=a.toPixels(e.y,!0);return i&&(s=t.len-s,d=a.len-d),d+=n,{x:Math.round(s),y:Math.round(d)}},Ba=seriesTypes.xrange.prototype.dragDropProps={y:{axis:"y",move:!0},x:{optionName:"draggableX1",axis:"x",move:!0,resize:!0,resizeSide:"left",handlePositioner:function(e){return Aa(e,"x")},handleFormatter:horizHandleFormatter,propValidate:function(e,r){return e<=r.x2}},x2:{optionName:"draggableX2",axis:"x",move:!0,resize:!0,resizeSide:"right",handlePositioner:function(e){return Aa(e,"x2")},handleFormatter:horizHandleFormatter,propValidate:function(e,r){return e>=r.x}}};seriesTypes.gantt&&(seriesTypes.gantt.prototype.dragDropProps={y:Ba.y,start:merge(Ba.x,{optionName:"draggableStart",validateIndividualDrag:function(e){return!e.milestone}}),end:merge(Ba.x2,{optionName:"draggableEnd",validateIndividualDrag:function(e){return!e.milestone}})})}["gauge","pie","sunburst","wordcloud","sankey","histogram","pareto","vector","windbarb","treemap","bellcurve","sma","map","mapline"].forEach(function(e){seriesTypes[e]&&(seriesTypes[e].prototype.dragDropProps=null)});const defaultDragSensitivity=2,defaultGuideBoxOptions={default:{className:"highcharts-drag-box-default",lineWidth:1,lineColor:"#888",color:"rgba(0, 0, 0, 0.1)",cursor:"move",zIndex:900}},defaultDragHandleOptions={className:"highcharts-drag-handle",color:"#fff",lineColor:"rgba(0, 0, 0, 0.6)",lineWidth:1,zIndex:901};function isSeriesDraggable(e){const r=["draggableX","draggableY"];objectEach(e.dragDropProps,function(e){e.optionName&&r.push(e.optionName)});let o=r.length;for(;o--;)if(e.options.dragDrop[r[o]])return!0}function isChartDraggable(e){let r=e.series?e.series.length:0;if(e.hasCartesianSeries&&!e.polar||e.mapView)for(;r--;)if(e.series[r].options.dragDrop&&isSeriesDraggable(e.series[r]))return!0}function isPointMovable(e){var r=e.series,o=r.chart,t=r.options.dragDrop||{},e=e.options&&e.options.dragDrop,a=r.dragDropProps;let i,n;return objectEach(a,function(e){"x"===e.axis&&e.move?i=!0:"y"===e.axis&&e.move&&(n=!0)}),(t.draggableX&&i||t.draggableY&&n)&&!(e&&!1===e.draggableX&&!1===e.draggableY)&&(r.yAxis&&r.xAxis||o.mapView)}function getNormalizedEvent(e,r){return void 0===e.chartX||void 0===e.chartY?r.pointer.normalize(e):e}function addEvents(r,e,o,t){const a=e.map(function(e){return addEvent(r,e,o,t)});return function(){a.forEach(function(e){e()})}}function hasDraggedPastSensitivity(e,r,o){var r=r.dragDropData.origin,t=r.chartX,r=r.chartY,a=e.chartX,e=e.chartY;return o<Math.sqrt((a-t)*(a-t)+(e-r)*(e-r))}function getPositionSnapshot(i,e,r){const o={chartX:i.chartX,chartY:i.chartY,guideBox:r&&{x:r.attr("x"),y:r.attr("y"),width:r.attr("width"),height:r.attr("height")},points:{}};return e.forEach(function(t){const a={};objectEach(t.series.dragDropProps,function(e,r){const o=t.series[e.axis+"Axis"];a[r]=t[r],t.series.chart.mapView&&t.plotX&&t.plotY?a[r+"Offset"]="x"===r?t.plotX:t.plotY:a[r+"Offset"]=o.toPixels(t[r])-(o.horiz?i.chartX:i.chartY)}),a.point=t,o.points[t.id]=a}),o}function getGroupedPoints(r){const o=r.series,t=o.options.dragDrop.groupBy;let a=[];return o.boosted?o.options.data.forEach(function(e,r){a.push((new o.pointClass).init(o,e)),a[a.length-1].index=r}):a=o.points,r.options[t]?a.filter(function(e){return e.options[t]===r.options[t]}):[r]}function resizeRect(e,r,o){let t;switch(r){case"left":t={x:e.attr("x")+o.x,width:Math.max(1,e.attr("width")-o.x)};break;case"right":t={width:Math.max(1,e.attr("width")+o.x)};break;case"top":t={y:e.attr("y")+o.y,height:Math.max(1,e.attr("height")-o.y)};break;case"bottom":t={height:Math.max(1,e.attr("height")+o.y)}}e.attr(t)}function initDragDrop(e,r){const o=getGroupedPoints(r),t=r.series,a=t.chart;let i;pick(t.options.dragDrop&&t.options.dragDrop.liveRedraw,!0)||(a.dragGuideBox=i=t.getGuideBox(o),a.setGuideBoxState("default",t.options.dragDrop.guideBox).add(t.group)),a.dragDropData={origin:getPositionSnapshot(e,o,i),point:r,groupedPoints:o,isDragging:!0}}function getNewPoints(r,o){const e=r.point,t=e.series,a=t.chart,i=merge(t.options.dragDrop,e.options.dragDrop),n={},s=r.updateProp,d={};return objectEach(e.series.dragDropProps,function(e,r){s&&(s!==r||!e.resize||e.optionName&&!1===i[e.optionName])||(s||e.move&&("x"===e.axis&&i.draggableX||"y"===e.axis&&i.draggableY))&&(a.mapView?n["x"===r?"lon":"lat"]=e:n[r]=e)}),(s?[e]:r.groupedPoints).forEach(function(e){d[e.id]={point:e,newValues:e.getDropValues(r.origin,o,n)}}),d}function updatePoints(e,r){var o=e.dragDropData.newPoints,r=animObject(r);e.isDragDropAnimating=!0,objectEach(o,function(e){e.point.update(e.newValues,!1)}),e.redraw(r),setTimeout(function(){delete e.isDragDropAnimating,e.hoverPoint&&!e.dragHandles&&e.hoverPoint.showDragHandles()},r.duration)}function resizeGuideBox(e,r,o){const t=e.series,a=t.chart,i=a.dragDropData,n=t.dragDropProps[i.updateProp],s=i.newPoints[e.id].newValues,d="function"==typeof n.resizeSide?n.resizeSide(s,e):n.resizeSide;n.beforeResize&&n.beforeResize(a.dragGuideBox,s,e),resizeRect(a.dragGuideBox,"x"===n.axis&&t.xAxis.reversed||"y"===n.axis&&t.yAxis.reversed?flipResizeSide(d):d,{x:"x"===n.axis?r-(i.origin.prevdX||0):0,y:"y"===n.axis?o-(i.origin.prevdY||0):0})}function dragMove(e,r){const o=r.series,t=o.chart,a=t.dragDropData,i=merge(o.options.dragDrop,r.options.dragDrop),n=i.draggableX,s=i.draggableY,d=a.origin,p=a.updateProp;let g=e.chartX-d.chartX,l=e.chartY-d.chartY;e=g;t.inverted&&(g=-l,l=-e),pick(i.liveRedraw,!0)?(updatePoints(t,!1),r.showDragHandles()):p?resizeGuideBox(r,g,l):t.dragGuideBox.translate(n?g:0,s?l:0),d.prevdX=g,d.prevdY=l}function mouseOut(e){const r=e.series&&e.series.chart,o=r&&r.dragDropData;!r||!r.dragHandles||o&&(o.isDragging&&o.draggedPastSensitivity||o.isHoveringHandle===e.id)||r.hideDragHandles()}function onResizeHandleMouseOut(e){const r=e.series.chart;r.dragDropData&&e.id===r.dragDropData.isHoveringHandle&&delete r.dragDropData.isHoveringHandle,r.hoverPoint||mouseOut(e)}function onResizeHandleMouseDown(e,r,o){const t=r.series.chart;t.zoomOrPanKeyPressed(e)||(t.mouseIsDown=!1,initDragDrop(e,r),t.dragDropData.updateProp=e.updateProp=o,r.firePointEvent("dragStart",e),e.stopPropagation(),e.preventDefault())}function countProps(e){let r=0;for(const o in e)Object.hasOwnProperty.call(e,o)&&r++;return r}function getFirstProp(e){for(const r in e)if(Object.hasOwnProperty.call(e,r))return e[r]}function mouseOver(e){const r=e.series,o=r&&r.chart,t=o&&o.dragDropData,a=o&&o.is3d&&o.is3d();!o||t&&t.isDragging&&t.draggedPastSensitivity||o.isDragDropAnimating||!r.options.dragDrop||a||(o.dragHandles&&o.hideDragHandles(),e.showDragHandles())}function mouseMove(i,n){if(!n.zoomOrPanKeyPressed(i)){const s=n.dragDropData;let e,r,o,t,a;s&&s.isDragging&&s.point.series&&(r=(e=s.point).series.options.dragDrop,i.preventDefault(),s.draggedPastSensitivity||(s.draggedPastSensitivity=hasDraggedPastSensitivity(i,n,pick(e.options.dragDrop&&e.options.dragDrop.dragSensitivity,r&&r.dragSensitivity,defaultDragSensitivity))),s.draggedPastSensitivity&&(s.newPoints=getNewPoints(s,i),a=1===(t=countProps(o=s.newPoints))?getFirstProp(o):null,e.firePointEvent("drag",{origin:s.origin,newPoints:s.newPoints,newPoint:a&&a.newValues,newPointId:a&&a.point.id,numNewPoints:t,chartX:i.chartX,chartY:i.chartY},function(){dragMove(i,e)})))}}function mouseUp(e,r){var o=r.dragDropData;if(o&&o.isDragging&&o.draggedPastSensitivity&&o.point.series){const t=o.point,a=o.newPoints,i=countProps(a),n=1===i?getFirstProp(a):null;r.dragHandles&&r.hideDragHandles(),e.preventDefault(),r.cancelClick=!0,t.firePointEvent("drop",{origin:o.origin,chartX:e.chartX,chartY:e.chartY,newPoints:a,numNewPoints:i,newPoint:n&&n.newValues,newPointId:n&&n.point.id},function(){updatePoints(r)})}delete r.dragDropData,r.dragGuideBox&&(r.dragGuideBox.destroy(),delete r.dragGuideBox)}function mouseDown(e,r){const o=r.hoverPoint,t=merge(o&&o.series.options.dragDrop,o&&o.options.dragDrop),a=t.draggableX||!1,i=t.draggableY||!1;r.cancelClick=!1,!a&&!i||r.zoomOrPanKeyPressed(e)||r.hasDraggedAnnotation||(r.dragDropData&&r.dragDropData.isDragging?mouseUp(e,r):o&&isPointMovable(o)&&(r.mouseIsDown=!1,initDragDrop(e,o),o.firePointEvent("dragStart",e)))}function addDragDropEvents(r){var e=r.container,o=H.doc;isChartDraggable(r)&&(addEvents(e,["mousedown","touchstart"],function(e){mouseDown(getNormalizedEvent(e,r),r)}),addEvents(e,["mousemove","touchmove"],function(e){mouseMove(getNormalizedEvent(e,r),r)},{passive:!1}),addEvent(e,"mouseleave",function(e){mouseUp(getNormalizedEvent(e,r),r)}),r.unbindDragDropMouseUp=addEvents(o,["mouseup","touchend"],function(e){mouseUp(getNormalizedEvent(e,r),r)},{passive:!1}),r.hasAddedDragDropEvents=!0,addEvent(r,"destroy",function(){r.unbindDragDropMouseUp&&r.unbindDragDropMouseUp()}))}Chart.prototype.setGuideBoxState=function(e,r){const o=this.dragGuideBox,t=merge(defaultGuideBoxOptions,r),a=merge(t.default,t[e]);return o.attr({class:a.className,stroke:a.lineColor,strokeWidth:a.lineWidth,fill:a.color,cursor:a.cursor,zIndex:a.zIndex}).css({pointerEvents:"none"})},Point.prototype.getDropValues=function(e,i,r){const n=this,s=n.series,p=s.chart,g=p.mapView,l=merge(s.options.dragDrop,n.options.dragDrop),d={},u=e.points[n.id];let c;for(const o in r)if(Object.hasOwnProperty.call(r,o)){if(void 0!==c){c=!1;break}c=!0}return objectEach(r,function(e,r){const o=u.point[r],t=s[e.axis+"Axis"],a=g?function(t,a,i){if(g){var n=pick(l["dragPrecision"+a],0),s=g.pixelsToLonLat({x:0,y:0}),d=g.pixelsToLonLat({x:p.plotBox.width,y:p.plotBox.height});let e=pick(l["dragMin"+a],s&&s[i],-1/0),r=pick(l["dragMax"+a],d&&d[i],1/0),o=t[i];return"Orthographic"===g.projection.options.name?o:("lat"===i&&((isNaN(e)||e>g.projection.maxLatitude)&&(e=g.projection.maxLatitude),s=r=isNaN(r)||r<-1*g.projection.maxLatitude?-1*g.projection.maxLatitude:r,r=e,e=s),g.projection.hasCoordinates||(a=g.pixelsToLonLat({x:t.chartX-p.plotLeft,y:p.plotHeight-t.chartY+p.plotTop}))&&(o=a[i]),n&&(o=Math.round(o/n)*n),clamp(o,e,r))}}(i,e.axis.toUpperCase(),r):function(e,r){var o=s[r.toLowerCase()+"Axis"].categories?1:0,o=pick(l["dragPrecision"+r],o),t=pick(l["dragMin"+r],-1/0),r=pick(l["dragMax"+r],1/0);let a=e;return o&&(a=Math.round(a/o)*o),clamp(a,t,r)}(t.toValue((t.horiz?i.chartX:i.chartY)+u[r+"Offset"]),e.axis.toUpperCase());!isNumber(a)||c&&e.propValidate&&!e.propValidate(a,n)||void 0===o||(d[r]=a)}),d},Series.prototype.getGuideBox=function(e){const r=this.chart;let a=1/0,i=-1/0,n=1/0,s=-1/0,d;return e.forEach(function(r){var o=r.graphic&&r.graphic.getBBox()||r.shapeArgs;if(o){let e;var t=r.x2,t=(isNumber(t)&&(e=r.series.xAxis.translate(t,!1,!1,!1,!0)),!(o.width||o.height||o.x||o.y));d=!0,a=Math.min(r.plotX||0,e||0,t?1/0:o.x||0,a),i=Math.max(r.plotX||0,e||0,(o.x||0)+(o.width||0),i),n=Math.min(r.plotY||0,t?1/0:o.y||0,n),s=Math.max((o.y||0)+(o.height||0),s)}}),d?r.renderer.rect(a,n,i-a,s-n):r.renderer.g()},Point.prototype.showDragHandles=function(){const l=this,u=l.series,c=u.chart,{inverted:h,renderer:m}=c,x=merge(u.options.dragDrop,l.options.dragDrop);objectEach(u.dragDropProps,function(e,r){const o=merge(defaultDragHandleOptions,e.handleOptions,x.dragHandle),t={class:o.className,"stroke-width":o.lineWidth,fill:o.color,stroke:o.lineColor},a=o.pathFormatter||e.handleFormatter,i=e.handlePositioner,n=!e.validateIndividualDrag||e.validateIndividualDrag(l);let s,d,p;var g;e.resize&&n&&e.resizeSide&&a&&(x["draggable"+e.axis.toUpperCase()]||x[e.optionName])&&!1!==x[e.optionName]&&(c.dragHandles||(c.dragHandles={group:m.g("drag-drop-handles").add(u.markerGroup||u.group)}),c.dragHandles.point=l.id,s=i(l),t.d=p=a(l),g=l.series.xAxis.categories?-.5:0,!p||s.x<g||s.y<0||(t.cursor=o.cursor||("x"===e.axis!=!!h?"ew-resize":"ns-resize"),d=(d=c.dragHandles[e.optionName])||(c.dragHandles[e.optionName]=m.path().add(c.dragHandles.group)),t.translateX=h?u.yAxis.len-s.y:s.x,t.translateY=h?u.xAxis.len-s.x:s.y,h&&(t.rotation=-90),d.attr(t),addEvents(d.element,["touchstart","mousedown"],function(e){onResizeHandleMouseDown(getNormalizedEvent(e,c),l,r)},{passive:!1}),addEvent(c.dragHandles.group.element,"mouseover",function(){c.dragDropData=c.dragDropData||{},c.dragDropData.isHoveringHandle=l.id}),addEvents(c.dragHandles.group.element,["touchend","mouseout"],function(){onResizeHandleMouseOut(l)})))})},Chart.prototype.hideDragHandles=function(){var e=this;e.dragHandles&&(objectEach(e.dragHandles,function(e,r){"group"!==r&&e.destroy&&e.destroy()}),e.dragHandles.group&&e.dragHandles.group.destroy&&e.dragHandles.group.destroy(),delete e.dragHandles)},addEvent(Point,"mouseOver",function(){const e=this;setTimeout(function(){mouseOver(e)},12)}),addEvent(Point,"mouseOut",function(){const e=this;setTimeout(function(){e.series&&mouseOut(e)},10)}),addEvent(Point,"remove",function(){const e=this.series.chart,r=e.dragHandles;r&&r.point===this.id&&e.hideDragHandles()}),Chart.prototype.zoomOrPanKeyPressed=function(e){var r=this.options.chart||{},o=r.panKey&&r.panKey+"Key";return e[r.zooming.key&&r.zooming.key+"Key"]||e[o]},addEvent(Chart,"render",function(){this.hasAddedDragDropEvents||addDragDropEvents(this)});