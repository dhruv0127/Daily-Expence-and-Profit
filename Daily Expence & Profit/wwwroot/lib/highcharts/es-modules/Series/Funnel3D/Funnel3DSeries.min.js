"use strict";import Funnel3DComposition from"./Funnel3DComposition.js";import Funnel3DPoint from"./Funnel3DPoint.js";import H from"../../Core/Globals.js";const noop=H["noop"];import Math3D from"../../Core/Math3D.js";const perspective=Math3D["perspective"];import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";const{series:Series,seriesTypes:{column:ColumnSeries}}=SeriesRegistry;import U from"../../Core/Utilities.js";const{extend,merge,pick,relativeLength}=U;class Funnel3DSeries extends ColumnSeries{constructor(){super(...arguments),this.center=void 0,this.data=void 0,this.options=void 0,this.points=void 0}alignDataLabel(e,t,i){const o=this,n=e.dlBoxRaw,r=o.chart.inverted,s=e.plotY>pick(o.translatedThreshold,o.yAxis.len),l=pick(i.inside,!!o.options.stacking),d={x:n.x,y:n.y,height:0};i.align=pick(i.align,!r||l?"center":s?"right":"left"),i.verticalAlign=pick(i.verticalAlign,r||l?"middle":s?"top":"bottom"),"top"!==i.verticalAlign&&(d.y+=n.bottom/("bottom"===i.verticalAlign?1:2)),d.width=o.getWidthAt(d.y),o.options.reversed&&(d.width=n.fullWidth-d.width),l?d.x-=d.width/2:"left"===i.align?(i.align="right",d.x-=1.5*d.width):"right"===i.align?(i.align="left",d.x+=d.width/2):d.x-=d.width/2,e.dlBox=d,ColumnSeries.prototype.alignDataLabel.apply(o,arguments)}bindAxes(){Series.prototype.bindAxes.apply(this,arguments),extend(this.xAxis.options,{gridLineWidth:0,lineWidth:0,title:void 0,tickPositions:[]}),merge(!0,this.yAxis.options,{gridLineWidth:0,title:void 0,labels:{enabled:!1}})}translate(){Series.prototype.translate.apply(this,arguments);let t=0,e=this,i=e.chart,o=e.options,n=o.reversed,r=o.ignoreHiddenPoint,s=i.plotWidth,l=i.plotHeight,d=0,a=o.center,h=relativeLength(a[0],s),p=relativeLength(a[1],l),g=relativeLength(o.width,s),c,m,u=relativeLength(o.height,l),v=relativeLength(o.neckWidth,s),y=relativeLength(o.neckHeight,l),f=p-u/2+u-y,x=e.data,w,S,b,D,F,A,C;e.getWidthAt=m=function(e){var t=p-u/2;return e>f||u===y?v:v+(g-v)*(1-(e-t)/(u-y))},e.center=[h,p,u],e.centerX=h,x.forEach(function(e){r&&!1===e.visible||(t+=e.y)}),x.forEach(function(e){F=null,w=t?e.y/t:0,b=p-u/2+d*u,D=b+w*u,c=m(b),A=D-b,C={gradientForSides:pick(e.options.gradientForSides,o.gradientForSides),x:h,y:b,height:A,width:c,z:1,top:{width:c}},c=m(D),C.bottom={fraction:w,width:c},b>=f?C.isCylinder=!0:D>f&&(F=D,c=m(f),D=f,C.bottom.width=c,C.middle={fraction:A?(f-b)/A:0,width:c}),n&&(C.y=b=p+u/2-(d+w)*u,C.middle&&(C.middle.fraction=1-(A?C.middle.fraction:0)),c=C.width,C.width=C.bottom.width,C.bottom.width=c),e.shapeArgs=extend(e.shapeArgs,C),e.percentage=100*w,e.plotX=h,n?e.plotY=p+u/2-(d+w/2)*u:e.plotY=(b+(F||D))/2,S=perspective([{x:h,y:e.plotY,z:n?-(g-m(e.plotY))/2:-m(e.plotY)/2}],i,!0)[0],e.tooltipPos=[S.x,S.y],e.dlBoxRaw={x:h,width:m(e.plotY),y:b,bottom:C.height||0,fullWidth:g},r&&!1===e.visible||(d+=w)})}}Funnel3DSeries.compose=Funnel3DComposition.compose,Funnel3DSeries.defaultOptions=merge(ColumnSeries.defaultOptions,{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,gradientForSides:!0,animation:!1,edgeWidth:0,colorByPoint:!0,showInLegend:!1,dataLabels:{align:"right",crop:!1,inside:!1,overflow:"allow"}}),extend(Funnel3DSeries.prototype,{pointClass:Funnel3DPoint,translate3dShapes:noop}),SeriesRegistry.registerSeriesType("funnel3d",Funnel3DSeries);export default Funnel3DSeries;