"use strict";import Color from"../../Core/Color/Color.js";const color=Color["parse"];import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";const{line:LineSeries}=SeriesRegistry["seriesTypes"];import U from"../../Core/Utilities.js";const{extend,merge,objectEach,pick}=U;class AreaSeries extends LineSeries{constructor(){super(...arguments),this.data=void 0,this.options=void 0,this.points=void 0}drawGraph(){this.areaPath=[],super.drawGraph.apply(this);const o=this,l=this.areaPath,a=this.options,t=this.zones,i=[["area","highcharts-area",this.color,a.fillColor]];t.forEach(function(t,e){i.push(["zone-area-"+e,"highcharts-area highcharts-zone-area-"+e+" "+t.className,t.color||o.color,t.fillColor||a.fillColor])}),i.forEach(function(t){const e=t[0],i={};let s=o[e];var r=s?"animate":"attr";s?(s.endX=o.preventGraphAnimation?null:l.xMap,s.animate({d:l})):(i.zIndex=0,(s=o[e]=o.chart.renderer.path(l).addClass(t[1]).add(o.group)).isArea=!0),o.chart.styledMode||(i.fill=pick(t[3],color(t[2]).setOpacity(pick(a.fillOpacity,.75)).get())),s[r](i),s.startX=l.xMap,s.shiftUnit=a.step?2:1})}getGraphPath(n){function i(t,e,i){var t=n[t],s=h&&d[t.x].points[u],r=t[i+"Null"]||0,t=t[i+"Cliff"]||0;let o,l,a=!0;t||r?(o=(r?s[0]:s[1])+t,l=s[0]+t,a=!!r):!h&&n[e]&&n[e].isNull&&(o=l=g),void 0!==o&&(f.push({plotX:k,plotY:null===o?x:c.getThreshold(o),isNull:a,isCliff:!0}),p.push({plotX:k,plotY:null===l?x:c.getThreshold(l),doCurve:!1}))}const t=LineSeries.prototype.getGraphPath,e=this.options,h=e.stacking,c=this.yAxis,p=[],f=[],u=this.index,d=c.stacking.stacks[this.stackKey],g=e.threshold,x=Math.round(c.getThreshold(e.threshold)),s=pick(e.connectNulls,"percent"===h);let k,r,o;n=n||this.points;for(let t=0,e=(n=h?this.getStackPoints(n):n).length;t<e;++t)h||(n[t].leftCliff=n[t].rightCliff=n[t].leftNull=n[t].rightNull=void 0),r=n[t].isNull,k=pick(n[t].rectPlotX,n[t].plotX),o=h?pick(n[t].yBottom,x):x,r&&!s||(s||i(t,t-1,"left"),r&&!h&&s||(f.push(n[t]),p.push({x:t,plotX:k,plotY:o})),s||i(t,t+1,"right"));const l=t.call(this,f,!0,!0),a=(p.reversed=!0,t.call(this,p,!0,!0));var S=a[0];S&&"M"===S[0]&&(a[0]=["L",S[1],S[2]]);const y=l.concat(a);y.length&&y.push(["Z"]);S=t.call(this,f,!1,s);return y.xMap=l.xMap,this.areaPath=y,S}getStackPoints(e){const c=this,s=[],p=[],r=this.xAxis,o=this.yAxis,f=o.stacking.stacks[this.stackKey],u={},d=o.series,g=d.length,x=o.options.reversedStacks?1:-1,k=d.indexOf(c);if(e=e||this.points,this.options.stacking){for(let t=0;t<e.length;t++)e[t].leftNull=e[t].rightNull=void 0,u[e[t].x]=e[t];objectEach(f,function(t,e){null!==t.total&&p.push(e)}),p.sort(function(t,e){return t-e});const S=d.map(t=>t.visible);p.forEach(function(l,a){let e=0,n,h;if(u[l]&&!u[l].isNull)s.push(u[l]),[-1,1].forEach(function(t){var e=1===t?"rightNull":"leftNull",i=1===t?"rightCliff":"leftCliff",s=f[p[a+t]];let r=0;if(s){let t=k;for(;0<=t&&t<g;){var o=d[t].index;(n=s.points[o])||(o===c.index?u[l][e]=!0:S[t]&&(h=f[l].points[o])&&(r-=h[1]-h[0])),t+=x}}u[l][i]=r});else{let t=k;for(;0<=t&&t<g;){var i=d[t].index;if(n=f[l].points[i]){e=n[1];break}t+=x}e=pick(e,0),e=o.translate(e,0,1,0,1),s.push({isNull:!0,plotX:r.translate(l,0,0,0,1),x:l,plotY:e,yBottom:e})}})}return s}}AreaSeries.defaultOptions=merge(LineSeries.defaultOptions,{threshold:0,legendSymbol:"rectangle"}),extend(AreaSeries.prototype,{singleStacks:!1}),SeriesRegistry.registerSeriesType("area",AreaSeries);export default AreaSeries;