"use strict";import AreaRangePoint from"./AreaRangePoint.js";import H from"../../Core/Globals.js";const noop=H["noop"];import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";const{area:AreaSeries,area:{prototype:areaProto},column:{prototype:columnProto}}=SeriesRegistry.seriesTypes;import U from"../../Core/Utilities.js";const{addEvent,defined,extend,isArray,isNumber,pick,merge}=U,areaRangeSeriesOptions={lineWidth:1,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">‚óè</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0,dataLabels:{align:void 0,verticalAlign:void 0,xLow:0,xHigh:0,yLow:0,yHigh:0}};class AreaRangeSeries extends AreaSeries{constructor(){super(...arguments),this.data=void 0,this.options=void 0,this.points=void 0,this.lowerStateMarkerGraphic=void 0,this.xAxis=void 0}toYData(t){return[t.low,t.high]}highToXY(t){var o=this.chart,a=this.xAxis.postTranslate(t.rectPlotX||0,this.yAxis.len-(t.plotHigh||0));t.plotHighX=a.x-o.plotLeft,t.plotHigh=a.y-o.plotTop,t.plotLowX=t.plotX}getGraphPath(t){const o=[],a=[],e=areaProto.getGraphPath,i=this.options,r=this.chart.polar,s=r&&!1!==i.connectEnds,l=i.connectNulls;let p,n,h,g=i.step;for(t=t||this.points,p=t.length;p--;){n=t[p];var d=r?{plotX:n.rectPlotX,plotY:n.yBottom,doCurve:!1}:{plotX:n.plotX,plotY:n.plotY,doCurve:!1};n.isNull||s||l||t[p+1]&&!t[p+1].isNull||a.push(d),h={polarPlotY:n.polarPlotY,rectPlotX:n.rectPlotX,yBottom:n.yBottom,plotX:pick(n.plotHighX,n.plotX),plotY:n.plotHigh,isNull:n.isNull},a.push(h),o.push(h),n.isNull||s||l||t[p-1]&&!t[p-1].isNull||a.push(d)}const c=e.call(this,t);g&&(!0===g&&(g="left"),i.step={left:"right",center:"center",right:"left"}[g]);var y=e.call(this,o);const b=e.call(this,a),f=(i.step=g,[].concat(c,y));return!this.chart.polar&&b[0]&&"M"===b[0][0]&&(b[0]=["L",b[0][1],b[0][2]]),this.graphPath=f,this.areaPath=c.concat(b),f.isArea=!0,f.xMap=c.xMap,this.areaPath.xMap=c.xMap,f}drawDataLabels(){const t=this.points,o=t.length,a=[],e=this.options.dataLabels,i=this.chart.inverted;let r,s,l,p,n;if(e){if(isArray(e)?(p=e[0]||{enabled:!1},n=e[1]||{enabled:!1}):((p=extend({},e)).x=e.xHigh,p.y=e.yHigh,(n=extend({},e)).x=e.xLow,n.y=e.yLow),p.enabled||this._hasPointLabels){for(r=o;r--;){var h,g;(s=t[r])&&({plotHigh:h=0,plotLow:g=0}=s,l=p.inside?h<g:g<h,s.y=s.high,s._plotY=s.plotY,s.plotY=h,a[r]=s.dataLabel,s.dataLabel=s.dataLabelUpper,s.below=l,i?p.align||(p.align=l?"right":"left"):p.verticalAlign||(p.verticalAlign=l?"top":"bottom"))}for(this.options.dataLabels=p,areaProto.drawDataLabels&&areaProto.drawDataLabels.apply(this,arguments),r=o;r--;)(s=t[r])&&(s.dataLabelUpper=s.dataLabel,s.dataLabel=a[r],delete s.dataLabels,s.y=s.low,s.plotY=s._plotY)}if(n.enabled||this._hasPointLabels){for(r=o;r--;){var d,c;(s=t[r])&&({plotHigh:d=0,plotLow:c=0}=s,l=n.inside?d<c:c<d,s.below=!l,i?n.align||(n.align=l?"left":"right"):n.verticalAlign||(n.verticalAlign=l?"bottom":"top"))}this.options.dataLabels=n,areaProto.drawDataLabels&&areaProto.drawDataLabels.apply(this,arguments)}if(p.enabled)for(r=o;r--;)(s=t[r])&&(s.dataLabels=[s.dataLabelUpper,s.dataLabel].filter(function(t){return!!t}));this.options.dataLabels=e}}alignDataLabel(){columnProto.alignDataLabel.apply(this,arguments)}drawPoints(){var t=this,o=t.points.length;let a,e;for(areaProto.drawPoints.apply(t,arguments),a=0;a<o;)(e=t.points[a]).graphics=e.graphics||[],e.origProps={plotY:e.plotY,plotX:e.plotX,isInside:e.isInside,negative:e.negative,zone:e.zone,y:e.y},(e.graphic||e.graphics[0])&&(e.graphics[0]=e.graphic),e.graphic=e.graphics[1],e.plotY=e.plotHigh,defined(e.plotHighX)&&(e.plotX=e.plotHighX),e.y=pick(e.high,e.origProps.y),e.negative=e.y<(t.options.threshold||0),t.zones.length&&(e.zone=e.getZone()),t.chart.polar||(e.isInside=e.isTopInside=void 0!==e.plotY&&0<=e.plotY&&e.plotY<=t.yAxis.len&&0<=e.plotX&&e.plotX<=t.xAxis.len),a++;for(areaProto.drawPoints.apply(t,arguments),a=0;a<o;)(e=t.points[a]).graphics=e.graphics||[],(e.graphic||e.graphics[1])&&(e.graphics[1]=e.graphic),e.graphic=e.graphics[0],e.origProps&&(extend(e,e.origProps),delete e.origProps),a++}}AreaRangeSeries.defaultOptions=merge(AreaSeries.defaultOptions,areaRangeSeriesOptions),addEvent(AreaRangeSeries,"afterTranslate",function(){"low,high"===this.pointArrayMap.join(",")&&this.points.forEach(t=>{var o=t.high,a=t.plotY;t.isNull?t.plotY=void 0:(t.plotLow=a,t.plotHigh=isNumber(o)?this.yAxis.translate(this.dataModify?this.dataModify.modifyValue(o):o,!1,!0,void 0,!0):void 0,this.dataModify&&(t.yBottom=t.plotHigh))})},{order:0}),addEvent(AreaRangeSeries,"afterTranslate",function(){this.chart.inverted;this.points.forEach(t=>{if(this.chart.polar)this.highToXY(t),t.plotLow=t.plotY,t.tooltipPos=[((t.plotHighX||0)+(t.plotLowX||0))/2,((t.plotHigh||0)+(t.plotLow||0))/2];else{const o=t.pos(!1,t.plotLow),a=t.pos(!1,t.plotHigh);o&&a&&(o[0]=(o[0]+a[0])/2,o[1]=(o[1]+a[1])/2),t.tooltipPos=o}})},{order:3}),extend(AreaRangeSeries.prototype,{deferTranslatePolar:!0,pointArrayMap:["low","high"],pointClass:AreaRangePoint,pointValKey:"low",setStackedPoints:noop}),SeriesRegistry.registerSeriesType("arearange",AreaRangeSeries);export default AreaRangeSeries;