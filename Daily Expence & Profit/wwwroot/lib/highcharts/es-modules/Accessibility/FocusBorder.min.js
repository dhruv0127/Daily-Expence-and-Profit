"use strict";import SVGLabel from"../Core/Renderer/SVG/SVGLabel.js";import U from"../Core/Utilities.js";const{addEvent,pick}=U;var FocusBorderComposition;!function(o){const s=[],x=["x","y","transform","width","height","r","d","stroke-width"];function i(){const o=this.focusElement,e=this.options.accessibility.keyboardNavigation.focusBorder;o&&(o.removeFocusBorder(),e.enabled&&o.addFocusBorder(e.margin,{stroke:e.style.color,strokeWidth:e.style.lineWidth,r:e.style.borderRadius}))}function d(o,e){const t=this.options.accessibility.keyboardNavigation.focusBorder,r=e||o.element;r&&r.focus&&(r.hcEvents&&r.hcEvents.focusin||addEvent(r,"focusin",function(){}),r.focus(),t.hideBrowserFocusOutline&&(r.style.outline="none")),this.focusElement&&this.focusElement.removeFocusBorder(),this.focusElement=o,this.renderFocusBorder()}function c(o,e){this.focusBorder&&this.removeFocusBorder();const t=this.getBBox(),r=pick(o,3),s=this.parentGroup,i=this.scaleX||s&&s.scaleX,d=this.scaleY||s&&s.scaleY,c=i?!d:d,n=c?Math.abs(i||d||1):(Math.abs(i||1)+Math.abs(d||1))/2;t.x+=this.translateX||0,t.y+=this.translateY||0;let a=t.x-r,u=t.y-r,h=t.width+2*r,f=t.height+2*r;var l,B,p,y,k,m,v=this instanceof SVGLabel,F=("text"!==this.element.nodeName&&!v||(l=!!this.rotation,B=v?{x:l?1:0,y:0}:function(o){let e=0,t=0;return"middle"===o.attr("text-anchor")?e=t=.5:o.rotation?e=.25:t=.75,{x:e,y:t}}(this),p=+this.attr("x"),y=+this.attr("y"),isNaN(p)||(a=p-t.width*B.x-r),isNaN(y)||(u=y-t.height*B.y-r),v&&l&&(v=h,h=f,f=v,isNaN(p)||(a=p-t.height*B.x-r),isNaN(y)||(u=y-t.width*B.y-r))),this.focusBorder=this.renderer.rect(a,u,h,f,parseInt((e&&e.r||0).toString(),10)/n).addClass("highcharts-focus-border").attr({zIndex:99}).add(s),this.renderer.styledMode||this.focusBorder.attr({stroke:e&&e.stroke,"stroke-width":(e&&e.strokeWidth||0)/n}),m=[o,e],(k=this).focusBorderUpdateHooks||(k.focusBorderUpdateHooks={},x.forEach(o=>{o+="Setter";const e=k[o]||k._defaultSetter;k.focusBorderUpdateHooks[o]=e,k[o]=function(){var o=e.apply(k,arguments);return k.addFocusBorder.apply(k,m),o}})),this);if(!F.focusBorderDestroyHook){const b=F.destroy;F.destroy=function(){return F.focusBorder&&F.focusBorder.destroy&&F.focusBorder.destroy(),b.apply(F,arguments)},F.focusBorderDestroyHook=b}}function n(){var t,o;(t=this).focusBorderUpdateHooks&&(Object.keys(t.focusBorderUpdateHooks).forEach(o=>{var e=t.focusBorderUpdateHooks[o];e===t._defaultSetter?delete t[o]:t[o]=e}),delete t.focusBorderUpdateHooks),(o=this).focusBorderDestroyHook&&(o.destroy=o.focusBorderDestroyHook,delete o.focusBorderDestroyHook),this.focusBorder&&(this.focusBorder.destroy(),delete this.focusBorder)}o.compose=function(o,e){if(U.pushUnique(s,o)){const t=o.prototype;t.renderFocusBorder=i,t.setFocusToElement=d}if(U.pushUnique(s,e)){const r=e.prototype;r.addFocusBorder=c,r.removeFocusBorder=n}}}(FocusBorderComposition=FocusBorderComposition||{});export default FocusBorderComposition;