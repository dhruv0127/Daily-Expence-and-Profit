!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){"use strict";t=t?t._modules:{};function e(t,e,n,a){t.hasOwnProperty(e)||(t[e]=a.apply(null,n),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t,"Extensions/ExportData/ExportDataDefaults.js",[],function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}}),e(t,"Extensions/DownloadURL.js",[t["Core/Globals.js"]],function(t){const r=t["isSafari"],l=t.win,c=l.document,o=l.URL||l.webkitURL||l,d=t.dataURLtoBlob=function(t){t=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(t&&3<t.length&&l.atob&&l.ArrayBuffer&&l.Uint8Array&&l.Blob&&o.createObjectURL){const e=l.atob(t[3]),n=new l.ArrayBuffer(e.length),a=new l.Uint8Array(n);for(let t=0;t<a.length;++t)a[t]=e.charCodeAt(t);t=new l.Blob([a],{type:t[1]});return o.createObjectURL(t)}};t=t.downloadURL=function(e,t){const n=l.navigator,a=c.createElement("a");if("string"==typeof e||e instanceof String||!n.msSaveOrOpenBlob){e=""+e;var o=/Edge\/\d+/.test(n.userAgent),i=r&&"string"==typeof e&&0===e.indexOf("data:application/pdf");if((i||o||2e6<e.length)&&!(e=d(e)||""))throw new Error("Failed to convert to blob");if(void 0!==a.download)a.href=e,a.download=t,c.body.appendChild(a),a.click(),c.body.removeChild(a);else try{var s=l.open(e,"chart");if(null==s)throw new Error("Failed to open window")}catch(t){l.location.href=e}}else n.msSaveOrOpenBlob(e,t)};return{dataURLtoBlob:d,downloadURL:t}}),e(t,"Extensions/ExportData/ExportData.js",[t["Core/Renderer/HTML/AST.js"],t["Extensions/ExportData/ExportDataDefaults.js"],t["Core/Globals.js"],t["Core/Defaults.js"],t["Extensions/DownloadURL.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(c,a,t,e,n,o,i){const{doc:d,win:s}=t,{getOptions:r,setOptions:l}=e,h=n["downloadURL"],{series:g,seriesTypes:{arearange:p,gantt:u,map:f,mapbubble:m,treemap:x}}=o,{addEvent:b,defined:S,extend:y,find:C,fireEvent:L,isNumber:A,pick:O}=i,w=[];function D(){var t=this.getCSV(!0);h(H(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")}function v(){var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";h(H(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+(t=t,s.btoa(unescape(encodeURIComponent(t)))),this.getFilename()+".xls")}function T(t){let o="";const i=this.getDataRows(),e=this.options.exporting.csv,s=O(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),r=O(e.itemDelimiter,","===s?";":","),l=e.lineDelimiter;return i.forEach((t,e)=>{let n="",a=t.length;for(;a--;)"number"==typeof(n="string"==typeof(n=t[a])?'"'+n+'"':n)&&"."!==s&&(n=n.toString().replace(".",s)),t[a]=n;t.length=i.length?i[0].length:0,o+=t.join(r),e<i.length-1&&(o+=l)}),o}function E(o){function e(t,e,n){if(w.columnHeaderFormatter){var a=w.columnHeaderFormatter(t,e,n);if(!1!==a)return a}return t?t instanceof g?o?{columnTitle:1<n?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<n?" ("+e+")":""):t.options.title&&t.options.title.text||(t.dateTime?c:l):l}function x(n,t,a){const o={},i={};return t.forEach(function(t){var e=(n.keyToAxis&&n.keyToAxis[t]||t)+"Axis",e=A(a)?n.chart[e][a]:n[e];o[t]=e&&e.categories||[],i[t]=e&&e.dateTime}),{categoryMap:o,dateTimeValueAxisMap:i}}const b=this.hasParallelCoordinates,y=this.time,w=this.options.exporting&&this.options.exporting.csv||{},n=this.xAxis,D={},t=[],a=[],i=[],s=this.options.lang,r=s.exportData,l=r.categoryHeader,c=r.categoryDatetimeHeader,v=[];let d,h,T,E=0,p,u;for(p in this.series.forEach(function(l){const t=l.options.keys,c=l.xAxis,d=t||function(t,e){if(!t.data.filter(t=>void 0!==t.y&&t.name).length||!e||e.categories||t.keyToAxis)return t.pointArrayMap||["y"];if(t.pointArrayMap&&t.pointArrayMap.filter(t=>"x"===t).length)return t.pointArrayMap.unshift("x"),t.pointArrayMap;return["x","y"]}(l,c),h=d.length,p=!l.requireSorting&&{},u=n.indexOf(c);let f=x(l,d),m,g;if(!1!==l.options.includeInDataExport&&!l.options.isInternal&&!1!==l.visible){for(C(v,function(t){return t[0]===u})||v.push([u,E]),g=0;g<h;)T=e(l,d[g],d.length),i.push(T.columnTitle||T),o&&a.push(T.topLevelColumnTitle||T),g++;m={chart:l.chart,autoIncrement:l.autoIncrement,options:l.options,pointArrayMap:l.pointArrayMap,index:l.index},l.options.data.forEach(function(t,e){var n={series:m};let a,o,i;if(b&&(f=x(l,d,e)),l.pointClass.prototype.applyOptions.apply(n,[t]),a=n.x,S(D[a])&&D[a].seriesIndices.includes(m.index)){const s=Object.keys(D).filter(t=>D[t].seriesIndices.includes(m.index)&&a),r=s.filter(t=>0===t.indexOf(String(a)));a=a.toString()+","+r.length}t=l.data[e]&&l.data[e].name;for(g=0,(!c||"name"===l.exportKey||!b&&c&&c.hasNames&&t)&&(a=t),p&&(p[a]&&(a+="|"+e),p[a]=!0),D[a]||(D[a]=[],D[a].xValues=[]),D[a].x=n.x,D[a].name=t,D[a].xValues[u]=n.x,S(D[a].seriesIndices)||(D[a].seriesIndices=[]),D[a].seriesIndices=[...D[a].seriesIndices,m.index];g<h;)i=n[o=d[g]],D[a][E+g]=O(f.categoryMap[o][i],f.dateTimeValueAxisMap[o]?y.dateFormat(w.dateFormat,i):null,i),g++}),E+=g}}),D)Object.hasOwnProperty.call(D,p)&&t.push(D[p]);let f,m;for(h=o?[a,i]:[i],E=v.length;E--;)f=v[E][0],m=v[E][1],d=n[f],t.sort(function(t,e){return t.xValues[f]-e.xValues[f]}),u=e(d),h[0].splice(m,0,u),o&&h[1]&&h[1].splice(m,0,u),t.forEach(function(t){let e=t.name;d&&!S(e)&&(e=d.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),y.dateFormat(w.dateFormat,t.x)):d.categories?O(d.names[t.x],d.categories[t.x],t.x):t.x),t.splice(m,0,e)});return h=h.concat(t),L(this,"exportData",{dataRows:h}),h}function k(t){const e=t=>{if(!t.tagName||"#text"===t.tagName)return t.textContent||"";const n=t.attributes;let a="<"+t.tagName;return n&&Object.keys(n).forEach(t=>{var e=n[t];a+=` ${t}="${e}"`}),a=(a+=">")+(t.textContent||""),(t.children||[]).forEach(t=>{a+=e(t)}),a+=`</${t.tagName}>`};t=this.getTableAST(t);return e(t)}function U(t){let a=0;const e=[],p=this.options,s=t?1.1.toLocaleString()[1]:".",u=O(p.exporting.useMultiLevelHeaders,!0),n=this.getDataRows(u),o=u?n.shift():null,i=n.shift(),f=function(t,e){let n=t.length;if(e.length!==n)return!1;for(;n--;)if(t[n]!==e[n])return!1;return!0},m=function(t,e,n,a){let o=O(a,""),i="highcharts-text"+(e?" "+e:"");return"number"==typeof o?(o=o.toString(),","===s&&(o=o.replace(".",s)),i="highcharts-number"):a||(i="highcharts-empty"),{tagName:t,attributes:n=y({class:i},n),textContent:o}};!1!==p.exporting.tableCaption&&e.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:O(p.exporting.tableCaption,p.title.text||"Chart")});for(let t=0,e=n.length;t<e;++t)n[t].length>a&&(a=n[t].length);e.push(function(t,e,n){const a=[];let o=0,i=n||e&&e.length,s,r=0,l;if(u&&t&&e&&!f(t,e)){const c=[];for(;o<i;++o)if((s=t[o])===t[o+1])++r;else if(r)c.push(m("th","highcharts-table-topheading",{scope:"col",colspan:r+1},s)),r=0;else{s===e[o]?p.exporting.useRowspanHeaders?(l=2,delete e[o]):(l=1,e[o]=""):l=1;const d=m("th","highcharts-table-topheading",{scope:"col"},s);1<l&&d.attributes&&(d.attributes.valign="top",d.attributes.rowspan=l),c.push(d)}a.push({tagName:"tr",children:c})}if(e){const h=[];for(o=0,i=e.length;o<i;++o)void 0!==e[o]&&h.push(m("th",null,{scope:"col"},e[o]));a.push({tagName:"tr",children:h})}return{tagName:"thead",children:a}}(o,i,Math.max(a,i.length)));const r=[];n.forEach(function(e){const n=[];for(let t=0;t<a;t++)n.push(m(t?"td":"th",null,t?{}:{scope:"row"},e[t]));r.push({tagName:"tr",children:n})}),e.push({tagName:"tbody",children:r});t={tree:{tagName:"table",id:"highcharts-data-table-"+this.index,children:e}};return L(this,"aftergetTableAST",t),t.tree}function R(){this.toggleDataTable(!1)}function N(t){var e=(t=O(t,!this.isDataTableVisible))&&!this.dataTableDiv;if(e&&(this.dataTableDiv=d.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv){const s=this.dataTableDiv.style,r=s.display;if(s.display=t?"block":"none",t){this.dataTableDiv.innerHTML=c.emptyHTML;const l=new c([this.getTableAST()]);l.addToDOM(this.dataTableDiv),L(this,"afterViewData",{element:this.dataTableDiv,wasHidden:e||r!==s.display})}}this.isDataTableVisible=t;const n=this.exportDivElements,a=this.options.exporting,o=a&&a.buttons&&a.buttons.contextButton.menuItems,i=this.options.lang;a&&a.menuItemDefinitions&&i&&i.viewData&&i.hideData&&o&&n&&((e=n[o.indexOf("viewData")])&&c.setElementHTML(e,this.isDataTableVisible?i.hideData:i.viewData))}function j(){this.toggleDataTable(!0)}function H(t,e){const n=s.navigator,a=-1<n.userAgent.indexOf("WebKit")&&n.userAgent.indexOf("Chrome")<0,o=s.URL||s.webkitURL||s;try{if(n.msSaveOrOpenBlob&&s.MSBlobBuilder){const i=new s.MSBlobBuilder;return i.append(t),i.getBlob("image/svg+xml")}if(!a)return o.createObjectURL(new s.Blob(["\ufeff"+t],{type:e}))}catch(t){}}function M(){const o=this,i=o.dataTableDiv,s=(t,e)=>t.children[e].textContent,r=(a,o)=>(t,e)=>{var n;return n=s(o?t:e,a),e=s(o?e:t,a),""===n||""===e||isNaN(n)||isNaN(e)?n.toString().localeCompare(e):n-e};if(i&&o.options.exporting&&o.options.exporting.allowTableSorting){const t=i.querySelector("thead tr");t&&t.childNodes.forEach(n=>{const a=n.closest("table");n.addEventListener("click",function(){const t=[...i.querySelectorAll("tr:not(thead tr)")],e=[...n.parentNode.children];t.sort(r(e.indexOf(n),o.ascendingOrderInTable=!o.ascendingOrderInTable)).forEach(t=>{a.appendChild(t)}),e.forEach(e=>{["highcharts-sort-ascending","highcharts-sort-descending"].forEach(t=>{e.classList.contains(t)&&e.classList.remove(t)})}),n.classList.add(o.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}}function I(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}return{compose:function(t){if(i.pushUnique(w,t)){b(t,"afterViewData",M),b(t,"render",I);const e=t.prototype;e.downloadCSV=D,e.downloadXLS=v,e.getCSV=T,e.getDataRows=E,e.getTable=k,e.getTableAST=U,e.hideData=R,e.toggleDataTable=N,e.viewData=j}if(i.pushUnique(w,l)){const n=r().exporting;n&&(y(n.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),n.buttons&&n.buttons.contextButton.menuItems&&n.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),l(a)}p&&i.pushUnique(w,p)&&(p.prototype.keyToAxis={low:"y",high:"y"}),u&&i.pushUnique(w,u)&&(u.prototype.keyToAxis={start:"x",end:"x"}),f&&i.pushUnique(w,f)&&(f.prototype.exportKey="name"),m&&i.pushUnique(w,m)&&(m.prototype.exportKey="name"),x&&i.pushUnique(w,x)&&(x.prototype.exportKey="name")}}}),e(t,"masters/modules/export-data.src.js",[t["Core/Globals.js"],t["Extensions/ExportData/ExportData.js"]],function(t,e){e.compose(t.Chart)})});