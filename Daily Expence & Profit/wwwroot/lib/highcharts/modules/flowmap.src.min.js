!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/flowmap",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){"use strict";t=t?t._modules:{};function e(t,e,o,i){t.hasOwnProperty(e)||(t[e]=i.apply(null,o),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t,"Series/FlowMap/FlowMapPoint.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e){var{prototype:{pointClass:t}}=t["seriesTypes"]["mapline"];const{pick:o,isString:i,isNumber:s}=e;class r extends t{constructor(){super(...arguments),this.options=void 0,this.series=void 0}isValid(){let e=!(!this.options.to||!this.options.from);return[this.options.to,this.options.from].forEach(function(t){e=!!(e&&t&&(i(t)||s(o(t[0],t.lat))&&s(o(t[1],t.lon))))}),e}}return r}),e(t,"Series/ColorMapComposition.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,o){const e=t.seriesTypes["column"]["prototype"],{addEvent:i,defined:s}=o;var r;{t=r=r||{};const a=[];function n(t){var e=this;e.moveToTopOnHover&&e.graphic&&e.graphic.attr({zIndex:t&&"hover"===t.state?1:0})}t.pointMembers={dataLabelOnNull:!0,moveToTopOnHover:!0,isValid:function(){return null!==this.value&&this.value!==1/0&&this.value!==-1/0&&(void 0===this.value||!isNaN(this.value))}},t.seriesMembers={colorKey:"value",axisTypes:["xAxis","yAxis","colorAxis"],parallelArrays:["x","y","value"],pointArrayMap:["value"],trackerGroups:["group","markerGroup","dataLabelsGroup"],colorAttribs:function(t){const e={};!s(t.color)||t.state&&"normal"!==t.state||(e[this.colorProp||"fill"]=t.color);return e},pointAttribs:e.pointAttribs},t.compose=function(t){var e=t.prototype.pointClass;return o.pushUnique(a,e)&&i(e,"afterSetState",n),t}}return r}),e(t,"Maps/MapSymbols.js",[t["Core/Renderer/SVG/SVGRenderer.js"]],function(t){const{symbols:n}=t["prototype"];return n.bottombutton=function(t,e,o,i,s){var r;return s&&(r=(null==s?void 0:s.r)||0,s.brBoxY=e-r,s.brBoxHeight=i+r),n.roundedRect(t,e,o,i,s)},n.topbutton=function(t,e,o,i,s){var r;return s&&(r=(null==s?void 0:s.r)||0,s.brBoxHeight=i+r),n.roundedRect(t,e,o,i,s)},n}),e(t,"Core/Chart/MapChart.js",[t["Core/Chart/Chart.js"],t["Core/Defaults.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Utilities.js"]],function(t,e,i,o){const s=e["getOptions"],{merge:r,pick:n}=o;class a extends t{init(t,e){var o=s().credits,o=r({chart:{panning:{enabled:!0,type:"xy"},type:"map"},credits:{mapText:n(o.mapText,' © <a href="{geojson.copyrightUrl}">{geojson.copyrightShort}</a>'),mapTextFull:n(o.mapTextFull,"{geojson.copyright}")},mapView:{},tooltip:{followTouchMove:!1}},t);super.init(o,e)}}var h;return(h=a=a||{}).maps={},h.mapChart=function(t,e,o){return new h(t,e,o)},h.splitPath=function(t){let e;if("string"==typeof t){const o=(t=t.replace(/([A-Za-z])/g," $1 ").replace(/^\s*/,"").replace(/\s*$/,"")).split(/[ ,;]+/);e=o.map(t=>/[A-za-z]/.test(t)?t:parseFloat(t))}else e=t;return i.prototype.pathToSegments(e)},a}),e(t,"Maps/MapUtilities.js",[],function(){return{boundsFromPath:function(t){let o=-Number.MAX_VALUE,i=Number.MAX_VALUE,s=-Number.MAX_VALUE,r=Number.MAX_VALUE,n;if(t.forEach(t=>{var e=t[t.length-2],t=t[t.length-1];"number"==typeof e&&"number"==typeof t&&(i=Math.min(i,e),o=Math.max(o,e),r=Math.min(r,t),s=Math.max(s,t),n=!0)}),n)return{x1:i,y1:r,x2:o,y2:s}},pointInPolygon:function(t,e){let o,i,s=!1,r=t.x,n=t.y;for(o=0,i=e.length-1;o<e.length;i=o++)e[o][1]>n!=e[i][1]>n&&r<(e[i][0]-e[o][0])*(n-e[o][1])/(e[i][1]-e[o][1])+e[o][0]&&(s=!s);return s}}}),e(t,"Series/Map/MapPoint.js",[t["Series/ColorMapComposition.js"],t["Maps/MapUtilities.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e,o,i){const a=e["boundsFromPath"];var e=o["seriesTypes"]["scatter"];const{extend:r,isNumber:h,pick:p}=i;class l extends e.prototype.pointClass{constructor(){super(...arguments),this.options=void 0,this.path=void 0,this.series=void 0}static getProjectedPath(t,e){return t.projectedPath||(e&&t.geometry?(e.hasCoordinates=!0,t.projectedPath=e.path(t.geometry)):t.projectedPath=t.path),t.projectedPath||[]}applyOptions(t,e){const o=this.series,i=super.applyOptions.call(this,t,e),s=o.joinBy;return o.mapData&&o.mapMap&&(t=s[1],(t=void 0!==(e=super.getNestedProperty.call(i,t))&&o.mapMap[e])?r(i,t):-1!==o.pointArrayMap.indexOf("value")&&(i.value=i.value||null)),i}getProjectedBounds(t){const e=l.getProjectedPath(this,t),o=a(e),i=this.properties,s=this.series.chart.mapView;if(o){var r=i&&i["hc-middle-lon"],n=i&&i["hc-middle-lat"];if(s&&h(r)&&h(n)){t=t.forward([r,n]);o.midX=t[0],o.midY=t[1]}else{r=i&&i["hc-middle-x"],n=i&&i["hc-middle-y"];o.midX=o.x1+(o.x2-o.x1)*p(this.middleX,h(r)?r:.5);let t=p(this.middleY,h(n)?n:.5);this.geometry||(t=1-t),o.midY=o.y2-(o.y2-o.y1)*t}return o}}onMouseOver(t){i.clearTimeout(this.colorInterval),!this.isNull&&this.visible||this.series.options.nullInteraction?super.onMouseOver.call(this,t):this.series.onMouseOut(t)}setVisible(t){var e=t?"show":"hide";this.visible=this.options.visible=!!t,this.dataLabel&&this.dataLabel[e](),this.graphic&&this.graphic.attr(this.series.pointAttribs(this))}zoomTo(t){const e=this,o=e.series.chart,i=o.mapView;let s=e.bounds;if(i&&s){const a=h(e.insetIndex)&&i.insets[e.insetIndex];var r,n;a&&(r=a.projectedUnitsToPixels({x:s.x1,y:s.y1}),n=a.projectedUnitsToPixels({x:s.x2,y:s.y2}),r=i.pixelsToProjectedUnits({x:r.x,y:r.y}),n=i.pixelsToProjectedUnits({x:n.x,y:n.y}),s={x1:r.x,y1:r.y,x2:n.x,y2:n.y}),i.fitToBounds(s,void 0,!1),e.series.isDirty=!0,o.redraw(t)}}}return r(l.prototype,{dataLabelOnNull:t.pointMembers.dataLabelOnNull,moveToTopOnHover:t.pointMembers.moveToTopOnHover,isValid:t.pointMembers.isValid}),l}),e(t,"Maps/MapViewOptionsDefault.js",[],function(){return{center:[0,0],fitToGeometry:void 0,maxZoom:void 0,padding:0,projection:{name:void 0,parallels:void 0,rotation:void 0},zoom:void 0}}),e(t,"Maps/MapViewInsetsOptionsDefault.js",[],function(){return{borderColor:"#cccccc",borderWidth:1,center:[0,0],padding:"10%",relativeTo:"mapBoundingBox",units:"percent"}}),e(t,"Extensions/GeoJSON.js",[t["Core/Chart/Chart.js"],t["Core/FormatUtilities.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(t,e,o,i){const s=e["format"],u=o["win"],{error:m,extend:a,merge:r,wrap:n}=i;function h(t,e){e=e||Object.keys(t.objects)[0];const o=t.objects[e];if(o["hc-decoded-geojson"])return o["hc-decoded-geojson"];let s=t.arcs;if(t.transform){const{scale:r,translate:n}=t.transform;s=t.arcs.map(t=>{let e=0,o=0;return t.map(t=>((t=t.slice())[0]=(e+=t[0])*r[0]+n[0],t[1]=(o+=t[1])*r[1]+n[1],t))})}const i=t=>"number"==typeof t[0]?t.reduce((t,e,o)=>{let i=e<0?s[~e]:s[e];return e<0?(i=i.slice(0,0===o?i.length:i.length-1)).reverse():o&&(i=i.slice(1)),t.concat(i)},[]):t.map(i);e=o.geometries.map(t=>({type:"Feature",properties:t.properties,geometry:{type:t.type,coordinates:t.coordinates||i(t.arcs)}})),e={type:"FeatureCollection",copyright:t.copyright,copyrightShort:t.copyrightShort,copyrightUrl:t.copyrightUrl,features:e,"hc-recommended-mapview":o["hc-recommended-mapview"],bbox:t.bbox,title:t.title};return o["hc-decoded-geojson"]=e}function p(t,r="map",e){const n=[],o="Topology"===t.type?h(t):t;return o.features.forEach(function(t){var e,o=t.geometry||{},i=o.type,o=o.coordinates,t=t.properties;let s;("map"!==r&&"mapbubble"!==r||"Polygon"!==i&&"MultiPolygon"!==i)&&("mapline"!==r||"LineString"!==i&&"MultiLineString"!==i)?"mappoint"===r&&"Point"===i&&o.length&&(s={geometry:{coordinates:o,type:i}}):o.length&&(s={geometry:{coordinates:o,type:i}}),s&&(o=t&&(t.name||t.NAME),i=t&&t.lon,e=t&&t.lat,n.push(a(s,{lat:"number"==typeof e?e:void 0,lon:"number"==typeof i?i:void 0,name:"string"==typeof o?o:void 0,properties:t})))}),e&&o.copyrightShort&&(e.chart.mapCredits=s(e.chart.options.credits.mapText,{geojson:o}),e.chart.mapCreditsFull=s(e.chart.options.credits.mapTextFull,{geojson:o})),n}return t.prototype.transformFromLatLon=function(t,e){const o=this.options.chart.proj4||u.proj4;var i,s,r,n,a,h,p,l,c,d;{if(o)return{jsonmarginX:i=0,jsonmarginY:s=0,jsonres:r=1,scale:n=1,xoffset:a=0,xpan:h=0,yoffset:p=0,ypan:l=0}=e,t=o(e.crs,[t.lon,t.lat]),c=e.cosAngle||e.rotation&&Math.cos(e.rotation),d=e.sinAngle||e.rotation&&Math.sin(e.rotation),{x:(((e=e.rotation?[t[0]*c+t[1]*d,-t[0]*d+t[1]*c]:t)[0]-a)*n+h)*r+i,y:-(((p-e[1])*n+l)*r-s)};m(21,!1,this)}},t.prototype.transformToLatLon=function(t,e){const o=this.options.chart.proj4||u.proj4;var i,s,r,n,a,h,p,l;if(o){if(null!==t.y)return{jsonmarginX:h=0,jsonmarginY:i=0,jsonres:s=1,scale:r=1,xoffset:l=0,xpan:p=0,yoffset:n=0,ypan:a=0}=e,h={x:((t.x-h)/s-p)/r+l,y:((t.y-i)/s+a)/r+n},p=e.cosAngle||e.rotation&&Math.cos(e.rotation),l=e.sinAngle||e.rotation&&Math.sin(e.rotation),{lat:(t=o(e.crs,"WGS84",e.rotation?{x:h.x*p+h.y*-l,y:h.x*l+h.y*p}:h)).y,lon:t.x}}else m(21,!1,this)},t.prototype.fromPointToLatLon=function(t){return this.mapView&&this.mapView.projectedUnitsToLonLat(t)},t.prototype.fromLatLonToPoint=function(t){return this.mapView&&this.mapView.lonLatToProjectedUnits(t)},n(t.prototype,"addCredits",function(t,e){e=r(!0,this.options.credits,e),this.mapCredits&&(e.href=null),t.call(this,e),this.credits&&this.mapCreditsFull&&this.credits.attr({title:this.mapCreditsFull})}),{geojson:o.geojson=p,topo2geo:o.topo2geo=h}}),e(t,"Core/Geometry/PolygonClip.js",[],function(){const p=(t,e,o)=>(e[0]-t[0])*(o[1]-t[1])>(e[1]-t[1])*(o[0]-t[0]),l=(t,e,o,i)=>{const s=[t[0]-e[0],t[1]-e[1]],r=[o[0]-i[0],o[1]-i[1]],n=t[0]*e[1]-t[1]*e[0],a=o[0]*i[1]-o[1]*i[0],h=1/(s[0]*r[1]-s[1]*r[0]),p=[(n*r[0]-a*s[0])*h,(n*r[1]-a*s[1])*h];return p.isIntersection=!0,p};var t,s;return(s=t=t||{}).clipLineString=(t,e)=>{const o=[],i=s.clipPolygon(t,e,!1);for(let t=1;t<i.length;t++)i[t].isIntersection&&i[t-1].isIntersection&&(o.push(i.splice(0,t)),t=0),t===i.length-1&&o.push(i);return o},s.clipPolygon=(t,e,o=!0)=>{let i=e[e.length-1],s,r,n,a=t;for(let t=0;t<e.length;t++){var h=a;s=e[t],a=[],r=o?h[h.length-1]:h[0];for(let t=0;t<h.length;t++)n=h[t],p(i,s,n)?(p(i,s,r)||a.push(l(i,s,r,n)),a.push(n)):p(i,s,r)&&a.push(l(i,s,r,n)),r=n;i=s}return a},t}),e(t,"Maps/Projections/LambertConformalConic.js",[],function(){const n=Math.sign||(t=>0===t?0:0<t?1:-1),l=63.78137,c=Math.PI/180,d=Math.PI/2,u=t=>Math.tan((d+t)/2);return class{constructor(t){var e=(t.parallels||[]).map(t=>t*c),o=e[0]||0,e=null!=(e=e[1])?e:o,i=Math.cos(o);"object"==typeof t.projectedBounds&&(this.projectedBounds=t.projectedBounds);let s=o===e?Math.sin(o):Math.log(i/Math.cos(e))/Math.log(u(e)/u(o));Math.abs(s)<1e-10&&(s=1e-10*(n(s)||1)),this.n=s,this.c=i*Math.pow(u(o),s)/s}forward(t){var e=t[0]*c,{c:o,n:i,projectedBounds:s}=this;let r=t[1]*c;0<o?r<1e-6-d&&(r=1e-6-d):r>d-1e-6&&(r=d-1e-6);const n=o/Math.pow(u(r),i),a=n*Math.sin(i*e)*l,h=(o-n*Math.cos(i*e))*l,p=[a,h];return s&&(a<s.x1||a>s.x2||h<s.y1||h>s.y2)&&(p.outside=!0),p}inverse(t){var e=t[0]/l,{c:o,n:i}=this,t=o-t[1]/l,s=n(i)*Math.sqrt(e*e+t*t);let r=Math.atan2(e,Math.abs(t))*n(t);return t*i<0&&(r-=Math.PI*n(e)*n(t)),[r/i/c,(2*Math.atan(Math.pow(o/s,1/i))-d)/c]}}}),e(t,"Maps/Projections/EqualEarth.js",[],function(){const l=1.340264,c=-.081106,d=893e-6,u=.003796,m=Math.sqrt(3)/2,f=74.03120656864502;return class{constructor(){this.bounds={x1:-200.37508342789243,x2:200.37508342789243,y1:-97.52595454902263,y2:97.52595454902263}}forward(t){var e=Math.PI/180,o=Math.asin(m*Math.sin(t[1]*e)),i=o*o,s=i*i*i;return[t[0]*e*Math.cos(o)*f/(m*(l+3*c*i+s*(7*d+9*u*i))),o*f*(l+c*i+s*(d+u*i))]}inverse(t){var e=t[0]/f,o=t[1]/f,t=180/Math.PI;let i=o,s,r,n,a,h,p;for(p=0;p<12&&(s=i*i,r=s*s*s,n=i*(l+c*s+r*(d+u*s))-o,a=l+3*c*s+r*(7*d+9*u*s),i-=h=n/a,!(Math.abs(h)<1e-9));++p);return s=i*i,r=s*s*s,[t*m*e*(l+3*c*s+r*(7*d+9*u*s))/Math.cos(i),t*Math.asin(Math.sin(i)/m)]}}}),e(t,"Maps/Projections/Miller.js",[],function(){const e=Math.PI/4,o=Math.PI/180,i=63.78137;return class{constructor(){this.bounds={x1:-200.37508342789243,x2:200.37508342789243,y1:-146.91480769173063,y2:146.91480769173063}}forward(t){return[t[0]*o*i,1.25*i*Math.log(Math.tan(e+.4*t[1]*o))]}inverse(t){return[t[0]/i/o,2.5*(Math.atan(Math.exp(t[1]/i*.8))-e)/o]}}}),e(t,"Maps/Projections/Orthographic.js",[],function(){const r=Math.PI/180,n=63.78460826781007;return class{constructor(){this.antimeridianCutting=!1,this.bounds={x1:-n,x2:n,y1:-n,y2:n}}forward(t){var e=t[0],t=t[1]*r;const o=[Math.cos(t)*Math.sin(e*r)*n,Math.sin(t)*n];return(e<-90||90<e)&&(o.outside=!0),o}inverse(t){var e=t[0]/n,t=t[1]/n,o=Math.sqrt(e*e+t*t),i=Math.asin(o),s=Math.sin(i),i=Math.cos(i);return[Math.atan2(e*s,o*i)/r,Math.asin(o&&t*s/o)/r]}}}),e(t,"Maps/Projections/WebMercator.js",[],function(){const i=85.0511287798,s=63.78137,r=Math.PI/180;return class{constructor(){this.bounds={x1:-200.37508342789243,x2:200.37508342789243,y1:-200.3750834278071,y2:200.3750834278071},this.maxLatitude=i}forward(t){var e=Math.sin(t[1]*r);const o=[s*t[0]*r,s*Math.log((1+e)/(1-e))/2];return Math.abs(t[1])>i&&(o.outside=!0),o}inverse(t){return[t[0]/(s*r),(2*Math.atan(Math.exp(t[1]/s))-Math.PI/2)/r]}}}),e(t,"Maps/Projections/ProjectionRegistry.js",[t["Maps/Projections/LambertConformalConic.js"],t["Maps/Projections/EqualEarth.js"],t["Maps/Projections/Miller.js"],t["Maps/Projections/Orthographic.js"],t["Maps/Projections/WebMercator.js"]],function(t,e,o,i,s){return{EqualEarth:e,LambertConformalConic:t,Miller:o,Orthographic:i,WebMercator:s}}),e(t,"Maps/Projection.js",[t["Core/Geometry/PolygonClip.js"],t["Maps/Projections/ProjectionRegistry.js"],t["Core/Utilities.js"]],function(t,e,o){const{clipLineString:x,clipPolygon:j}=t,{clamp:v,erase:b}=o,w=2*Math.PI/360,P=1e-6,T=t=>(t<-180&&(t+=360),180<t&&(t-=360),t);class C{static add(t,e){C.registry[t]=e}static greatCircle(t,e,o){const{atan2:i,cos:s,sin:r,sqrt:n}=Math;var a=t[1]*w,h=t[0]*w,p=e[1]*w,l=e[0]*w,c=p-a,d=l-h,c=r(c/2)*r(c/2)+s(a)*s(p)*r(d/2)*r(d/2),u=2*i(n(c),n(1-c)),d=Math.round(6371e3*u/5e5);const m=[];if(o&&m.push(t),1<d){var f=1/d;for(let t=f;t<.999;t+=f){var g=r((1-t)*u)/r(u),y=r(t*u)/r(u),M=g*s(a)*s(h)+y*s(p)*s(l),v=g*s(a)*r(h)+y*s(p)*r(l),g=g*r(a)+y*r(p),y=i(g,n(M*M+v*v)),g=i(v,M);m.push([g/w,y/w])}}return o&&m.push(e),m}static insertGreatCircles(t){let e=t.length-1;for(;e--;){var o;10<Math.max(Math.abs(t[e][0]-t[e+1][0]),Math.abs(t[e][1]-t[e+1][1]))&&((o=C.greatCircle(t[e],t[e+1])).length&&t.splice(e+1,0,...o))}}static toString(t){const{name:e,rotation:o}=t||{};return[e,o&&o.join(",")].join(";")}constructor(t={}){this.hasCoordinates=!1,this.hasGeoProjection=!1,this.maxLatitude=90;var{name:e,projectedBounds:o,rotation:i}=this.options=t;this.rotator=i?this.getRotator(i):void 0;const s=e?C.registry[e]:void 0,{def:r,rotator:n}=(s&&(this.def=new s(t)),this);r&&(this.maxLatitude=r.maxLatitude||90,this.hasGeoProjection=!0),n&&r?(this.forward=t=>r.forward(n.forward(t)),this.inverse=t=>n.inverse(r.inverse(t))):r?(this.forward=t=>r.forward(t),this.inverse=t=>r.inverse(t)):n&&(this.forward=n.forward,this.inverse=n.inverse),this.bounds="world"===o?r&&r.bounds:o}lineIntersectsBounds(t){var{x1:e,x2:o,y1:i,y2:s}=this.bounds||{},r=(t,e,o)=>{var i,[t,s]=t,r=e?0:1;if("number"==typeof o&&t[e]>=o!=s[e]>=o)return i=(o-t[e])/(s[e]-t[e]),i=t[r]+i*(s[r]-t[r]),e?[i,o]:[o,i]};let n,a=t[0];return((n=r(t,0,e))||(n=r(t,0,o)))&&(a=n,t[1]=n),a=(n=r(t,1,i))||(n=r(t,1,s))?n:a}getRotator(t){const s=t[0]*w,e=(t[1]||0)*w,o=(t[2]||0)*w,r=Math.cos(e),n=Math.sin(e),a=Math.cos(o),h=Math.sin(o);if(0!=s||0!=e||0!=o)return{forward:t=>{var e=t[0]*w+s,t=t[1]*w,o=Math.cos(t),i=Math.cos(e)*o,e=Math.sin(e)*o,o=Math.sin(t),t=o*r+i*n;return[Math.atan2(e*a-t*h,i*r-o*n)/w,Math.asin(t*a+e*h)/w]},inverse:t=>{var e=t[0]*w,t=t[1]*w,o=Math.cos(t),i=Math.cos(e)*o,e=Math.sin(e)*o,o=Math.sin(t),t=o*a-e*h;return[(Math.atan2(e*a+o*h,i*r+t*n)-s)/w,Math.asin(t*r-i*n)/w]}}}forward(t){return t}inverse(t){return t}cutOnAntimeridian(r,n){const a=[],e=[r];r.forEach((t,e)=>{let o=r[e-1];if(!e){if(!n)return;o=r[r.length-1]}var i=o[0],s=t[0];(i<-90||90<i)&&(s<-90||90<s)&&0<i!=0<s&&(s=v((180-(i+360)%360)/((s+360)%360-(i+360)%360),0,1),s=o[1]+s*(t[1]-o[1]),a.push({i:e,lat:s,direction:i<0?1:-1,previousLonLat:o,lonLat:t}))});let o;if(a.length)if(n){a.length%2==1&&(o=a.slice().sort((t,e)=>Math.abs(e.lat)-Math.abs(t.lat))[0],b(a,o));let t=a.length-2;for(;0<=t;){var i=a[t].i,s=T(180+a[t].direction*P),h=T(180-a[t].direction*P);const u=r.splice(i,a[t+1].i-i,...C.greatCircle([s,a[t].lat],[s,a[t+1].lat],!0));u.push(...C.greatCircle([h,a[t+1].lat],[h,a[t].lat],!0)),e.push(u),t-=2}if(o)for(let t=0;t<e.length;t++){const{direction:m,lat:f}=o,r=e[t],g=r.indexOf(o.lonLat);if(-1<g){var p=(f<0?-1:1)*this.maxLatitude,l=T(180+m*P),c=T(180-m*P);const y=C.greatCircle([l,f],[l,p],!0);for(let t=l+120*m;-180<t&&t<180;t+=120*m)y.push([t,p]);y.push(...C.greatCircle([c,p],[c,o.lat],!0)),r.splice(g,0,...y);break}}}else{let t=a.length;for(;t--;){var d=a[t].i;const M=r.splice(d,r.length,[T(180+a[t].direction*P),a[t].lat]);M.unshift([T(180-a[t].direction*P),a[t].lat]),e.push(M)}}return e}path(t){const{bounds:u,def:e,rotator:o}=this,m=[],f="Polygon"===t.type||"MultiPolygon"===t.type,g=this.hasGeoProjection,y=!e||!1!==e.antimeridianCutting,i=y?o:void 0,M=y&&e||this;let v;u&&(v=[[u.x1,u.y1],[u.x2,u.y1],[u.x2,u.y2],[u.x1,u.y2]]);const s=t=>{t=t.map(e=>{if(y){let t=(e=i?i.forward(e):e)[0];e=[t=Math.abs(t-180)<P?t<180?180-P:180+P:t,e[1]]}return e});let e=[t];g&&(C.insertGreatCircles(t),y&&(e=this.cutOnAntimeridian(t,f))),e.forEach(h=>{if(!(h.length<2)){let e=!1,o,i,s=!1;const c=t=>{e?m.push(["L",t[0],t[1]]):(m.push(["M",t[0],t[1]]),e=!0)};let r=!1,n=!1,a=h.map(t=>{const e=M.forward(t);return e.outside?r=!0:n=!0,e[1]===1/0?e[1]=1e10:e[1]===-1/0&&(e[1]=-1e10),e});if(y){if(f&&a.push(a[0]),r){if(!n)return;if(v)if(f)a=j(a,v);else if(u)return void x(a,v).forEach(t=>{e=!1,t.forEach(c)})}a.forEach(c)}else for(let t=0;t<a.length;t++){var p=h[t],l=a[t];if(l.outside)s=!0;else{if(f&&!o&&(o=p,h.push(p),a.push(l)),s&&i)if(f&&g){const d=C.greatCircle(i,p);d.forEach(t=>c(M.forward(t)))}else e=!1;c(l),i=p,s=!1}}}})};return"LineString"===t.type?s(t.coordinates):"MultiLineString"===t.type?t.coordinates.forEach(t=>s(t)):"Polygon"===t.type?(t.coordinates.forEach(t=>s(t)),m.length&&m.push(["Z"])):"MultiPolygon"===t.type&&(t.coordinates.forEach(t=>{t.forEach(t=>s(t))}),m.length&&m.push(["Z"])),m}}return C.registry=e,C}),e(t,"Maps/MapView.js",[t["Maps/MapViewOptionsDefault.js"],t["Maps/MapViewInsetsOptionsDefault.js"],t["Extensions/GeoJSON.js"],t["Core/Chart/MapChart.js"],t["Maps/MapUtilities.js"],t["Maps/Projection.js"],t["Core/Utilities.js"]],function(c,i,t,e,o,d,s){const r=t["topo2geo"],n=e["maps"],{boundsFromPath:a,pointInPolygon:h}=o,{addEvent:u,clamp:m,fireEvent:g,isArray:p,isNumber:y,isObject:l,isString:f,merge:M,pick:v,relativeLength:x}=s,j=400.979322,b=(t,e)=>{var{width:e,height:o}=e,e=Math.max((t.x2-t.x1)/(e/256),(t.y2-t.y1)/(o/256));return Math.log(j/e)/Math.log(2)};class w{static mergeInsets(t,e){var o=t=>{const o={};return t.forEach((t,e)=>{o[t&&t.id||"i"+e]=t}),o};const i=M(o(t),o(e)),s=Object.keys(i).map(t=>i[t]);return s}createInsets(){const e=this.options,t=e.insets;t&&t.forEach(t=>{t=new P(this,M(e.insetOptions,t));this.insets.push(t)})}constructor(t,e){this.allowTransformAnimation=!0,this.insets=[],this.padding=[0,0,0,0],this.eventsToUnbind=[];let s,o;if(!(this instanceof P)){const p=[t.options.chart.map,...(t.options.series||[]).map(t=>t.mapData)].map(t=>this.getGeoMap(t)),l=[];p.forEach(t=>{var e,o,i;t&&(s=s||t["hc-recommended-mapview"],t.bbox&&([t,e,o,i]=t.bbox,l.push({x1:t,y1:e,x2:o,y2:i})))});var i,r=l.length&&w.compositeBounds(l);r&&({x1:r,y1:a,x2:i,y2:h}=r,o=180<i-r&&90<h-a?{name:"EqualEarth"}:{name:"LambertConformalConic",parallels:[a,h],rotation:[-(r+i)/2]}),this.geoMap=p[0]}this.userOptions=e||{};const n=M(c,{projection:o},s,e);var a=s&&s.insets,h=e&&e.insets;a&&h&&(n.insets=w.mergeInsets(a,h)),this.chart=t,this.center=n.center,this.options=n,this.projection=new d(n.projection),this.playingField=t.plotBox,this.zoom=n.zoom||0,this.createInsets(),this.eventsToUnbind.push(u(t,"afterSetChartSize",()=>{this.playingField=this.getField(),void 0!==this.minZoom&&this.minZoom!==this.zoom||(this.fitToBounds(void 0,void 0,!1),!this.chart.hasRendered&&y(this.userOptions.zoom)&&(this.zoom=this.userOptions.zoom),this.userOptions.center&&M(!0,this.center,this.userOptions.center))})),this.setUpEvents()}fitToBounds(t,e,o=!0,i){var s,r=t||this.getProjectedBounds();r&&(e=v(e,t?0:this.options.padding),s=this.getField(!1),e=p(e)?e:[e,e,e,e],this.padding=[x(e[0],s.height),x(e[1],s.width),x(e[2],s.height),x(e[3],s.width)],this.playingField=this.getField(),e=b(r,this.playingField),t||(this.minZoom=e),s=this.projection.inverse([(r.x2+r.x1)/2,(r.y2+r.y1)/2]),this.setView(s,e,o,i))}getField(t=!0){t=t?this.padding:[0,0,0,0];return{x:t[3],y:t[0],width:this.chart.plotWidth-t[1]-t[3],height:this.chart.plotHeight-t[0]-t[2]}}getGeoMap(t){return f(t)?n[t]&&"Topology"===n[t].type?r(n[t]):n[t]:l(t,!0)?"FeatureCollection"===t.type?t:"Topology"===t.type?r(t):void 0:void 0}getMapBBox(){var t,e,o=this.getProjectedBounds(),i=this.getScale();if(o)return t=this.padding,e=this.projectedUnitsToPixels({x:o.x1,y:o.y2}),{width:(o.x2-o.x1)*i+t[1]+t[3],height:(o.y2-o.y1)*i+t[0]+t[2],x:e.x-t[3],y:e.y-t[0]}}getProjectedBounds(){const e=this.projection;var t=this.chart.series.reduce((t,e)=>{var o=e.getProjectedBounds&&e.getProjectedBounds();return o&&!1!==e.options.affectsMapView&&t.push(o),t},[]);const o=this.options.fitToGeometry;if(o){if(!this.fitToGeometryCache)if("MultiPoint"===o.type){const i=o.coordinates.map(t=>e.forward(t)),s=i.map(t=>t[0]),r=i.map(t=>t[1]);this.fitToGeometryCache={x1:Math.min.apply(0,s),x2:Math.max.apply(0,s),y1:Math.min.apply(0,r),y2:Math.max.apply(0,r)}}else this.fitToGeometryCache=a(e.path(o));return this.fitToGeometryCache}return this.projection.bounds||w.compositeBounds(t)}getScale(){return 256/j*Math.pow(2,this.zoom)}getSVGTransform(){var{x:t,y:e,width:o,height:i}=this.playingField,s=this.projection.forward(this.center),r=this.projection.hasCoordinates?-1:1,n=this.getScale(),r=n*r;return{scaleX:n,scaleY:r,translateX:t+o/2-s[0]*n,translateY:e+i/2-s[1]*r}}lonLatToPixels(t){t=this.lonLatToProjectedUnits(t);if(t)return this.projectedUnitsToPixels(t)}lonLatToProjectedUnits(t){const e=this.chart,o=e.mapTransforms;if(o){for(const n in o)if(Object.hasOwnProperty.call(o,n)&&o[n].hitZone){var i=e.transformFromLatLon(t,o[n]);if(i&&h(i,o[n].hitZone.coordinates[0]))return i}return e.transformFromLatLon(t,o.default)}for(const a of this.insets){var s;if(a.options.geoBounds&&h({x:t.lon,y:t.lat},a.options.geoBounds.coordinates[0]))return s=a.projection.forward([t.lon,t.lat]),s=a.projectedUnitsToPixels({x:s[0],y:s[1]}),this.pixelsToProjectedUnits(s)}var r=this.projection.forward([t.lon,t.lat]);if(!r.outside)return{x:r[0],y:r[1]}}projectedUnitsToLonLat(t){const e=this.chart,o=e.mapTransforms;if(o){for(const r in o)if(Object.hasOwnProperty.call(o,r)&&o[r].hitZone&&h(t,o[r].hitZone.coordinates[0]))return e.transformToLatLon(t,o[r]);return e.transformToLatLon(t,o.default)}var i=this.projectedUnitsToPixels(t);for(const n of this.insets)if(n.hitZone&&h(i,n.hitZone.coordinates[0])){const a=n.pixelsToProjectedUnits(i),s=n.projection.inverse([a.x,a.y]);return{lon:s[0],lat:s[1]}}const s=this.projection.inverse([t.x,t.y]);return{lon:s[0],lat:s[1]}}redraw(t){this.chart.series.forEach(t=>{t.useMapGeometry&&(t.isDirty=!0)}),this.chart.redraw(t)}setView(t,e,o=!0,i){t&&(this.center=t),"number"==typeof e&&("number"==typeof this.minZoom&&(e=Math.max(e,this.minZoom)),"number"==typeof this.options.maxZoom&&(e=Math.min(e,this.options.maxZoom)),y(e)&&(this.zoom=e));var s,r,t=this.getProjectedBounds();if(t){const n=this.projection.forward(this.center),{x:a,y:h,width:p,height:l}=this.playingField,c=this.getScale(),d=this.projectedUnitsToPixels({x:t.x1,y:t.y1}),u=this.projectedUnitsToPixels({x:t.x2,y:t.y2}),m=[(t.x1+t.x2)/2,(t.y1+t.y2)/2],f=this.chart.series.some(t=>t.isDrilling);f||(e=d.x,t=u.y,s=u.x,r=d.y,s-e<p?n[0]=m[0]:e<a&&s<a+p?n[0]+=Math.max(e-a,s-p-a)/c:a+p<s&&a<e&&(n[0]+=Math.min(s-p-a,e-a)/c),r-t<l?n[1]=m[1]:t<h&&r<h+l?n[1]-=Math.max(t-h,r-l-h)/c:h+l<r&&h<t&&(n[1]-=Math.min(r-l-h,t-h)/c),this.center=this.projection.inverse(n)),this.insets.forEach(t=>{t.options.field&&(t.hitZone=t.getHitZone(),t.playingField=t.getField())}),this.render()}g(this,"afterSetView"),o&&this.redraw(i)}projectedUnitsToPixels(t){var e=this.getScale(),o=this.projection.forward(this.center),i=this.playingField,s=i.x+i.width/2,i=i.y+i.height/2;return{x:s-e*(o[0]-t.x),y:i+e*(o[1]-t.y)}}pixelsToLonLat(t){return this.projectedUnitsToLonLat(this.pixelsToProjectedUnits(t))}pixelsToProjectedUnits(t){var{x:t,y:e}=t,o=this.getScale(),i=this.projection.forward(this.center),s=this.playingField,r=s.x+s.width/2,s=s.y+s.height/2;return{x:i[0]+(t-r)/o,y:i[1]-(e-s)/o}}setUpEvents(){const h=this["chart"];let p,l,c;var t=t=>{var e,o,i,s=h.pointer.pinchDown,r=this.projection;let{mouseDownX:n,mouseDownY:a}=h;1===s.length&&(n=s[0].chartX,a=s[0].chartY),"number"==typeof n&&"number"==typeof a&&(s=n+","+a,{chartX:e,chartY:o}=t.originalEvent,s!==l&&(l=s,p=this.projection.forward(this.center),c=(this.projection.options.rotation||[0,0]).slice()),s=(s=r.def&&r.def.bounds)&&b(s,this.playingField)||-1/0,"Orthographic"===r.options.name&&(this.minZoom||1/0)<1.3*s?(r=440/(this.getScale()*Math.min(h.plotWidth,h.plotHeight)),c&&(s=(n-e)*r-c[0],r=m(-c[1]-(a-o)*r,-80,80),i=this.zoom,this.update({projection:{rotation:[-s,-r]}},!1),this.fitToBounds(void 0,void 0,!1),this.zoom=i,h.redraw(!1))):y(e)&&y(o)&&(s=this.getScale(),r=this.projection.hasCoordinates?1:-1,i=this.projection.inverse([p[0]+(n-e)/s,p[1]-(a-o)/s*r]),this.setView(i,void 0,!0,!1)),t.preventDefault())};u(h,"pan",t),u(h,"touchpan",t),u(h,"selection",t=>{var e,o,i,s;t.resetSelection?this.zoomBy():(i=t.x-h.plotLeft,s=t.y-h.plotTop,{y:e,x:o}=this.pixelsToProjectedUnits({x:i,y:s}),{y:i,x:s}=this.pixelsToProjectedUnits({x:i+t.width,y:s+t.height}),this.fitToBounds({x1:o,y1:e,x2:s,y2:i},void 0,!0,!t.originalEvent.touches&&void 0),/^touch/.test(t.originalEvent.type)||h.showResetZoom(),t.preventDefault())})}render(){this.group||(this.group=this.chart.renderer.g("map-view").attr({zIndex:4}).add())}update(t,e=!0,o){var i=t.projection;let s=i&&d.toString(i)!==d.toString(this.options.projection),r=!1;M(!0,this.userOptions,t),M(!0,this.options,t),"insets"in t&&(this.insets.forEach(t=>t.destroy()),this.insets.length=0,r=!0),(s||"fitToGeometry"in t)&&delete this.fitToGeometryCache,(s||r)&&(this.chart.series.forEach(t=>{const e=t.transformGroups;if(t.clearBounds&&t.clearBounds(),t.isDirty=!0,t.isDirtyData=!0,r&&e)for(;1<e.length;){const o=e.pop();o&&o.destroy()}}),s&&(this.projection=new d(this.options.projection)),r&&this.createInsets(),t.center||!Object.hasOwnProperty.call(t,"zoom")||y(t.zoom)||this.fitToBounds(void 0,void 0,!1)),t.center||y(t.zoom)?this.setView(this.options.center,t.zoom,!1):"fitToGeometry"in t&&this.fitToBounds(void 0,void 0,!1),e&&this.chart.redraw(o)}zoomBy(e,o,i,s){var r=this.chart;const n=this.projection.forward(this.center);let[a,h]=o?this.projection.forward(o):[];if("number"==typeof e){var p,o=this.zoom+e;let t;i&&([e,i]=i,p=this.getScale(),e=e-r.plotLeft-r.plotWidth/2,i=i-r.plotTop-r.plotHeight/2,a=n[0]+e/p,h=n[1]+i/p),"number"==typeof a&&"number"==typeof h&&(r=1-Math.pow(2,this.zoom)/Math.pow(2,o),e=n[0]-a,i=n[1]-h,n[0]-=e*r,n[1]+=i*r,t=this.projection.inverse(n)),this.setView(t,o,void 0,s)}else this.fitToBounds(void 0,void 0,void 0,s)}}w.compositeBounds=t=>{if(t.length)return t.slice(1).reduce((t,e)=>(t.x1=Math.min(t.x1,e.x1),t.y1=Math.min(t.y1,e.y1),t.x2=Math.max(t.x2,e.x2),t.y2=Math.max(t.y2,e.y2),t),M(t[0]))};class P extends w{constructor(t,e){if(super(t.chart,e),this.id=e.id,this.mapView=t,this.options=M(i,e),this.allBounds=[],this.options.geoBounds){const o=t.projection.path(this.options.geoBounds);this.geoBoundsProjectedBox=a(o),this.geoBoundsProjectedPolygon=o.map(t=>[t[1]||0,t[2]||0])}}getField(t=!0){var e=this.hitZone;if(e){const o=t?this.padding:[0,0,0,0],i=e.coordinates[0],s=i.map(t=>t[0]),r=i.map(t=>t[1]),n=Math.min.apply(0,s)+o[3],a=Math.max.apply(0,s)-o[1],h=Math.min.apply(0,r)+o[0],p=Math.max.apply(0,r)-o[2];if(y(n)&&y(h))return{x:n,y:h,width:a-n,height:p-h}}return super.getField.call(this,t)}getHitZone(){const{chart:e,mapView:o,options:i}=this,s=(i.field||{})["coordinates"];if(s){let t=s[0];if("percent"===i.units){const r="mapBoundingBox"===i.relativeTo&&o.getMapBBox()||M(e.plotBox,{x:0,y:0});t=t.map(t=>[x(t[0]+"%",r.width,r.x),x(t[1]+"%",r.height,r.y)])}return{type:"Polygon",coordinates:[t]}}}getProjectedBounds(){return w.compositeBounds(this.allBounds)}isInside(t){var{geoBoundsProjectedBox:e,geoBoundsProjectedPolygon:o}=this;return Boolean(e&&t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2&&o&&h(t,o))}render(){const{chart:r,mapView:e,options:n}=this,o=n.borderPath||n.field;if(o&&e.group){let t=!0;this.border||(this.border=r.renderer.path().addClass("highcharts-mapview-inset-border").add(e.group),t=!1),r.styledMode||this.border.attr({stroke:n.borderColor,"stroke-width":n.borderWidth});const a=Math.round(this.border.strokeWidth())%2/2,h="mapBoundingBox"===n.relativeTo&&e.getMapBBox()||e.playingField;var i=(o.coordinates||[]).reduce((t,e)=>e.reduce((t,e,o)=>{let[i,s]=e;return"percent"===n.units&&(i=r.plotLeft+x(i+"%",h.width,h.x),s=r.plotTop+x(s+"%",h.height,h.y)),i=Math.floor(i)+a,s=Math.floor(s)+a,t.push(0===o?["M",i,s]:["L",i,s]),t},t),[]);this.border[t?"animate":"attr"]({d:i})}}destroy(){this.border&&(this.border=this.border.destroy()),this.eventsToUnbind.forEach(t=>t())}setUpEvents(){}}return u(e,"afterInit",function(){this.mapView=new w(this,this.options.mapView)}),w}),e(t,"Series/Map/MapSeries.js",[t["Core/Animation/AnimationUtilities.js"],t["Series/ColorMapComposition.js"],t["Series/CenteredUtilities.js"],t["Core/Globals.js"],t["Core/Chart/MapChart.js"],t["Series/Map/MapPoint.js"],t["Maps/MapView.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Utilities.js"]],function(t,e,o,M,i,v,s,r,n,a,h){const p=t["animObject"];t=M.noop;const l=i["splitPath"],{column:c,scatter:d}=n["seriesTypes"],{extend:u,find:m,fireEvent:f,getNestedProperty:x,isArray:j,defined:g,isNumber:b,isObject:w,merge:P,objectEach:T,pick:y,splat:C}=h;class L extends d{constructor(){super(...arguments),this.chart=void 0,this.data=void 0,this.group=void 0,this.joinBy=void 0,this.options=void 0,this.points=void 0,this.processedData=[]}animate(t){const{chart:e,group:o}=this,i=p(this.options.animation);t?o.attr({translateX:e.plotLeft+e.plotWidth/2,translateY:e.plotTop+e.plotHeight/2,scaleX:.001,scaleY:.001}):o.animate({translateX:e.plotLeft,translateY:e.plotTop,scaleX:1,scaleY:1},i)}clearBounds(){this.points.forEach(t=>{delete t.bounds,delete t.insetIndex,delete t.projectedPath}),delete this.bounds}doFullTranslate(){return Boolean(this.isDirtyData||this.chart.isResizing||!this.hasRendered)}drawMapDataLabels(){r.prototype.drawDataLabels.call(this),this.dataLabelsGroup&&this.dataLabelsGroup.clip(this.chart.clipRect)}drawPoints(){const d=this,{chart:u,group:o,transformGroups:i=[]}=this,{mapView:m,renderer:f}=u;m&&((this.transformGroups=i)[0]||(i[0]=f.g().add(o)),m.insets.forEach((t,e)=>{i[e+1]||i.push(f.g().add(o))}),this.doFullTranslate()&&(this.points.forEach(t=>{const{graphic:e,shapeArgs:o}=t;t.group=i["number"==typeof t.insetIndex?t.insetIndex+1:0],e&&e.parentGroup!==t.group&&e.add(t.group),o&&u.hasRendered&&!u.styledMode&&(o.fill=this.pointAttribs(t,t.state).fill)}),c.prototype.drawPoints.apply(this),this.points.forEach(e=>{const n=e.graphic;if(n){const a=n.animate;let t="";e.name&&(t+="highcharts-name-"+e.name.replace(/ /g,"-").toLowerCase()),e.properties&&e.properties["hc-key"]&&(t+=" highcharts-key-"+e.properties["hc-key"].toString().toLowerCase()),t&&n.addClass(t),u.styledMode&&n.css(this.pointAttribs(e,e.selected?"select":void 0)),n.animate=function(t,e,o){var i,s=b(t["stroke-width"])&&!b(n["stroke-width"]),r=b(n["stroke-width"])&&!b(t["stroke-width"]),s=((s||r)&&(i=y(d.getStrokeWidth(d.options),1)/(u.mapView&&u.mapView.getScale()||1),s&&(n["stroke-width"]=i),r&&(t["stroke-width"]=i)),a.call(n,t,e,r?function(){n.element.removeAttribute("stroke-width"),delete n["stroke-width"],o&&o.apply(this,arguments)}:o));return s}}})),i.forEach((i,t)=>{const e=0===t?m:m.insets[t-1],s=e.getSVGTransform(),r=y(this.getStrokeWidth(this.options),1),n=s.scaleX,a=0<s.scaleY?1:-1,h=i=>{(d.points||[]).forEach(t=>{const e=t.graphic;let o;e&&e["stroke-width"]&&(o=this.getStrokeWidth(t.options))&&e.attr({"stroke-width":o/i})})};if(f.globalAnimation&&u.hasRendered&&m.allowTransformAnimation){const p=Number(i.attr("translateX")),l=Number(i.attr("translateY")),c=Number(i.attr("scaleX"));let t={};if("boolean"!=typeof(t=u.options.chart?P({},u.options.chart.animation):t)){const o=t.step;t.step=function(t){o&&o.apply(this,arguments),((t,e)=>{var o=c+(n-c)*e.pos;i.attr({translateX:p+(s.translateX-p)*e.pos,translateY:l+(s.translateY-l)*e.pos,scaleX:o,scaleY:o*a,"stroke-width":r/o}),h(o)}).apply(this,arguments)}}i.attr({animator:0}).animate({animator:1},t,function(){"boolean"!=typeof f.globalAnimation&&f.globalAnimation.complete&&f.globalAnimation.complete({applyDrilldown:!0})})}else i.attr(P(s,{"stroke-width":r/n})),h(n)}),this.isDrilling||this.drawMapDataLabels())}getProjectedBounds(){if(!this.bounds&&this.chart.mapView){const{insets:r,projection:n}=this.chart.mapView,t=[];(this.points||[]).forEach(function(e){if(e.path||e.geometry){if("string"==typeof e.path?e.path=l(e.path):j(e.path)&&"M"===e.path[0]&&(e.path=a.prototype.pathToSegments(e.path)),!e.bounds){let t=e.getProjectedBounds(n);if(t){e.labelrank=y(e.labelrank,(t.x2-t.x1)*(t.y2-t.y1));const{midX:o,midY:i}=t;if(r&&b(o)&&b(i)){const s=m(r,t=>t.isInside({x:o,y:i}));s&&(delete e.projectedPath,(t=e.getProjectedBounds(s.projection))&&s.allBounds.push(t),e.insetIndex=r.indexOf(s))}e.bounds=t}}e.bounds&&void 0===e.insetIndex&&t.push(e.bounds)}}),this.bounds=s.compositeBounds(t)}return this.bounds}getStrokeWidth(t){var e=this.pointAttrToOptions;return t[e&&e["stroke-width"]||"borderWidth"]}hasData(){return!!this.processedXData.length}pointAttribs(t,e){var o;const{mapView:i,styledMode:s}=t.series.chart,r=s?this.colorAttribs(t):c.prototype.pointAttribs.call(this,t,e);let n=this.getStrokeWidth(t.options);e&&(e=P(this.options.states[e],t.options.states&&t.options.states[e]||{}),o=this.getStrokeWidth(e),g(o)&&(n=o),r.stroke=null!=(o=e.borderColor)?o:t.color),n&&i&&(n/=i.getScale());e=this.getStrokeWidth(this.options);return r.dashstyle&&i&&b(e)&&(n=e/i.getScale()),t.visible||(r.fill=this.options.nullColor),g(n)?r["stroke-width"]=n:delete r["stroke-width"],r["stroke-linecap"]=r["stroke-linejoin"]=this.options.linecap,r}updateData(){return!this.processedData&&super.updateData.apply(this,arguments)}setData(t,e=!0,o,i){delete this.bounds,super.setData.call(this,t,!1,void 0,i),this.processData(),this.generatePoints(),e&&this.chart.redraw(o)}processData(){const t=this.options,s=t.data,e=this.chart.options.chart,r=this.joinBy,n=t.keys||this.pointArrayMap,o=[],i={};let a=this.chart.mapView,h=a&&(w(t.mapData,!0)?a.getGeoMap(t.mapData):a.geoMap),p=this.chart.mapTransforms,l,c,d;this.chart.mapTransforms=p=e.mapTransforms||h&&h["hc-transform"]||p,p&&T(p,function(t){t.rotation&&(t.cosAngle=Math.cos(t.rotation),t.sinAngle=Math.sin(t.rotation))});let u;j(t.mapData)?u=t.mapData:h&&"FeatureCollection"===h.type&&(this.mapTitle=h.title,u=M.geojson(h,this.type,this)),this.processedData=[];const m=this.processedData;if(s&&s.forEach(function(e,o){let i=0;if(b(e))m[o]={value:e};else if(j(e)){m[o]={},!t.keys&&e.length>n.length&&"string"==typeof e[0]&&(m[o]["hc-key"]=e[0],++i);for(let t=0;t<n.length;++t,++i)n[t]&&void 0!==e[i]&&(0<n[t].indexOf(".")?v.prototype.setNestedProperty(m[o],e[i],n[t]):m[o][n[t]]=e[i])}else m[o]=s[o];r&&"_i"===r[0]&&(m[o]._i=o)}),u){for(this.mapData=u,this.mapMap={},d=0;d<u.length;d++)c=(l=u[d]).properties,l._i=d,r[0]&&c&&c[r[0]]&&(l[r[0]]=c[r[0]]),i[l[r[0]]]=l;if(this.mapMap=i,r[1]){const f=r[1];m.forEach(function(t){t=x(f,t);i[t]&&o.push(i[t])})}if(t.allAreas){if(r[1]){const y=r[1];m.forEach(function(t){o.push(x(y,t))})}const g="|"+o.map(function(t){return t&&t[r[0]]}).join("|")+"|";u.forEach(function(t){r[0]&&-1!==g.indexOf("|"+t[r[0]]+"|")||m.push(P(t,{value:null}))})}}this.processedXData=new Array(m.length)}setOptions(t){let e=r.prototype.setOptions.call(this,t),o=e.joinBy,i=null===o;return i&&(o="_i"),(o=this.joinBy=C(o))[1]||(o[1]=o[0]),e}translate(){const o=this.doFullTranslate(),i=this.chart.mapView,s=i&&i.projection;if(!this.chart.hasRendered||!this.isDirtyData&&this.hasRendered||(this.processData(),this.generatePoints(),delete this.bounds,!i||i.userOptions.center||b(i.userOptions.zoom)||i.zoom!==i.minZoom?this.getProjectedBounds():i.fitToBounds(void 0,void 0,!1)),i){const r=i.getSVGTransform();this.points.forEach(function(t){var e=b(t.insetIndex)&&i.insets[t.insetIndex].getSVGTransform()||r;e&&t.bounds&&b(t.bounds.midX)&&b(t.bounds.midY)&&(t.plotX=t.bounds.midX*e.scaleX+e.translateX,t.plotY=t.bounds.midY*e.scaleY+e.translateY),o&&(t.shapeType="path",t.shapeArgs={d:v.getProjectedPath(t,s)}),t.projectedPath&&!t.projectedPath.length?t.setVisible(!1):t.setVisible(!0)})}f(this,"afterTranslate")}}return L.defaultOptions=P(d.defaultOptions,{affectsMapView:!0,animation:!1,dataLabels:{crop:!1,formatter:function(){const t=this.series.chart["numberFormatter"];var e=this.point["value"];return b(e)?t(e,-1):""},inside:!0,overflow:!1,padding:0,verticalAlign:"middle"},linecap:"round",marker:null,nullColor:"#f7f7f7",stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:"{point.name}: {point.value}<br/>"},turboThreshold:0,allAreas:!0,borderColor:"#e6e6e6",borderWidth:1,joinBy:"hc-key",states:{hover:{halo:void 0,borderColor:"#666666",borderWidth:2},normal:{animation:!0},select:{color:"#cccccc"}},legendSymbol:"rectangle"}),u(L.prototype,{type:"map",axisTypes:e.seriesMembers.axisTypes,colorAttribs:e.seriesMembers.colorAttribs,colorKey:e.seriesMembers.colorKey,directTouch:!0,drawDataLabels:t,drawGraph:t,forceDL:!0,getCenter:o.getCenter,getExtremesFromAll:!0,getSymbol:t,isCartesian:!1,parallelArrays:e.seriesMembers.parallelArrays,pointArrayMap:e.seriesMembers.pointArrayMap,pointClass:v,preserveAspectRatio:!0,searchPoint:t,trackerGroups:e.seriesMembers.trackerGroups,useMapGeometry:!0}),e.compose(L),n.registerSeriesType("map",L),L}),e(t,"Series/FlowMap/FlowMapSeries.js",[t["Series/FlowMap/FlowMapPoint.js"],t["Series/Map/MapSeries.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,i,e,o){const{series:{prototype:{pointClass:d}},seriesTypes:{column:s,mapline:r}}=e,{addEvent:u,arrayMax:n,arrayMin:a,defined:P,extend:h,isArray:m,merge:T,pick:C,relativeLength:L}=o;class S extends r{constructor(){super(...arguments),this.data=void 0,this.options=void 0,this.points=void 0,this.smallestWeight=void 0,this.greatestWeight=void 0,this.centerOfPoints=void 0}static getLength(t,e){return Math.sqrt(t*t+e*e)}static normalize(t,e){var o=this.getLength(t,e);return[t/o,e/o]}static markerEndPath(t,e,o,i){var s,r,n=L(i.width||0,this.getLength(e[0]-t[0],e[1]-t[1])),i=i.markerType||"arrow",[a,h]=this.normalize(e[0]-t[0],e[1]-t[1]);const p=[];return"arrow"===i&&([s,r]=t,s-=a*n,r-=h*n,p.push(["L",s,r]),p.push(["L",o[0],o[1]]),[s,r]=e,s+=a*n,r+=h*n,p.push(["L",s,r])),"mushroom"===i&&([s,r]=t,[i,t]=e,[e,o]=o,e=2*(e-(e=(i-s)/2+s))+e,o=2*(o-(o=(t-r)/2+r))+o,s-=a*n,r-=h*n,p.push(["L",s,r]),i+=a*n,t+=h*n,p.push(["Q",e,o,i,t])),p}animate(t){const e=this.points;t||e.forEach(t=>{if(t.shapeArgs&&m(t.shapeArgs.d)&&t.shapeArgs.d.length){var o=t.shapeArgs.d,i=o[0][1],s=o[0][2];if(i&&s){const r=[];for(let e=0;e<o.length;e++){r.push([...o[e]]);for(let t=1;t<o[e].length;t++)r[e][t]=t%2?i:s}t.graphic&&(t.graphic.attr({d:r}),t.graphic.animate({d:o}))}}})}getLinkWidth(t){var e=this.options.width,o=t.options.weight||this.options.weight;if(t.options.weight=o,e&&!o)return e;t=this.smallestWeight,e=this.greatestWeight;if(!P(o)||!t||!e)return 0;var i=this.options.minWidth;return(o-t)*(this.options.maxWidth-i)/(e-t||1)+i}autoCurve(t,e,o,i,s,r){const n=o-t,a=i-e,h=(o-t)/2+t,p=(i-e)/2+e,l=h-s,c=p-r;o=n*l+a*c,t=n*c-a*l;let d=Math.atan2(t,o),u=180*d/Math.PI;return d=(u=u<0?360+u:u)*Math.PI/180,.7*-Math.sin(d)}pointAttribs(t,e){const o=i.prototype.pointAttribs.call(this,t,e);return o.fill=C(t.options.fillColor,t.options.color,"none"===this.options.fillColor?null:this.options.fillColor,this.color),o["fill-opacity"]=C(t.options.fillOpacity,this.options.fillOpacity),o["stroke-width"]=C(t.options.lineWidth,this.options.lineWidth,1),t.options.opacity&&(o.opacity=t.options.opacity),o}translate(){!this.chart.hasRendered||!this.isDirtyData&&this.hasRendered||(this.processData(),this.generatePoints());const p=[];let l=0,c=0;this.points.forEach(t=>{const e=this.chart,o=e.mapView,i=t.options,s=()=>{t.series.isDirty=!0},r=t=>{t=e.get(t);if(t instanceof d&&t.plotX&&t.plotY)return u(t,"update",s),{x:t.plotX,y:t.plotY}},n=t=>m(t)?{lon:t[0],lat:t[1]}:t;let a,h;"string"==typeof i.from?a=r(i.from):"object"==typeof i.from&&o&&(a=o.lonLatToPixels(n(i.from))),"string"==typeof i.to?h=r(i.to):"object"==typeof i.to&&o&&(h=o.lonLatToPixels(n(i.to))),t.fromPos=a,t.toPos=h,a&&h&&(l+=(a.x+h.x)/2,c+=(a.y+h.y)/2),C(t.options.weight,this.options.weight)&&p.push(C(t.options.weight,this.options.weight))}),this.smallestWeight=a(p),this.greatestWeight=n(p),this.centerOfPoints={x:l/this.points.length,y:c/this.points.length},this.points.forEach(t=>{this.getLinkWidth(t)?(t.fromPos&&(t.plotX=t.fromPos.x,t.plotY=t.fromPos.y),t.shapeType="path",t.shapeArgs=this.getPointShapeArgs(t),t.color=C(t.options.color,t.series.color)):t.shapeArgs={d:[]}})}getPointShapeArgs(t){var{fromPos:e,toPos:o}=t;if(!e||!o)return{};var i=this.getLinkWidth(t)/2,s=t.options,r=T(this.options.markerEnd,s.markerEnd),n=C(s.growTowards,this.options.growTowards),a=e.x||0,e=e.y||0;let h=o.x||0,p=o.y||0,l=C(s.curveFactor,this.options.curveFactor),c=r&&r.enabled&&r.height||0;if(P(l)||(l=this.autoCurve(a,e,h,p,this.centerOfPoints.x,this.centerOfPoints.y)),c){c=L(c,4*i);var s=h-a,d=p-e;const u=a+(s*=.5),m=e+(d*=.5),f=s,v=(s=d,d=-f,u+s*l),x=m+d*l;var[s,d]=S.normalize(v-h,x-p);s*=c,d*=c,h+=s,p+=d}s=h-a,d=p-e;const u=a+(s*=.5),m=e+(d*=.5);let f=s,[g,y]=(s=d,d=-f,S.normalize(s,d));var M=1+.25*Math.sqrt(l*l);g*=i*M,y*=i*M;const v=u+s*l,x=m+d*l;let[j,b]=S.normalize(v-a,x-e);f=j,j=b,b=-f,j*=i,b*=i;var[M,s]=S.normalize(v-h,x-p);f=M,M=-s,s=f,M*=i,s*=i,n&&(j/=i,b/=i,g/=4,y/=4);const w={d:[["M",a-j,e-b],["Q",v-g,x-y,h-M,p-s],["L",h+M,p+s],["Q",v+g,x+y,a+j,e+b],["Z"]]};r&&r.enabled&&w.d&&(d=S.markerEndPath([h-M,p-s],[h+M,p+s],[o.x,o.y],r),w.d.splice(2,0,...d));n=t.options.from,i=t.options.to,a=n.lat,e=n.lon,M=i.lat,s=i.lon;return a&&e&&(t.options.from=+a+", "+ +e),M&&s&&(t.options.to=+M+", "+ +s),w}}return S.defaultOptions=T(r.defaultOptions,{animation:!0,dataLabels:{enabled:!1},fillOpacity:.5,markerEnd:{enabled:!0,height:"40%",width:"40%",markerType:"arrow"},width:1,maxWidth:25,minWidth:5,lineWidth:void 0,tooltip:{headerFormat:'<span style="font-size: 0.8em">{series.name}</span><br/>',pointFormat:"{point.options.from} → {point.options.to}: <b>{point.options.weight}</b>"}}),h(S.prototype,{pointClass:t,pointArrayMap:["from","to","weight"],drawPoints:s.prototype.drawPoints,useMapGeometry:!0}),e.registerSeriesType("flowmap",S),S}),e(t,"masters/modules/flowmap.src.js",[],function(){})});