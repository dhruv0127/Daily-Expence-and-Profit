!function(n){"object"==typeof module&&module.exports?module.exports=n.default=n:"function"==typeof define&&define.amd?define("highcharts/modules/pathfinder",["highcharts"],function(t){return n(t),n.Highcharts=t,n}):n("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){"use strict";t=t?t._modules:{};function n(t,n,i,e){t.hasOwnProperty(n)||(t[n]=e.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:n,module:t[n]}})))}n(t,"Gantt/Connection.js",[t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Series/Point.js"],t["Core/Utilities.js"]],function(t,n,i,e){t=t.defaultOptions;const{defined:c,error:a,extend:r,merge:x,objectEach:o}=e,u=n.deg2rad,l=Math.max,M=Math.min;function g(t){var n=t.shapeArgs;return n?{xMin:n.x||0,xMax:(n.x||0)+(n.width||0),yMin:n.y||0,yMax:(n.y||0)+(n.height||0)}:(n=t.graphic&&t.graphic.getBBox())?{xMin:t.plotX-n.width/2,xMax:t.plotX+n.width/2,yMin:t.plotY-n.height/2,yMax:t.plotY+n.height/2}:null}r(t,{connectors:{type:"straight",lineWidth:1,marker:{enabled:!1,align:"center",verticalAlign:"middle",inside:!1,lineWidth:1},startMarker:{symbol:"diamond"},endMarker:{symbol:"arrow-filled"}}});class s{constructor(t,n,i){this.chart=void 0,this.fromPoint=void 0,this.graphics=void 0,this.pathfinder=void 0,this.toPoint=void 0,this.init(t,n,i)}init(t,n,i){this.fromPoint=t,this.toPoint=n,this.options=i,this.chart=t.series.chart,this.pathfinder=this.chart.pathfinder}renderPath(t,n,i){let e=this.chart,r=e.styledMode,a=e.pathfinder,o=!e.options.chart.forExport&&!1!==i,s=this.graphics&&this.graphics.path,h;a.group||(a.group=e.renderer.g().addClass("highcharts-pathfinder-group").attr({zIndex:-1}).add(e.seriesGroup)),a.group.translate(e.plotLeft,e.plotTop),s&&s.renderer||(s=e.renderer.path().add(a.group),r||s.attr({opacity:0})),s.attr(n),h={d:t},r||(h.opacity=1),s[o?"animate":"attr"](h,i),this.graphics=this.graphics||{},this.graphics.path=s}addMarker(t,n,i){let e=this,r=e.fromPoint.series.chart,a=r.pathfinder,o=r.renderer,s="start"===t?e.fromPoint:e.toPoint,h=s.getPathfinderAnchorPoint(n),c,x,l,M,d,y,p,f;n.enabled&&((f="start"===t?i[1]:i[i.length-2])&&"M"===f[0]||"L"===f[0])&&(p={x:f[1],y:f[2]},x=s.getRadiansToVector(p,h),c=s.getMarkerVector(x,n.radius,h),l=-x/u,n.width&&n.height?(d=n.width,y=n.height):d=y=2*n.radius,e.graphics=e.graphics||{},M={x:c.x-d/2,y:c.y-y/2,width:d,height:y,rotation:l,rotationOriginX:c.x,rotationOriginY:c.y},e.graphics[t]?e.graphics[t].animate(M):(e.graphics[t]=o.symbol(n.symbol).addClass("highcharts-point-connecting-path-"+t+"-marker").attr(M).add(a.group),o.styledMode||e.graphics[t].attr({fill:n.color||e.fromPoint.color,stroke:n.lineColor,"stroke-width":n.lineWidth,opacity:0}).animate({opacity:1},s.series.options.animation)))}getPath(t){let n=this.pathfinder,i=this.chart,e=n.algorithms[t.type],r=n.chartObstacles;return"function"!=typeof e?(a('"'+t.type+'" is not a Pathfinder algorithm.'),{path:[],obstacles:[]}):(e.requiresObstacles&&!r&&(r=n.chartObstacles=n.getChartObstacles(t),i.options.connectors.algorithmMargin=t.algorithmMargin,n.chartObstacleMetrics=n.getObstacleMetrics(r)),e(this.fromPoint.getPathfinderAnchorPoint(t.startMarker),this.toPoint.getPathfinderAnchorPoint(t.endMarker),x({chartObstacles:r,lineObstacles:n.lineObstacles||[],obstacleMetrics:n.chartObstacleMetrics,hardBounds:{xMin:0,xMax:i.plotWidth,yMin:0,yMax:i.plotHeight},obstacleOptions:{margin:t.algorithmMargin},startDirectionX:n.getAlgorithmStartDirection(t.startMarker)},t)))}render(){let t=this,n=t.fromPoint,i=n.series,e=i.chart,r=e.pathfinder,a,o,s=x(e.options.connectors,i.options.connectors,n.options.connectors,t.options),h={};e.styledMode||(h.stroke=s.lineColor||n.color,h["stroke-width"]=s.lineWidth,s.dashStyle&&(h.dashstyle=s.dashStyle)),h.class="highcharts-point-connecting-path highcharts-color-"+n.colorIndex,s=x(h,s),c(s.marker.radius)||(s.marker.radius=M(l(Math.ceil((s.algorithmMargin||8)/2)-1,1),5)),o=(a=t.getPath(s)).path,a.obstacles&&(r.lineObstacles=r.lineObstacles||[],r.lineObstacles=r.lineObstacles.concat(a.obstacles)),t.renderPath(o,h,i.options.animation),t.addMarker("start",x(s.marker,s.startMarker),o),t.addMarker("end",x(s.marker,s.endMarker),o)}destroy(){this.graphics&&(o(this.graphics,function(t){t.destroy()}),delete this.graphics)}}return n.Connection=s,r(i.prototype,{getPathfinderAnchorPoint:function(t){let n=g(this),i,e;switch(t.align){case"right":i="xMax";break;case"left":i="xMin"}switch(t.verticalAlign){case"top":e="yMin";break;case"bottom":e="yMax"}return{x:i?n[i]:(n.xMin+n.xMax)/2,y:e?n[e]:(n.yMin+n.yMax)/2}},getRadiansToVector:function(t,n){var i;return c(n)||(i=g(this))&&(n={x:(i.xMin+i.xMax)/2,y:(i.yMin+i.yMax)/2}),Math.atan2(n.y-t.y,t.x-n.x)},getMarkerVector:function(t,n,i){let e=2*Math.PI,r=t,a=g(this),o=a.xMax-a.xMin,s=a.yMax-a.yMin,h=Math.atan2(s,o),c,x=!1,l=o/2,M=s/2,d=a.xMin+l,y=a.yMin+M,p={x:d,y:y},f=1,u=1;for(;r<-Math.PI;)r+=e;for(;r>Math.PI;)r-=e;return c=Math.tan(r),r>-h&&r<=h?(u=-1,x=!0):r>h&&r<=Math.PI-h?u=-1:r>Math.PI-h||r<=-(Math.PI-h)?(f=-1,x=!0):f=-1,x?(p.x+=f*l,p.y+=u*l*c):(p.x+=f*(s/(2*c)),p.y+=u*M),i.x!==d&&(p.x=i.x),i.y!==y&&(p.y=i.y),{x:p.x+n*Math.cos(r),y:p.y-n*Math.sin(r)}}}),s}),n(t,"Gantt/PathfinderAlgorithms.js",[t["Core/Utilities.js"]],function(t){const O=t["pick"],{min:w,max:C,abs:j}=Math;function A(t,n,i){let e=i||0,r=t.length-1,a=n-1e-7,o,s;for(;e<=r;)if(0<(s=a-t[o=r+e>>1].xMin))e=1+o;else{if(!(s<0))return o;r=o-1}return 0<e?e-1:0}function E(t,n){let i=A(t,n.x+1)+1;for(;i--;)if(t[i].xMax>=n.x&&(e=t[i],(r=n).x<=e.xMax&&r.x>=e.xMin&&r.y<=e.yMax&&r.y>=e.yMin))return i;var e,r;return-1}function I(n){const i=[];if(n.length){i.push(["M",n[0].start.x,n[0].start.y]);for(let t=0;t<n.length;++t)i.push(["L",n[t].end.x,n[t].end.y])}return i}function R(t,n){t.yMin=C(t.yMin,n.yMin),t.yMax=w(t.yMax,n.yMax),t.xMin=C(t.xMin,n.xMin),t.xMax=w(t.xMax,n.xMax)}function n(t,n,i){let e=[],r,a=O(i.startDirectionX,j(n.x-t.x)>j(n.y-t.y))?"x":"y",o=i.chartObstacles,s=E(o,t),h=E(o,n),c,x,l,M,d,y,p;function f(t,n,i,e,r){const a={x:t.x,y:t.y};return a[n]=i[e||n]+(r||0),a}function u(t,n,i){var e=j(n[i]-t[i+"Min"])>j(n[i]-t[i+"Max"]);return f(n,i,t,i+(e?"Max":"Min"),e?1:-1)}return p=-1<h?(x=o[h],M=u(x,n,a),r={start:M,end:n},M):n,-1<s&&(c=o[s],M=u(c,t,a),e.push({start:t,end:M}),M[a]>=t[a]==M[a]>=p[a]&&(y=t[a="y"===a?"x":"y"]<n[a],e.push({start:M,end:f(M,a,c,a+(y?"Max":"Min"),y?1:-1)}),a="y"===a?"x":"y")),l=e.length?e[e.length-1].end:t,M=f(l,a,p),e.push({start:l,end:M}),a="y"===a?"x":"y",d=f(M,a,p),e.push({start:M,end:d}),e.push(r),{path:I(e),obstacles:e}}function i(t,n,y){let i=O(y.startDirectionX,j(n.x-t.x)>j(n.y-t.y)),e=i?"x":"y",r,a,o,s=[],p=!1,h=y.obstacleMetrics,f=w(t.x,n.x)-h.maxWidth-10,u=C(t.x,n.x)+h.maxWidth+10,g=w(t.y,n.y)-h.maxHeight-10,m=C(t.y,n.y)+h.maxHeight+10,b=y.chartObstacles,c=A(b,f),x=A(b,u);function P(t,n,i){let e,r,a,o,s,h=t.x<n.x?1:-1;for(r=t.x<n.x?(e=t,n):(e=n,t),a=t.y<n.y?(o=t,n):(o=n,t),s=h<0?w(A(b,r.x),b.length-1):0;b[s]&&(0<h&&b[s].xMin<=r.x||h<0&&b[s].xMax>=e.x);){if(b[s].xMin<=r.x&&b[s].xMax>=e.x&&b[s].yMin<=a.y&&b[s].yMax>=o.y)return i?{y:t.y,x:t.x<n.x?b[s].xMin-1:b[s].xMax+1,obstacle:b[s]}:{x:t.x,y:t.y<n.y?b[s].yMin-1:b[s].yMax+1,obstacle:b[s]};s+=h}return n}function v(t,n,i,e,r){let a=r.soft,o=r.hard,s=e?"x":"y",h={x:n.x,y:n.y},c={x:n.x,y:n.y},x,l,M=t[s+"Max"]>=a[s+"Max"],d=t[s+"Min"]<=a[s+"Min"],y=t[s+"Max"]>=o[s+"Max"],p=t[s+"Min"]<=o[s+"Min"],f=j(t[s+"Min"]-n[s]),u=j(t[s+"Max"]-n[s]),g=j(f-u)<10?n[s]<i[s]:u<f;return c[s]=t[s+"Min"],h[s]=t[s+"Max"],x=P(n,c,e)[s]!==c[s],l=P(n,h,e)[s]!==h[s],g=x?!l||g:!l&&g,g=d?!M||g:!M&&g,g=p?!y||g:!y&&g}var l,M,d,k;for(b=b.slice(c,x+1),-1<(x=E(b,n))&&(o=(l=b[x],M=n,d=t,k=w(l.xMax-M.x,M.x-l.xMin)<w(l.yMax-M.y,M.y-l.yMin),d=v(l,M,d,k,{soft:y.hardBounds,hard:y.hardBounds}),k?{y:M.y,x:l[d?"xMax":"xMin"]+(d?1:-1)}:{x:M.x,y:l[d?"yMax":"yMin"]+(d?1:-1)}),s.push({end:n,start:o}),n=o);-1<(x=E(b,n));)a=n[e]-t[e]<0,(o={x:n.x,y:n.y})[e]=b[x][a?e+"Max":e+"Min"]+(a?1:-1),s.push({end:n,start:o}),n=o;return{path:I(r=(r=function t(n,i,e){if(n.x===i.x&&n.y===i.y)return[];let r=e?"x":"y",a,o,s,h,c,x,l,M=y.obstacleOptions.margin,d={soft:{xMin:f,xMax:u,yMin:g,yMax:m},hard:y.hardBounds};return-1<(c=E(b,n))?(c=b[c],h=v(c,n,i,e,d),R(c,y.hardBounds),l=e?{y:n.y,x:c[h?"xMax":"xMin"]+(h?1:-1)}:{x:n.x,y:c[h?"yMax":"yMin"]+(h?1:-1)},-1<(x=E(b,l))&&(R(x=b[x],y.hardBounds),l[r]=h?C(c[r+"Max"]-M+1,(x[r+"Min"]+c[r+"Max"])/2):w(c[r+"Min"]+M-1,(x[r+"Max"]+c[r+"Min"])/2),p=n.x===l.x&&n.y===l.y&&(p&&(l[r]=h?C(c[r+"Max"],x[r+"Max"])+1:w(c[r+"Min"],x[r+"Min"])-1),!p)),o=[{start:n,end:l}]):(a=P(n,{x:(e?i:n).x,y:(e?n:i).y},e),o=[{start:n,end:{x:a.x,y:a.y}}],a[e?"x":"y"]!==i[e?"x":"y"]&&(h=v(a.obstacle,a,i,!e,d),R(a.obstacle,y.hardBounds),s={x:e?a.x:a.obstacle[h?"xMax":"xMin"]+(h?1:-1),y:e?a.obstacle[h?"yMax":"yMin"]+(h?1:-1):a.y},e=!e,o=o.concat(t({x:a.x,y:a.y},s,e)))),o=o.concat(t(o[o.length-1].end,i,!e))}(t,n,i)).concat(s.reverse())),obstacles:r}}i.requiresObstacles=n.requiresObstacles=!0;t={fastAvoid:i,straight:function(t,n){return{path:[["M",t.x,t.y],["L",n.x,n.y]],obstacles:[{start:t,end:n}]}},simpleConnect:n};return t}),n(t,"Gantt/Pathfinder.js",[t["Gantt/Connection.js"],t["Core/Chart/Chart.js"],t["Core/Defaults.js"],t["Core/Globals.js"],t["Core/Series/Point.js"],t["Core/Utilities.js"],t["Gantt/PathfinderAlgorithms.js"]],function(c,t,n,i,x,e,r){n=n.defaultOptions;const{addEvent:a,defined:h,error:o,extend:s,merge:l,pick:M,splat:d}=e,y=Math.max,p=Math.min;function g(t){var n=t.shapeArgs;return n?{xMin:n.x||0,xMax:(n.x||0)+(n.width||0),yMin:n.y||0,yMax:(n.y||0)+(n.height||0)}:(n=t.graphic&&t.graphic.getBBox())?{xMin:t.plotX-n.width/2,xMax:t.plotX+n.width/2,yMin:t.plotY-n.height/2,yMax:t.plotY+n.height/2}:null}function f(t){function s(t,n,i){var i=M(i,10),e=t.yMax+i>n.yMin-i&&t.yMin-i<n.yMax+i,r=t.xMax+i>n.xMin-i&&t.xMin-i<n.xMax+i,a=e?t.xMin>n.xMax?t.xMin-n.xMax:n.xMin-t.xMax:1/0,o=r?t.yMin>n.yMax?t.yMin-n.yMax:n.yMin-t.yMax:1/0;return r&&e?i?s(t,n,Math.floor(i/2)):1/0:p(a,o)}let n=t.length,i=0,e,r,a=[];for(;i<n;++i)for(e=i+1;e<n;++e)(r=s(t[i],t[e]))<80&&a.push(r);return a.push(80),y(Math.floor(a.sort(function(t,n){return t-n})[Math.floor(a.length/10)]/2-1),1)}s(n,{connectors:{type:"straight",lineWidth:1,marker:{enabled:!1,align:"center",verticalAlign:"middle",inside:!1,lineWidth:1},startMarker:{symbol:"diamond"},endMarker:{symbol:"arrow-filled"}}});class u{constructor(t){this.chart=void 0,this.chartObstacles=void 0,this.chartObstacleMetrics=void 0,this.connections=void 0,this.group=void 0,this.lineObstacles=void 0,this.init(t)}init(t){this.chart=t,this.connections=[],a(t,"redraw",function(){this.pathfinder.update()})}update(t){const r=this.chart,a=this,o=a.connections;a.connections=[],r.series.forEach(function(t){t.visible&&!t.options.isInternal&&t.points.forEach(function(n){const t=n.options;t&&t.dependency&&(t.connect=t.dependency);let i,e=n.options&&n.options.connect&&d(n.options.connect);n.visible&&!1!==n.isInside&&e&&e.forEach(function(t){(i=r.get("string"==typeof t?t:t.to))instanceof x&&i.series.visible&&i.visible&&!1!==i.isInside&&a.connections.push(new c(n,i,"string"==typeof t?{}:t))})})});for(let t=0,n,i,e=o.length,r=a.connections.length;t<e;++t){i=!1;const s=o[t];for(n=0;n<r;++n){const h=a.connections[n];if((s.options&&s.options.type)===(h.options&&h.options.type)&&s.fromPoint===h.fromPoint&&s.toPoint===h.toPoint){h.graphics=s.graphics,i=!0;break}}i||s.destroy()}delete this.chartObstacles,delete this.lineObstacles,a.renderConnections(t)}renderConnections(t){t?this.chart.series.forEach(function(i){function t(){const t=i.chart.pathfinder,n=t&&t.connections||[];n.forEach(function(t){t.fromPoint&&t.fromPoint.series===i&&t.render()}),i.pathfinderRemoveRenderEvent&&(i.pathfinderRemoveRenderEvent(),delete i.pathfinderRemoveRenderEvent)}!1===i.options.animation?t():i.pathfinderRemoveRenderEvent=a(i,"afterAnimate",t)}):this.connections.forEach(function(t){t.render()})}getChartObstacles(t){let a=[],o=this.chart.series,s=M(t.algorithmMargin,0),n;for(let r=0,t=o.length;r<t;++r)if(o[r].visible&&!o[r].options.isInternal)for(let t=0,n=o[r].points.length,i,e;t<n;++t)(e=o[r].points[t]).visible&&(i=g(e))&&a.push({xMin:i.xMin-s,xMax:i.xMax+s,yMin:i.yMin-s,yMax:i.yMax+s});return a=a.sort(function(t,n){return t.xMin-n.xMin}),h(t.algorithmMargin)||(n=t.algorithmMargin=f(a),a.forEach(function(t){t.xMin-=n,t.xMax+=n,t.yMin-=n,t.yMax+=n})),a}getObstacleMetrics(t){let n=0,i=0,e,r,a=t.length;for(;a--;)e=t[a].xMax-t[a].xMin,r=t[a].yMax-t[a].yMin,n<e&&(n=e),i<r&&(i=r);return{maxHeight:i,maxWidth:n}}getAlgorithmStartDirection(t){var n="left"!==t.align&&"right"!==t.align,t="top"!==t.verticalAlign&&"bottom"!==t.verticalAlign;return n?t&&void 0:t||void 0}}return u.prototype.algorithms=r,i.Pathfinder=u,s(x.prototype,{getPathfinderAnchorPoint:function(t){let n=g(this),i,e;switch(t.align){case"right":i="xMax";break;case"left":i="xMin"}switch(t.verticalAlign){case"top":e="yMin";break;case"bottom":e="yMax"}return{x:i?n[i]:(n.xMin+n.xMax)/2,y:e?n[e]:(n.yMin+n.yMax)/2}},getRadiansToVector:function(t,n){var i;return h(n)||(i=g(this))&&(n={x:(i.xMin+i.xMax)/2,y:(i.yMin+i.yMax)/2}),Math.atan2(n.y-t.y,t.x-n.x)},getMarkerVector:function(t,n,i){let e=2*Math.PI,r=t,a=g(this),o=a.xMax-a.xMin,s=a.yMax-a.yMin,h=Math.atan2(s,o),c,x=!1,l=o/2,M=s/2,d=a.xMin+l,y=a.yMin+M,p={x:d,y:y},f=1,u=1;for(;r<-Math.PI;)r+=e;for(;r>Math.PI;)r-=e;return c=Math.tan(r),r>-h&&r<=h?(u=-1,x=!0):r>h&&r<=Math.PI-h?u=-1:r>Math.PI-h||r<=-(Math.PI-h)?(f=-1,x=!0):f=-1,x?(p.x+=f*l,p.y+=u*l*c):(p.x+=f*(s/(2*c)),p.y+=u*M),i.x!==d&&(p.x=i.x),i.y!==y&&(p.y=i.y),{x:p.x+n*Math.cos(r),y:p.y-n*Math.sin(r)}}}),t.prototype.callbacks.push(function(t){!1!==t.options.connectors.enabled&&(((t=t).options.pathfinder||t.series.reduce(function(t,n){return n.options&&l(!0,n.options.connectors=n.options.connectors||{},n.options.pathfinder),t||n.options&&n.options.pathfinder},!1))&&(l(!0,t.options.connectors=t.options.connectors||{},t.options.pathfinder),o('WARNING: Pathfinder options have been renamed. Use "chart.connectors" or "series.connectors" instead.')),this.pathfinder=new u(this),this.pathfinder.update(!0))}),u}),n(t,"Extensions/ArrowSymbols.js",[t["Core/Utilities.js"]],function(i){const e=[];function r(t,n,i,e){return[["M",t,n+e/2],["L",t+i,n],["L",t,n+e/2],["L",t+i,n+e]]}function a(t,n,i,e){return r(t,n,i/2,e)}function o(t,n,i,e){return[["M",t+i,n],["L",t,n+e/2],["L",t+i,n+e],["Z"]]}function s(t,n,i,e){return o(t,n,i/2,e)}return{compose:function(t){if(i.pushUnique(e,t)){const n=t.prototype.symbols;n.arrow=r,n["arrow-filled"]=o,n["arrow-filled-half"]=s,n["arrow-half"]=a,n["triangle-left"]=o,n["triangle-left-half"]=s}}}}),n(t,"masters/modules/pathfinder.src.js",[t["Core/Globals.js"],t["Extensions/ArrowSymbols.js"]],function(t,n){n.compose(t.SVGRenderer)})});