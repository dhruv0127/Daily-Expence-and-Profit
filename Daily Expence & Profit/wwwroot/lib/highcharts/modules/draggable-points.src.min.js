!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/draggable-points",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function t(e,t,r,o){e.hasOwnProperty(t)||(e[t]=o.apply(null,r),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Extensions/DraggablePoints.js",[e["Core/Animation/AnimationUtilities.js"],e["Core/Chart/Chart.js"],e["Core/Globals.js"],e["Core/Series/Point.js"],e["Core/Series/Series.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(e,t,o,r,a,i,n){const s=e["animObject"],d=i["seriesTypes"],{addEvent:f,clamp:c,isNumber:x,merge:y,objectEach:D,pick:m}=n;function l(e){return{left:"right",right:"left",top:"bottom",bottom:"top"}[e]}function p(e){var t=(e=e.shapeArgs||e.graphic.getBBox()).r||0,r=e.height-t,e=e.height/2;return[["M",0,t],["L",0,e-5],["A",1,1,0,0,0,0,5+e],["A",1,1,0,0,0,0,e-5],["M",0,5+e],["L",0,r]]}e=a.prototype.dragDropProps={x:{axis:"x",move:!0},y:{axis:"y",move:!0}};d.flags&&(d.flags.prototype.dragDropProps=e);const g=d.column.prototype.dragDropProps={x:{axis:"x",move:!0},y:{axis:"y",move:!1,resize:!0,beforeResize:function(e,t,r){var o=m(r.yBottom,r.series.translatedThreshold),a=e.attr("y"),i=x(r.stackY)?r.stackY-(r.y||0):r.series.options.threshold||0,t=i+t.y;(r.series.yAxis.reversed?t<i:i<=t)?(r=e.attr("height"),e.attr({height:Math.max(0,Math.round(r+(o?o-a-r:0)))})):e.attr({y:Math.round(a+(o?o-a:0))})},resizeSide:function(e,t){const r=t.series.chart,o=r.dragHandles,a=e.y>=(t.series.options.threshold||0)?"top":"bottom",i=l(a);return o&&o[i]&&(o[i].destroy(),delete o[i]),a},handlePositioner:function(e){var t=e.shapeArgs||e.graphic&&e.graphic.getBBox()||{},r=e.series.yAxis.reversed,o=e.series.options.threshold||0,e=e.y||0;return{x:t.x||0,y:!r&&o<=e||r&&e<o?t.y||0:(t.y||0)+(t.height||0)}},handleFormatter:function(e){var e=e.shapeArgs||{},t=e.r||0,e=e.width||0,r=e/2;return[["M",t,0],["L",r-5,0],["A",1,1,0,0,0,5+r,0],["A",1,1,0,0,0,r-5,0],["M",5+r,0],["L",e-t,0]]}}};if(d.bullet&&(d.bullet.prototype.dragDropProps={x:g.x,y:g.y,target:{optionName:"draggableTarget",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){var t=e.targetGraphic.getBBox();return{x:e.barX,y:t.y+t.height/2}},handleFormatter:g.y.handleFormatter}}),d.columnrange&&(d.columnrange.prototype.dragDropProps={x:{axis:"x",move:!0},low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){e=e.shapeArgs||e.graphic.getBBox();return{x:e.x||0,y:(e.y||0)+(e.height||0)}},handleFormatter:g.y.handleFormatter,propValidate:function(e,t){return e<=t.high}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){e=e.shapeArgs||e.graphic.getBBox();return{x:e.x||0,y:e.y||0}},handleFormatter:g.y.handleFormatter,propValidate:function(e,t){return e>=t.low}}}),d.boxplot&&(d.boxplot.prototype.dragDropProps={x:g.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.lowPlot}},handleFormatter:g.y.handleFormatter,propValidate:function(e,t){return e<=t.q1}},q1:{optionName:"draggableQ1",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.q1Plot}},handleFormatter:g.y.handleFormatter,propValidate:function(e,t){return e<=t.median&&e>=t.low}},median:{axis:"y",move:!0},q3:{optionName:"draggableQ3",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.q3Plot}},handleFormatter:g.y.handleFormatter,propValidate:function(e,t){return e<=t.high&&e>=t.median}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x||0,y:e.highPlot}},handleFormatter:g.y.handleFormatter,propValidate:function(e,t){return e>=t.q3}}}),d.ohlc&&(d.ohlc.prototype.dragDropProps={x:g.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotLow}},handleFormatter:g.y.handleFormatter,propValidate:function(e,t){return e<=t.open&&e<=t.close}},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotHigh}},handleFormatter:g.y.handleFormatter,propValidate:function(e,t){return e>=t.open&&e>=t.close}},open:{optionName:"draggableOpen",axis:"y",move:!0,resize:!0,resizeSide:function(e){return e.open>=e.close?"top":"bottom"},handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotOpen}},handleFormatter:g.y.handleFormatter,propValidate:function(e,t){return e<=t.high&&e>=t.low}},close:{optionName:"draggableClose",axis:"y",move:!0,resize:!0,resizeSide:function(e){return e.open>=e.close?"bottom":"top"},handlePositioner:function(e){return{x:e.shapeArgs.x,y:e.plotClose}},handleFormatter:g.y.handleFormatter,propValidate:function(e,t){return e<=t.high&&e>=t.low}}}),d.arearange&&(i=d.columnrange.prototype.dragDropProps,n=function(e){e=e.graphic?e.graphic.getBBox().width/2+1:4;return[["M",0-e,0],["a",e,e,0,1,0,2*e,0],["a",e,e,0,1,0,-2*e,0]]},d.arearange.prototype.dragDropProps={x:i.x,low:{optionName:"draggableLow",axis:"y",move:!0,resize:!0,resizeSide:"bottom",handlePositioner:function(e){e=e.graphics&&e.graphics[0]&&e.graphics[0].getBBox();return e?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:-999,y:-999}},handleFormatter:n,propValidate:i.low.propValidate},high:{optionName:"draggableHigh",axis:"y",move:!0,resize:!0,resizeSide:"top",handlePositioner:function(e){e=e.graphics&&e.graphics[1]&&e.graphics[1].getBBox();return e?{x:e.x+e.width/2,y:e.y+e.height/2}:{x:-999,y:-999}},handleFormatter:n,propValidate:i.high.propValidate}}),d.waterfall&&(d.waterfall.prototype.dragDropProps={x:g.x,y:y(g.y,{handleFormatter:function(e){return e.isSum||e.isIntermediateSum?null:g.y.handleFormatter(e)}})}),d.xrange){const X=function(e,t){const r=e.series,o=r.xAxis,a=r.yAxis,i=r.chart.inverted,n=r.columnMetrics?r.columnMetrics.offset:-e.shapeArgs.height/2;let s=o.toPixels(e[t],!0),d=a.toPixels(e.y,!0);return i&&(s=o.len-s,d=a.len-d),d+=n,{x:Math.round(s),y:Math.round(d)}},Y=d.xrange.prototype.dragDropProps={y:{axis:"y",move:!0},x:{optionName:"draggableX1",axis:"x",move:!0,resize:!0,resizeSide:"left",handlePositioner:function(e){return X(e,"x")},handleFormatter:p,propValidate:function(e,t){return e<=t.x2}},x2:{optionName:"draggableX2",axis:"x",move:!0,resize:!0,resizeSide:"right",handlePositioner:function(e){return X(e,"x2")},handleFormatter:p,propValidate:function(e,t){return e>=t.x}}};d.gantt&&(d.gantt.prototype.dragDropProps={y:Y.y,start:y(Y.x,{optionName:"draggableStart",validateIndividualDrag:function(e){return!e.milestone}}),end:y(Y.x2,{optionName:"draggableEnd",validateIndividualDrag:function(e){return!e.milestone}})})}["gauge","pie","sunburst","wordcloud","sankey","histogram","pareto","vector","windbarb","treemap","bellcurve","sma","map","mapline"].forEach(function(e){d[e]&&(d[e].prototype.dragDropProps=null)});const v=2,h={default:{className:"highcharts-drag-box-default",lineWidth:1,lineColor:"#888",color:"rgba(0, 0, 0, 0.1)",cursor:"move",zIndex:900}},P={className:"highcharts-drag-handle",color:"#fff",lineColor:"rgba(0, 0, 0, 0.6)",lineWidth:1,zIndex:901};function u(e){let t=e.series?e.series.length:0;if(e.hasCartesianSeries&&!e.polar||e.mapView)for(;t--;)if(e.series[t].options.dragDrop&&function(e){const t=["draggableX","draggableY"];D(e.dragDropProps,function(e){e.optionName&&t.push(e.optionName)});let r=t.length;for(;r--;)if(e.options.dragDrop[t[r]])return 1}(e.series[t]))return 1}function w(e,t){return void 0===e.chartX||void 0===e.chartY?t.pointer.normalize(e):e}function b(t,e,r,o){const a=e.map(function(e){return f(t,e,r,o)});return function(){a.forEach(function(e){e()})}}function z(e,t){const r=function(t){const r=t.series,o=r.options.dragDrop.groupBy;let a=[];return r.boosted?r.options.data.forEach(function(e,t){a.push((new r.pointClass).init(r,e)),a[a.length-1].index=t}):a=r.points,t.options[o]?a.filter(function(e){return e.options[o]===t.options[o]}):[t]}(t),o=t.series,a=o.chart;let i;m(o.options.dragDrop&&o.options.dragDrop.liveRedraw,!0)||(a.dragGuideBox=i=o.getGuideBox(r),a.setGuideBoxState("default",o.options.dragDrop.guideBox).add(o.group)),a.dragDropData={origin:function(i,e,t){const r={chartX:i.chartX,chartY:i.chartY,guideBox:t&&{x:t.attr("x"),y:t.attr("y"),width:t.attr("width"),height:t.attr("height")},points:{}};return e.forEach(function(o){const a={};D(o.series.dragDropProps,function(e,t){const r=o.series[e.axis+"Axis"];a[t]=o[t],o.series.chart.mapView&&o.plotX&&o.plotY?a[t+"Offset"]="x"===t?o.plotX:o.plotY:a[t+"Offset"]=r.toPixels(o[t])-(r.horiz?i.chartX:i.chartY)}),a.point=o,r.points[o.id]=a}),r}(e,r,i),point:t,groupedPoints:r,isDragging:!0}}function H(e,t){var r=e.dragDropData.newPoints,t=s(t);e.isDragDropAnimating=!0,D(r,function(e){e.point.update(e.newValues,!1)}),e.redraw(t),setTimeout(function(){delete e.isDragDropAnimating,e.hoverPoint&&!e.dragHandles&&e.hoverPoint.showDragHandles()},t.duration)}function A(t,r,o){const a=t.series,i=a.chart,n=i.dragDropData,s=a.dragDropProps[n.updateProp],e=n.newPoints[t.id].newValues,d="function"==typeof s.resizeSide?s.resizeSide(e,t):s.resizeSide;s.beforeResize&&s.beforeResize(i.dragGuideBox,e,t);{var p=i.dragGuideBox,g=(t="x"===s.axis&&a.xAxis.reversed||"y"===s.axis&&a.yAxis.reversed?l(d):d,{x:"x"===s.axis?r-(n.origin.prevdX||0):0,y:"y"===s.axis?o-(n.origin.prevdY||0):0});let e;switch(t){case"left":e={x:p.attr("x")+g.x,width:Math.max(1,p.attr("width")-g.x)};break;case"right":e={width:Math.max(1,p.attr("width")+g.x)};break;case"top":e={y:p.attr("y")+g.y,height:Math.max(1,p.attr("height")-g.y)};break;case"bottom":e={height:Math.max(1,p.attr("height")+g.y)}}return void p.attr(e)}}function S(e){const t=e.series&&e.series.chart,r=t&&t.dragDropData;!t||!t.dragHandles||r&&(r.isDragging&&r.draggedPastSensitivity||r.isHoveringHandle===e.id)||t.hideDragHandles()}function B(e){let t=0;for(const r in e)Object.hasOwnProperty.call(e,r)&&t++;return t}function N(e){for(const t in e)if(Object.hasOwnProperty.call(e,t))return e[t]}function F(u,a){if(!a.zoomOrPanKeyPressed(u)){const p=a.dragDropData;let h,e,t,r,o;var i,n,s,d;p&&p.isDragging&&p.point.series&&(e=(h=p.point).series.options.dragDrop,u.preventDefault(),p.draggedPastSensitivity||(p.draggedPastSensitivity=(i=u,a=a,n=m(h.options.dragDrop&&h.options.dragDrop.dragSensitivity,e&&e.dragSensitivity,v),s=(a=a.dragDropData.origin).chartX,a=a.chartY,d=i.chartX,i=i.chartY,n<Math.sqrt((d-s)*(d-s)+(i-a)*(i-a)))),p.draggedPastSensitivity&&(p.newPoints=function(t,r){const e=t.point,o=e.series,a=o.chart,i=y(o.options.dragDrop,e.options.dragDrop),n={},s=t.updateProp,d={};return D(e.series.dragDropProps,function(e,t){s&&(s!==t||!e.resize||e.optionName&&!1===i[e.optionName])||(s||e.move&&("x"===e.axis&&i.draggableX||"y"===e.axis&&i.draggableY))&&(a.mapView?n["x"===t?"lon":"lat"]=e:n[t]=e)}),(s?[e]:t.groupedPoints).forEach(function(e){d[e.id]={point:e,newValues:e.getDropValues(t.origin,r,n)}}),d}(p,u),o=1===(r=B(t=p.newPoints))?N(t):null,h.firePointEvent("drag",{origin:p.origin,newPoints:p.newPoints,newPoint:o&&o.newValues,newPointId:o&&o.point.id,numNewPoints:r,chartX:u.chartX,chartY:u.chartY},function(){{var r=u,o=h;const a=o.series,i=a.chart,n=i.dragDropData,s=y(a.options.dragDrop,o.options.dragDrop),d=s.draggableX,p=s.draggableY,g=n.origin,l=n.updateProp;let e=r.chartX-g.chartX,t=r.chartY-g.chartY;return r=e,i.inverted&&(e=-t,t=-r),m(s.liveRedraw,!0)?(H(i,!1),o.showDragHandles()):l?A(o,e,t):i.dragGuideBox.translate(d?e:0,p?t:0),g.prevdX=e,void(g.prevdY=t)}})))}}function M(e,t){var r=t.dragDropData;if(r&&r.isDragging&&r.draggedPastSensitivity&&r.point.series){const o=r.point,a=r.newPoints,i=B(a),n=1===i?N(a):null;t.dragHandles&&t.hideDragHandles(),e.preventDefault(),t.cancelClick=!0,o.firePointEvent("drop",{origin:r.origin,chartX:e.chartX,chartY:e.chartY,newPoints:a,numNewPoints:i,newPoint:n&&n.newValues,newPointId:n&&n.point.id},function(){H(t)})}delete t.dragDropData,t.dragGuideBox&&(t.dragGuideBox.destroy(),delete t.dragGuideBox)}function V(e,t){const r=t.hoverPoint,o=y(r&&r.series.options.dragDrop,r&&r.options.dragDrop),a=o.draggableX||!1,i=o.draggableY||!1;t.cancelClick=!1,!a&&!i||t.zoomOrPanKeyPressed(e)||t.hasDraggedAnnotation||(t.dragDropData&&t.dragDropData.isDragging?M(e,t):r&&function(e){var t=e.series,r=t.chart,o=t.options.dragDrop||{},e=e.options&&e.options.dragDrop,a=t.dragDropProps;let i,n;return D(a,function(e){"x"===e.axis&&e.move?i=!0:"y"===e.axis&&e.move&&(n=!0)}),(o.draggableX&&i||o.draggableY&&n)&&(!e||!1!==e.draggableX||!1!==e.draggableY)&&(t.yAxis&&t.xAxis||r.mapView)}(r)&&(t.mouseIsDown=!1,z(e,r),r.firePointEvent("dragStart",e)))}t.prototype.setGuideBoxState=function(e,t){const r=this.dragGuideBox,o=y(h,t),a=y(o.default,o[e]);return r.attr({class:a.className,stroke:a.lineColor,strokeWidth:a.lineWidth,fill:a.color,cursor:a.cursor,zIndex:a.zIndex}).css({pointerEvents:"none"})},r.prototype.getDropValues=function(e,i,t){const n=this,s=n.series,p=s.chart,g=p.mapView,l=y(s.options.dragDrop,n.options.dragDrop),d={},h=e.points[n.id];let u;for(const r in t)if(Object.hasOwnProperty.call(t,r)){if(void 0!==u){u=!1;break}u=!0}return D(t,function(e,t){const r=h.point[t],o=s[e.axis+"Axis"],a=g?function(o,a,i){if(g){var n=m(l["dragPrecision"+a],0),s=g.pixelsToLonLat({x:0,y:0}),d=g.pixelsToLonLat({x:p.plotBox.width,y:p.plotBox.height});let e=m(l["dragMin"+a],s&&s[i],-1/0),t=m(l["dragMax"+a],d&&d[i],1/0),r=o[i];return"Orthographic"===g.projection.options.name?r:("lat"===i&&((isNaN(e)||e>g.projection.maxLatitude)&&(e=g.projection.maxLatitude),s=t=isNaN(t)||t<-1*g.projection.maxLatitude?-1*g.projection.maxLatitude:t,t=e,e=s),g.projection.hasCoordinates||(a=g.pixelsToLonLat({x:o.chartX-p.plotLeft,y:p.plotHeight-o.chartY+p.plotTop}))&&(r=a[i]),n&&(r=Math.round(r/n)*n),c(r,e,t))}}(i,e.axis.toUpperCase(),t):function(e,t){var r=s[t.toLowerCase()+"Axis"].categories?1:0,r=m(l["dragPrecision"+t],r),o=m(l["dragMin"+t],-1/0),t=m(l["dragMax"+t],1/0);let a=e;return r&&(a=Math.round(a/r)*r),c(a,o,t)}(o.toValue((o.horiz?i.chartX:i.chartY)+h[t+"Offset"]),e.axis.toUpperCase());!x(a)||u&&e.propValidate&&!e.propValidate(a,n)||void 0===r||(d[t]=a)}),d},a.prototype.getGuideBox=function(e){const t=this.chart;let a=1/0,i=-1/0,n=1/0,s=-1/0,d;return e.forEach(function(t){var r=t.graphic&&t.graphic.getBBox()||t.shapeArgs;if(r){let e;var o=t.x2,o=(x(o)&&(e=t.series.xAxis.translate(o,!1,!1,!1,!0)),!(r.width||r.height||r.x||r.y));d=!0,a=Math.min(t.plotX||0,e||0,o?1/0:r.x||0,a),i=Math.max(t.plotX||0,e||0,(r.x||0)+(r.width||0),i),n=Math.min(t.plotY||0,o?1/0:r.y||0,n),s=Math.max((r.y||0)+(r.height||0),s)}}),d?t.renderer.rect(a,n,i-a,s-n):t.renderer.g()},r.prototype.showDragHandles=function(){const l=this,h=l.series,u=h.chart,{inverted:c,renderer:x}=u,m=y(h.options.dragDrop,l.options.dragDrop);D(h.dragDropProps,function(e,a){const t=y(P,e.handleOptions,m.dragHandle),r={class:t.className,"stroke-width":t.lineWidth,fill:t.color,stroke:t.lineColor},o=t.pathFormatter||e.handleFormatter,i=e.handlePositioner,n=!e.validateIndividualDrag||e.validateIndividualDrag(l);let s,d,p;var g;e.resize&&n&&e.resizeSide&&o&&(m["draggable"+e.axis.toUpperCase()]||m[e.optionName])&&!1!==m[e.optionName]&&(u.dragHandles||(u.dragHandles={group:x.g("drag-drop-handles").add(h.markerGroup||h.group)}),u.dragHandles.point=l.id,s=i(l),r.d=p=o(l),g=l.series.xAxis.categories?-.5:0,!p||s.x<g||s.y<0||(r.cursor=t.cursor||("x"===e.axis!=!!c?"ew-resize":"ns-resize"),d=(d=u.dragHandles[e.optionName])||(u.dragHandles[e.optionName]=x.path().add(u.dragHandles.group)),r.translateX=c?h.yAxis.len-s.y:s.x,r.translateY=c?h.xAxis.len-s.x:s.y,c&&(r.rotation=-90),d.attr(r),b(d.element,["touchstart","mousedown"],function(e){{e=w(e,u);var t=l,r=a;const o=t.series.chart;return void(o.zoomOrPanKeyPressed(e)||(o.mouseIsDown=!1,z(e,t),o.dragDropData.updateProp=e.updateProp=r,t.firePointEvent("dragStart",e),e.stopPropagation(),e.preventDefault()))}},{passive:!1}),f(u.dragHandles.group.element,"mouseover",function(){u.dragDropData=u.dragDropData||{},u.dragDropData.isHoveringHandle=l.id}),b(u.dragHandles.group.element,["touchend","mouseout"],function(){{var e=l;const t=e.series.chart;return t.dragDropData&&e.id===t.dragDropData.isHoveringHandle&&delete t.dragDropData.isHoveringHandle,void(t.hoverPoint||S(e))}})))})},t.prototype.hideDragHandles=function(){var e=this;e.dragHandles&&(D(e.dragHandles,function(e,t){"group"!==t&&e.destroy&&e.destroy()}),e.dragHandles.group&&e.dragHandles.group.destroy&&e.dragHandles.group.destroy(),delete e.dragHandles)},f(r,"mouseOver",function(){const i=this;setTimeout(function(){{var e=i;const t=e.series,r=t&&t.chart,o=r&&r.dragDropData,a=r&&r.is3d&&r.is3d();return void(!r||o&&o.isDragging&&o.draggedPastSensitivity||r.isDragDropAnimating||!t.options.dragDrop||a||(r.dragHandles&&r.hideDragHandles(),e.showDragHandles()))}},12)}),f(r,"mouseOut",function(){const e=this;setTimeout(function(){e.series&&S(e)},10)}),f(r,"remove",function(){const e=this.series.chart,t=e.dragHandles;t&&t.point===this.id&&e.hideDragHandles()}),t.prototype.zoomOrPanKeyPressed=function(e){var t=this.options.chart||{},r=t.panKey&&t.panKey+"Key";return e[t.zooming.key&&t.zooming.key+"Key"]||e[r]},f(t,"render",function(){var t,e,r;this.hasAddedDragDropEvents||(e=(t=this).container,r=o.doc,u(t)&&(b(e,["mousedown","touchstart"],function(e){V(w(e,t),t)}),b(e,["mousemove","touchmove"],function(e){F(w(e,t),t)},{passive:!1}),f(e,"mouseleave",function(e){M(w(e,t),t)}),t.unbindDragDropMouseUp=b(r,["mouseup","touchend"],function(e){M(w(e,t),t)},{passive:!1}),t.hasAddedDragDropEvents=!0,f(t,"destroy",function(){t.unbindDragDropMouseUp&&t.unbindDragDropMouseUp()})))})}),t(e,"masters/modules/draggable-points.src.js",[],function(){})});