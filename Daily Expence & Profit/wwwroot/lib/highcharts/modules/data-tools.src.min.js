!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function t(e,t,o,s){e.hasOwnProperty(t)||(e[t]=s.apply(null,o),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Data/DataTable.js",[e["Core/Utilities.js"]],function(e){const{addEvent:o,fireEvent:t,uniqueKey:m}=e;class d{static isNull(o){if(o===d.NULL)return!0;if(o instanceof Array){if(!o.length)return!1;for(let e=0,t=o.length;e<t;++e)if(null!==o[e])return!1}else{var s=Object.keys(o);if(!s.length)return!1;for(let e=0,t=s.length;e<t;++e)if(null!==o[s[e]])return!1}return!0}constructor(e={}){this.aliasMap={},this.autoId=!e.id,this.columns={},this.id=e.id||m(),(this.modified=this).rowCount=0,this.versionTag=m();const r=e.columns||{},n=Object.keys(r),i=this.columns;let a=0;for(let e=0,t=n.length,o,s;e<t;++e)s=n[e],o=r[s].slice(),i[s]=o,a=Math.max(a,o.length);for(let e=0,t=n.length;e<t;++e)i[n[e]].length=a;this.rowCount=a;const s=e.aliasMap||{},l=Object.keys(s),u=this.aliasMap;for(let e=0,t=l.length,o;e<t;++e)o=l[e],u[o]=s[o]}clone(e,t){const o=this,s={},r=(o.emit({type:"cloneTable",detail:t}),e||(s.aliasMap=o.aliasMap,s.columns=o.columns),o.autoId||(s.id=o.id),new d(s));return e||(r.versionTag=o.versionTag),o.emit({type:"afterCloneTable",detail:t,tableClone:r}),r}deleteColumnAlias(e){const t=this,o=t.aliasMap,s=o[e],r=t.modifier;return s&&(delete t.aliasMap[e],r&&r.modifyColumns(t,{[s]:new Array(t.rowCount)},0)),s}deleteColumns(r,e){const t=this,n=t.columns,i={},a={},o=t.modifier,l=t.rowCount;if((r=r||Object.keys(n)).length){t.emit({type:"deleteColumns",columnNames:r,detail:e});for(let e=0,t=r.length,o,s;e<t;++e)s=r[e],(o=n[s])&&(i[s]=o,a[s]=new Array(l)),delete n[s];return Object.keys(n).length||(t.rowCount=0),o&&o.modifyColumns(t,a,0,e),t.emit({type:"afterDeleteColumns",columns:i,columnNames:r,detail:e}),i}}deleteRows(r,n=1,e){const i=this,a=[],l=[],t=i.modifier;if(i.emit({type:"deleteRows",detail:e,rowCount:n,rowIndex:r||0}),void 0===r&&(r=0,n=i.rowCount),0<n&&r<i.rowCount){var u=i.columns,m=Object.keys(u);for(let o=0,e=m.length,t,s;o<e;++o){s=(t=u[m[o]]).splice(r,n),o||(i.rowCount=t.length);for(let e=0,t=s.length;e<t;++e)a[e]=a[e]||[],a[e][o]=s[e];l.push(new Array(e))}}return t&&t.modifyRows(i,l,r||0,e),i.emit({type:"afterDeleteRows",detail:e,rowCount:n,rowIndex:r||0,rows:a}),a}emit(e){switch(e.type){case"afterDeleteColumns":case"afterDeleteRows":case"afterSetCell":case"afterSetColumns":case"afterSetRows":this.versionTag=m()}t(this,e.type,e)}getCell(e,t){e=this.aliasMap[e]||e;e=this.columns[e];if(e)return e[t]}getCellAsBoolean(e,t){e=this.aliasMap[e]||e;e=this.columns[e];return!(!e||!e[t])}getCellAsNumber(e,t,o){e=this.aliasMap[e]||e;e=this.columns[e];let s=e&&e[t];switch(typeof s){case"boolean":return s?1:0;case"number":return isNaN(s)&&!o?null:s}return s=parseFloat(""+s),isNaN(s)&&!o?null:s}getCellAsString(e,t){e=this.aliasMap[e]||e;e=this.columns[e];return""+(e&&e[t])}getColumn(e,t){return this.getColumns([e],t)[e]}getColumnAliases(){return Object.keys(this.aliasMap)}getColumnAsNumbers(t,e){const o=this.columns[t=this.aliasMap[t]||t],s=[];if(o){var r=o.length;if(e)for(let e=0;e<r;++e)s.push(this.getCellAsNumber(t,e,!0));else{for(let e=0,t;e<r;++e){if("number"==typeof(t=o[e]))return o.slice();if(null!=t)break}for(let e=0;e<r;++e)s.push(this.getCellAsNumber(t,e))}}return s}getColumnNames(){return Object.keys(this.columns)}getColumns(r,n){const i=this.aliasMap,a=this.columns,l={};for(let e=0,t=(r=r||Object.keys(a)).length,o,s;e<t;++e)s=r[e],(o=a[i[s]||s])&&(l[s]=n?o:o.slice());return l}getModifier(){return this.modifier}getRow(e,t){return this.getRows(e,1,t)[0]}getRowCount(){return this.rowCount}getRowIndexBy(e,t,o){e=this.aliasMap[e]||e;const s=this.columns[e];if(s){e=s.indexOf(t,o);if(-1!==e)return e}}getRowObject(e,t){return this.getRowObjects(e,1,t)[0]}getRowObjects(n=0,i=this.rowCount-n,a){const l=this.aliasMap,u=this.columns,m=new Array(i);a=a||Object.keys(u);for(let e=n,t=0,o=Math.min(this.rowCount,n+i),s,r;e<o;++e,++t){r=m[t]={};for(const d of a)s=u[l[d]||d],r[d]=s?s[e]:void 0}return m}getRows(n=0,i=this.rowCount-n,a){const l=this.aliasMap,u=this.columns,m=new Array(i);a=a||Object.keys(u);for(let e=n,t=0,o=Math.min(this.rowCount,n+i),s,r;e<o;++e,++t){r=m[t]=[];for(const d of a)s=u[l[d]||d],r.push(s?s[e]:void 0)}return m}getVersionTag(){return this.versionTag}hasColumns(s){var r=this.aliasMap,n=this.columns;for(let e=0,t=s.length,o;e<t;++e)if(!n[o=s[e]]&&!r[o])return!1;return!0}hasRowWith(e,t){e=this.aliasMap[e]||e;const o=this.columns[e];return!!o&&-1!==o.indexOf(t)}on(e,t){return o(this,e,t)}renameColumn(e,t){const o=this.columns;if(o[e]){if(e!==t){const s=this.aliasMap;s[t]&&delete s[t],o[t]=o[e],delete o[e]}return!0}return!1}setCell(e,t,o,s){const r=this,n=r.columns,i=r.modifier;e=r.aliasMap[e]||e;let a=n[e];a&&a[t]===o||(r.emit({type:"setCell",cellValue:o,columnName:e,detail:s,rowIndex:t}),a=a||(n[e]=new Array(r.rowCount)),t>=r.rowCount&&(r.rowCount=t+1),a[t]=o,i&&i.modifyCell(r,e,t,o),r.emit({type:"afterSetCell",cellValue:o,columnName:e,detail:s,rowIndex:t}))}setColumn(e,t=[],o=0,s){this.setColumns({[e]:t},o,s)}setColumnAlias(e,t){const o=this.aliasMap;return!o[e]&&(o[e]=t,!0)}setColumns(r,n,e){const i=this,a=i.columns,t=i.modifier,l=(i.rowCount,void 0===n),u=Object.keys(r);i.emit({type:"setColumns",columns:r,columnNames:u,detail:e,rowIndex:n});for(let e=0,t=u.length,o,s;e<t;++e)if(s=u[e],o=r[s],s=i.aliasMap[s]||s,l)a[s]=o.slice(),i.rowCount=o.length;else{const m=a[s]||(a[s]=new Array(i.rowCount));for(let e=n||0,t=o.length;e<t;++e)m[e]=o[e];i.rowCount=Math.max(i.rowCount,m.length)}var o=Object.keys(a);for(let e=0,t=o.length;e<t;++e)a[o[e]].length=i.rowCount;t&&t.modifyColumns(i,r,n||0),i.emit({type:"afterSetColumns",columns:r,columnNames:u,detail:e,rowIndex:n})}setModifier(t,o){const s=this;let e;return s.emit({type:"setModifier",detail:o,modifier:t,modified:s.modified}),(s.modified=s).modifier=t,(e=t?t.modify(s):Promise.resolve(s)).then(e=>(e.emit({type:"afterSetModifier",detail:o,modifier:t,modified:e.modified}),e)).catch(e=>{throw s.emit({type:"setModifierError",error:e,modifier:t,modified:s.modified}),e})}setRow(e,t,o){this.setRows([e],t,o)}setRows(t,o=this.rowCount,e){const s=this,n=s.aliasMap,i=s.columns,a=Object.keys(i),r=s.modifier,l=t.length;s.emit({type:"setRows",detail:e,rowCount:l,rowIndex:o,rows:t});for(let e=0,s=o,r;e<l;++e,++s)if((r=t[e])===d.NULL)for(let e=0,t=a.length;e<t;++e)i[a[e]][s]=null;else if(r instanceof Array)for(let e=0,t=a.length;e<t;++e)i[a[e]][s]=r[e];else{var u=Object.keys(r);for(let e=0,t=u.length,o;e<t;++e)o=n[o=u[e]]||o,i[o]||(i[o]=new Array(s+1)),i[o][s]=r[o]}var m=o+l;if(m>s.rowCount){s.rowCount=m;for(let e=0,t=a.length;e<t;++e)i[a[e]].length=m}r&&r.modifyRows(s,t,o),s.emit({type:"afterSetRows",detail:e,rowCount:l,rowIndex:o,rows:t})}}return d.NULL={},d}),t(e,"Data/Connectors/DataConnector.js",[e["Data/DataTable.js"],e["Core/Utilities.js"]],function(t,e){const{addEvent:o,fireEvent:s,merge:r,pick:n}=e;class i{constructor(e={}){this.table=new t(e.dataTable),this.metadata=e.metadata||{columns:{}}}describeColumn(e,t){const o=this.metadata.columns;o[e]=r(o[e]||{},t)}describeColumns(e){const t=Object.keys(e);for(var o;"string"==typeof(o=t.pop());)this.describeColumn(o,e[o])}emit(e){s(this,e.type,e)}getColumnOrder(e){const o=this.metadata.columns,t=Object.keys(o||{});if(t.length)return t.sort((e,t)=>n(o[e].index,0)-n(o[t].index,0))}getSortedColumns(e){return this.table.getColumns(this.getColumnOrder(e))}load(){return s(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(e,t){return o(this,e,t)}save(){return s(this,"saveError",{table:this.table}),Promise.reject(new Error("Not implemented"))}setColumnOrder(o){for(let e=0,t=o.length;e<t;++e)this.describeColumn(o[e],{index:e})}startPolling(e=1e3){const t=this;window.clearTimeout(t.polling),t.polling=window.setTimeout(()=>t.load().catch(e=>t.emit({type:"loadError",error:e,table:t.table})).then(()=>{t.polling&&t.startPolling(e)}),e)}stopPolling(){window.clearTimeout(this.polling),delete this.polling}whatIs(e){return this.metadata.columns[e]}}var a;return(a=i=i||{}).types={},a.registerType=function(e,t){return!!e&&!a.types[e]&&!!(a.types[e]=t)},i}),t(e,"Data/Converters/DataConverter.js",[e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,t){const{addEvent:o,fireEvent:s,isNumber:u,merge:r}=t;class n{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^([0-9]{4})([\-\.\/])([0-9]{1,2})\2([0-9]{1,2})$/,parser:function(e){return e?Date.UTC(+e[1],e[3]-1,+e[4]):NaN}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[3]-1,+e[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[1]-1,+e[3]):NaN}},"dd/mm/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(e){const t=new Date;if(!e)return NaN;let o=+e[4];return o>t.getFullYear()-2e3?o+=1900:o+=2e3,Date.UTC(o,e[3]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(e){return e?Date.UTC(+e[4]+2e3,e[1]-1,+e[3]):NaN}}};e=r(n.defaultOptions,e);let t=e.decimalPoint;"."!==t&&","!==t||(t="."===t?"\\.":",",this.decimalRegExp=new RegExp("^(-?[0-9]+)"+t+"([0-9]+)$")),this.options=e}asBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e:!!this.asNumber(e)}asDate(e){let t;if("string"==typeof e)t=this.parseDate(e);else if("number"==typeof e)t=e;else{if(e instanceof Date)return e;t=this.parseDate(this.asString(e))}return new Date(t)}asGuessedType(e){const t=this,o={number:t.asNumber,Date:t.asDate,string:t.asString};return o[t.guessType(e)].call(t,e)}asNumber(e){if("number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;if("string"!=typeof e)return e instanceof Date?e.getDate():e?e.getRowCount():NaN;{const t=this.decimalRegExp;if(-1<e.indexOf(" ")&&(e=e.replace(/\s+/g,"")),t){if(!t.test(e))return NaN;e=e.replace(t,"$1.$2")}return parseFloat(e)}}asString(e){return""+e}deduceDateFormat(e,t,o){const s=[],r=[];let n="YYYY/mm/dd",i,a=[],l=0,u=!1,m,d;for((!t||t>e.length)&&(t=e.length);l<t;l++)if(void 0!==e[l]&&e[l]&&e[l].length)for(i=e[l].trim().replace(/[-\.\/]/g," ").split(" "),a=["","",""],d=0;d<i.length;d++)d<a.length&&(m=parseInt(i[d],10))&&(r[d]=!r[d]||r[d]<m?m:r[d],void 0!==s[d]?s[d]!==m&&(s[d]=!1):s[d]=m,31<m?a[d]=m<100?"YY":"YYYY":12<m&&m<=31?(a[d]="dd",u=!0):a[d].length||(a[d]="mm"));if(u){for(d=0;d<s.length;d++)!1!==s[d]?12<r[d]&&"YY"!==a[d]&&"YYYY"!==a[d]&&(a[d]="YY"):12<r[d]&&"mm"===a[d]&&(a[d]="dd");3===a.length&&"dd"===a[1]&&"dd"===a[2]&&(a[2]="YY"),n=a.join("/")}return o&&(this.options.dateFormat=n),n}emit(e){s(this,e.type,e)}export(e,t){throw this.emit({type:"exportError",columns:[],headers:[]}),new Error("Not implemented")}getTable(){throw new Error("Not implemented")}guessType(t){let o="string";if("string"==typeof t){const r=this.trim(""+t),n=this.decimalRegExp;let e=this.trim(r,!0);n&&(e=n.test(e)?e.replace(n,"$1.$2"):"");var s=parseFloat(e);+e===s?t=s:(s=this.parseDate(t),o=u(s)?"Date":"string")}return o="number"==typeof t?31536e6<t?"Date":"number":o}on(e,t){return o(this,e,t)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),new Error("Not implemented")}parseDate(e,t){const o=this,s=o.options;let r=t||s.dateFormat,n=NaN,i,a,l;if(s.parseDate)n=s.parseDate(e);else{if(r)a=(a=o.dateFormats[r])||o.dateFormats["YYYY/mm/dd"],(l=e.match(a.regex))&&(n=a.parser(l));else for(i in o.dateFormats)if(a=o.dateFormats[i],l=e.match(a.regex)){r=i,n=a.parser(l);break}l||("object"==typeof(l=Date.parse(e))&&null!==l&&l.getTime?n=l.getTime()-6e4*l.getTimezoneOffset():u(l)&&(n=l-6e4*new Date(l).getTimezoneOffset(),-1===e.indexOf("2001")&&2001===new Date(n).getFullYear()&&(n=NaN)))}return n}trim(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[0-9\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}return n.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},(n||(n={})).getTableFromColumns=function(o=[],s=[]){const r=new e;for(let e=0,t=Math.max(s.length,o.length);e<t;++e)r.setColumn(s[e]||""+e,o[e]);return r},n}),t(e,"Data/DataCursor.js",[],function(){class d{constructor(e={}){this.emittingRegister=[],this.listenerMap={},this.stateMap=e}addListener(e,t,o){const s=this.listenerMap[e]=this.listenerMap[e]||{},r=s[t]=s[t]||[];return r.push(o),this}buildEmittingTag(e){return("position"===e.cursor.type?[e.table.id,e.cursor.column,e.cursor.row,e.cursor.state,e.cursor.type]:[e.table.id,e.cursor.columns,e.cursor.firstRow,e.cursor.lastRow,e.cursor.state,e.cursor.type]).join("\0")}emitCursor(t,o,s,r){const n=t.id,e=o.state,i=this.listenerMap[n]&&this.listenerMap[n][e];if(i){const a=this.stateMap[n]=this.stateMap[n]||{};let e=a[o.state];r&&(e=e||(a[o.state]=[]),-1===d.getIndex(o,e)&&e.push(o));const l={cursor:o,cursors:e||[],table:t},u=(s&&(l.event=s),this.emittingRegister),m=this.buildEmittingTag(l);if(0<=u.indexOf(m))return this;try{this.emittingRegister.push(m);for(let e=0,t=i.length;e<t;++e)i[e].call(this,l)}finally{r=this.emittingRegister.indexOf(m);0<=r&&this.emittingRegister.splice(r,1)}}return this}remitCursor(e,t){const o=this.stateMap[e]&&this.stateMap[e][t.state];return o&&0<=(e=d.getIndex(t,o))&&o.splice(e,1),this}removeListener(e,t,o){const s=this.listenerMap[e]&&this.listenerMap[e][t];return s&&(e=s.indexOf(o))&&s.splice(e,1),this}}function r(e,t){var o;if("range"===e.type)return e;const s={type:"range",firstRow:null!=(o=null!=(o=e.row)?o:t&&t.firstRow)?o:0,lastRow:null!=(o=null!=(o=e.row)?o:t&&t.lastRow)?o:Number.MAX_VALUE,state:e.state};return void 0!==e.column&&(s.columns=[e.column]),s}var e;return(e=d=d||{}).getIndex=function(s,r){if("position"===s.type){for(let e,t=0,o=r.length;t<o;++t)if("position"===(e=r[t]).type&&e.state===s.state&&e.column===s.column&&e.row===s.row)return t}else{var n=JSON.stringify(s.columns);for(let e,t=0,o=r.length;t<o;++t)if("range"===(e=r[t]).type&&e.state===s.state&&e.firstRow===s.firstRow&&e.lastRow===s.lastRow&&JSON.stringify(e.columns)===n)return t}return-1},e.isEqual=function(e,t){return"position"===e.type&&"position"===t.type?e.column===t.column&&e.row===t.row&&e.state===t.state:"range"===e.type&&"range"===t.type&&(e.firstRow===t.firstRow&&e.lastRow===t.lastRow&&JSON.stringify(e.columns)===JSON.stringify(t.columns))},e.isInRange=function(e,t){"position"===t.type&&(t=r(t));const o=(e="position"===e.type?r(e,t):e).columns,s=t.columns;return e.firstRow>=t.firstRow&&e.lastRow<=t.lastRow&&(!o||!s||o.every(e=>0<=s.indexOf(e)))},e.toPositions=function(t){if("position"===t.type)return[t];var s=t.columns||[];const r=[];var n=t.state;for(let o=t.firstRow,e=t.lastRow;o<e;++o)if(s.length)for(let e=0,t=s.length;e<t;++e)r.push({type:"position",column:s[e],row:o,state:n});else r.push({type:"position",row:o,state:n});return r},e.toRange=r,d}),t(e,"Data/Modifiers/DataModifier.js",[e["Core/Utilities.js"]],function(e){const{addEvent:o,fireEvent:t,merge:a}=e;class s{benchmark(e,t){const o=[],s=this,r=()=>{s.modifyTable(e),s.emit({type:"afterBenchmarkIteration"})};const n=a({iterations:1},t)["iterations"],i=(s.on("afterBenchmarkIteration",()=>{o.length===n?s.emit({type:"afterBenchmark",results:o}):r()}),{startTime:0,endTime:0});return s.on("modify",()=>{i.startTime=window.performance.now()}),s.on("afterModify",()=>{i.endTime=window.performance.now(),o.push(i.endTime-i.startTime)}),r(),o}emit(e){t(this,e.type,e)}modify(o,s){const r=this;return new Promise((e,t)=>{o.modified===o&&(o.modified=o.clone(!1,s));try{e(r.modifyTable(o,s))}catch(e){r.emit({type:"error",detail:s,table:o}),t(e)}})}modifyCell(e,t,o,s,r){return this.modifyTable(e)}modifyColumns(e,t,o,s){return this.modifyTable(e)}modifyRows(e,t,o,s){return this.modifyTable(e)}on(e,t){return o(this,e,t)}}var r;return(r=s=s||{}).types={},r.registerType=function(e,t){return!!e&&!r.types[e]&&!!(r.types[e]=t)},s}),t(e,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}}),t(e,"Data/DataPool.js",[e["Data/DataPoolDefaults.js"],e["Data/Connectors/DataConnector.js"]],function(t,n){return class{constructor(e=t){e.connectors=e.connectors||[],this.options=e,this.connectors={}}getConnector(e){var t=this.connectors[e];if(t)return Promise.resolve(t);t=this.getConnectorOptions(e);if(t)return this.loadConnector(t);throw new Error(`Connector not found. (${e})`)}getConnectorOptions(o){var s=this.options.connectors;for(let e=0,t=s.length;e<t;++e)if(s[e].name===o)return s[e]}getConnectorTable(e){return this.getConnector(e).then(e=>e.table)}loadConnector(r){return new Promise((e,t)=>{const o=n.types[r.type];if(!o)throw new Error(`Connector type not found. (${r.type})`);const s=new o(r.options);(this.connectors[r.name]=s).load().then(e).catch(t)})}setConnectorOptions(o){const s=this.options.connectors;for(let e=0,t=s.length;e<t;++e)if(s[e].name===o.name)return void s.splice(e,1,o);s.push(o)}}}),t(e,"Data/Converters/CSVConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,t){const g=t["merge"];class o extends e{constructor(e){e=g(o.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.dataTypes=[],this.options=e}export(e,t=this.options){var{useLocalDecimalPoint:o,lineDelimiter:s}=t,r=!1!==this.options.firstRowAsNames;let{decimalPoint:n,itemDelimiter:i}=t;n=n||(","!==i&&o?1.1.toLocaleString()[1]:"."),i=i||(","===n?";":",");const a=e.getSortedColumns(t.usePresentationOrder),l=Object.keys(a),u=[],m=l.length,d=[];r&&u.push(l.map(e=>`"${e}"`).join(i));for(let s=0;s<m;s++){var c=l[s],f=a[c],h=f.length,c=e.whatIs(c);let o;c&&(o=c.dataType);for(let t=0;t<h;t++){let e=f[t];if(d[t]||(d[t]=[]),"string"===o?e='"'+e+'"':"number"==typeof e?e=String(e).replace(".",n):"string"==typeof e&&(e=`"${e}"`),d[t][s]=e,s===m-1){let e=s;for(;2<d[t].length;){if(void 0!==d[t][e])break;d[t].pop(),e--}u.push(d[t].join(i))}}}return u.join(s)}parse(e,t){const s=this,o=s.dataTypes,r=g(this.options,e),{beforeParse:n,lineDelimiter:i,firstRowAsNames:a,itemDelimiter:l}=r;let u,m=0,{csv:d,startRow:c,endRow:f}=r,h;if(s.columns=[],s.emit({type:"parse",columns:s.columns,detail:t,headers:s.headers}),d=d&&n?n(d):d){if(u=d.replace(/\r\n|\r/g,"\n").split(i||"\n"),(!c||c<0)&&(c=0),(!f||f>=u.length)&&(f=u.length-1),l||(s.guessedItemDelimiter=s.guessDelimiter(u)),a){const p=u[0].split(l||s.guessedItemDelimiter||",");for(let e=0;e<p.length;e++)p[e]=p[e].replace(/^["']|["']$/g,"");s.headers=p,c++}let e=0;for(m=c;m<=f;m++)"#"===u[m][0]?e++:s.parseCSVRow(u[m],m-c-e);o.length&&o[0].length&&"date"===o[0][1]&&!s.options.dateFormat&&s.deduceDateFormat(s.columns[0],null,!0);for(let o=0,e=s.columns.length;o<e;++o)for(let t=0,e=(h=s.columns[o]).length;t<e;++t)if(h[t]&&"string"==typeof h[t]){let e=s.asGuessedType(h[t]);e instanceof Date&&(e=e.getTime()),s.columns[o][t]=e}}s.emit({type:"afterParse",columns:s.columns,detail:t,headers:s.headers})}parseCSVRow(t,o){const s=this,r=s.columns||[],n=s.dataTypes,{startColumn:i,endColumn:a}=s.options,e=s.options.itemDelimiter||s.guessedItemDelimiter;let l=s.options["decimalPoint"],u=(l&&l!==e||(l=s.guessedDecimalPoint||"."),0),m="",d="",c="",f="",h=0,p=0;var g=e=>{m=t[e],d=t[e-1],c=t[e+1]};const y=e=>{n.length<p+1&&n.push([e]),n[p][n[p].length-1]!==e&&n[p].push(e)};var C=()=>{if(i>h||h>a)return++h,void(f="");var e;"string"==typeof f?!isNaN(parseFloat(f))&&isFinite(f)?(f=parseFloat(f),y("number")):isNaN(Date.parse(f))?y("string"):(f=f.replace(/\//g,"-"),y("date")):y("number"),r.length<p+1&&r.push([]),"number"!=typeof f&&"number"!==s.guessType(f)&&l&&(f=(e=f).replace(l,"."),"number"!==s.guessType(f)&&(f=e)),r[p][o]=f,f="",++p,++h};if(t.trim().length&&"#"!==t.trim()[0]){for(;u<t.length;u++){if(g(u),"#"===m&&!/^#[0-F]{3,3}|[0-F]{6,6}/i.test(t.substring(u)))return void C();if('"'===m)for(g(++u);u<t.length&&('"'!==m||'"'===d||'"'===c);)('"'!==m||'"'===m&&'"'!==d)&&(f+=m),g(++u);else m===e?C():f+=m}C()}}guessDelimiter(i){let a=0,l=0,e;const u={",":0,";":0,"\t":0},t=i.length;for(let e=0;e<t;e++){let t=!1,o,s,r,n="";if(13<e)break;var m=i[e];for(let e=0;e<m.length&&(o=m[e],s=m[e+1],r=m[e-1],"#"!==o);e++){if('"'===o)if(t){if('"'!==r&&'"'!==s){for(;" "===s&&e<m.length;)s=m[++e];void 0!==u[s]&&u[s]++,t=!1}}else t=!0;else void 0!==u[o]?(n=n.trim(),isNaN(Date.parse(n))&&!isNaN(Number(n))&&isFinite(Number(n))||u[o]++,n=""):n+=o;","===o&&l++,"."===o&&a++}}return e=u[";"]>u[","]?";":(u[","],u[";"],","),a>l?this.guessedDecimalPoint=".":this.guessedDecimalPoint=",",e}getTable(){return e.getTableFromColumns(this.columns,this.headers)}}return o.defaultOptions=Object.assign(Object.assign({},e.defaultOptions),{lineDelimiter:"\n"}),o}),t(e,"Data/Connectors/CSVConnector.js",[e["Data/Converters/CSVConverter.js"],e["Data/Connectors/DataConnector.js"],e["Core/Utilities.js"]],function(t,e,o){const s=o["merge"];class r extends e{constructor(e){e=s(r.defaultOptions,e);super(e),this.converter=new t(e),(this.options=e).enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){const o=this,e=o.converter,s=o.table,{csv:r,csvURL:n}=o.options;if(r)s.deleteRows(),o.emit({type:"load",csv:r,detail:t,table:s}),e.parse({csv:r}),s.setColumns(e.getTable().getColumns()),o.emit({type:"afterLoad",csv:r,detail:t,table:s});else{if(n)return o.table.deleteColumns(),o.emit({type:"load",detail:t,table:o.table}),fetch(n||"").then(e=>e.text().then(e=>{o.converter.parse({csv:e}),o.table.setColumns(o.converter.getTable().getColumns()),o.emit({type:"afterLoad",csv:e,detail:t,table:o.table})})).catch(e=>(o.emit({type:"loadError",detail:t,error:e,table:o.table}),Promise.reject(e))).then(()=>o);o.emit({type:"loadError",detail:t,error:"Unable to load: no CSV string or URL was provided",table:s})}return Promise.resolve(o)}}return r.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1},e.registerType("CSV",r),r}),t(e,"Data/Converters/GoogleSheetsConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,t){const{merge:o,uniqueKey:a}=t;class s extends e{constructor(e){e=o(s.defaultOptions,e);super(e),this.columns=[],this.header=[],this.options=e}parse(e,t){const s=this,r=o(s.options,e),n=(r.json&&r.json.values||[]).map(e=>e.slice());if(0===n.length)return!1;s.header=[],s.columns=[],s.emit({type:"parse",columns:s.columns,detail:t,headers:s.header});let i;for(let o=0,e=(s.columns=n).length;o<e;o++){i=n[o],s.header[o]=r.firstRowAsNames?""+i.shift():a();for(let t=0,e=i.length;t<e;++t)if(i[t]&&"string"==typeof i[t]){let e=s.asGuessedType(i[t]);e instanceof Date&&(e=e.getTime()),s.columns[o][t]=e}}s.emit({type:"afterParse",columns:s.columns,detail:t,headers:s.header})}getTable(){return e.getTableFromColumns(this.columns,this.header)}}return s.defaultOptions=Object.assign({},e.defaultOptions),s}),t(e,"Data/Connectors/GoogleSheetsConnector.js",[e["Data/Connectors/DataConnector.js"],e["Data/Converters/GoogleSheetsConverter.js"],e["Core/Utilities.js"]],function(e,t,o){const{merge:s,pick:n}=o;class l extends e{constructor(e){e=s(l.defaultOptions,e);super(e),this.converter=new t(e),this.options=e}load(o){const s=this,{dataRefreshRate:r,enablePolling:n,firstRowAsNames:i,googleAPIKey:e,googleSpreadsheetKey:t}=s.options,a=l.buildFetchURL(e,t,s.options);return s.table.deleteColumns(),s.emit({type:"load",detail:o,table:s.table,url:a}),fetch(a).then(e=>e.json().then(e=>{if("object"==typeof(t=e)&&t&&"object"==typeof t.error&&t.error&&"number"==typeof t.error.code&&"string"==typeof t.error.message&&"string"==typeof t.error.status)throw new Error(e.error.message);var t;s.converter.parse({firstRowAsNames:i,json:e}),s.table.setColumns(s.converter.getTable().getColumns()),s.emit({type:"afterLoad",detail:o,table:s.table,url:a}),n&&setTimeout(()=>s.load(),1e3*Math.max(r||0,1))})).catch(e=>(s.emit({type:"loadError",detail:o,error:e,table:s.table}),Promise.reject(e))).then(()=>s)}}l.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",worksheet:1,enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0};{o=l=l||{};const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function r(e={}){var{endColumn:e,endRow:t,googleSpreadsheetRange:o,startColumn:s,startRow:r}=e;return o||(i[s||0]||"A")+(Math.max(r||0,0)+1)+":"+(i[n(e,25)]||"Z")+(t?Math.max(t,0):"Z")}o.buildFetchURL=function(e,t,o={}){return`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/`+(o.onlyColumnNames?"A1:Z1":r(o))+"?alt=json"+(o.onlyColumnNames?"":"&dateTimeRenderOption=FORMATTED_STRING&majorDimension=COLUMNS&valueRenderOption=UNFORMATTED_VALUE")+"&prettyPrint=false&key="+e},o.buildQueryRange=r}return e.registerType("GoogleSheets",l),l}),t(e,"Data/Converters/HTMLTableConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(e,t){const o=t["merge"];class s extends e{constructor(e){e=o(s.defaultOptions,e);super(e),this.columns=[],this.headers=[],(this.options=e).tableElement&&(this.tableElement=e.tableElement,this.tableElementID=e.tableElement.id)}export(e,t=this.options){var o=!1!==t.firstRowAsNames,s=t.useMultiLevelHeaders;const r=e.getSortedColumns(t.usePresentationOrder),n=Object.keys(r),i=[],a=n.length,l=[];let u="";if(o){const p=[];if(s){for(const g of n){var m=(r[g].shift()||"").toString();p.push(m)}u=this.getTableHeaderHTML(n,p,t)}else u=this.getTableHeaderHTML(void 0,n,t)}for(let o=0;o<a;o++){var d=n[o],c=r[d],f=c.length;for(let t=0;t<f;t++){let e=c[t];l[t]||(l[t]=[]),"string"!=typeof e&&"number"!=typeof e&&void 0!==e&&(e=(e||"").toString()),l[t][o]=this.getCellHTMLFromValue(o?"td":"th",null,o?"":'scope="row"',e),o===a-1&&i.push("<tr>"+l[t].join("")+"</tr>")}}let h="";return"<table>"+(h=t.tableCaption?'<caption class="highcharts-table-caption">'+t.tableCaption+"</caption>":h)+u+"<tbody>"+i.join("")+"</tbody></table>"}getCellHTMLFromValue(e,t,o,s,r){let n=s,i="text"+(t?" "+t:"");return"number"==typeof n?(n=n.toString(),","===r&&(n=n.replace(".",r)),i="number"):s||(n="",i="empty"),"<"+e+(o?" "+o:"")+' class="'+i+'">'+n+"</"+e+">"}getTableHeaderHTML(e=[],t=[],o=this.options){var{useMultiLevelHeaders:s,useRowspanHeaders:r}=o;o.useLocalDecimalPoint&&1.1.toLocaleString()[1];let n="<thead>",i=0,a=t&&t.length,l,u=0,m;if(s&&e&&t&&!function(e,t){let o=e.length;if(t.length===o){for(;--o;)if(e[o]!==t[o])return;return 1}}(e,t)){for(n+="<tr>";i<a;++i)(l=e[i])===e[i+1]?++u:u?(n+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(u+1)+'"',l),u=0):(l===t[i]?r?(m=2,delete t[i]):(m=1,t[i]=""):m=1,n+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(1<m?' valign="top" rowspan="'+m+'"':""),l));n+="</tr>"}if(t){for(n+="<tr>",i=0,a=t.length;i<a;++i)void 0!==t[i]&&(n+=this.getCellHTMLFromValue("th",null,'scope="col"',t[i]));n+="</tr>"}return n+="</thead>"}parse(e,t){const n=this,i=[],a=[],l=o(n.options,e),{endRow:u,startColumn:m,endColumn:d,firstRowAsNames:c}=l,f=l.tableElement||this.tableElement;if(f instanceof HTMLElement){n.tableElement=f,n.tableElementID=f.id,this.emit({type:"parse",columns:n.columns,detail:t,headers:n.headers});var h=f.getElementsByTagName("tr"),p=h.length;let o=0,s,r=l["startRow"];if(c&&p){var g=h[0].children,y=g.length;for(let e=m;e<y&&!(e>d);e++)"TD"!==(s=g[e]).tagName&&"TH"!==s.tagName||a.push(s.innerHTML);r++}for(;o<p;){if(o>=r&&o<=u){var C=h[o].children,b=C.length;let e=0;for(;e<b;){const w=e-m,v=i[w];if(("TD"===(s=C[e]).tagName||"TH"===s.tagName)&&e>=m&&e<=d){i[w]||(i[w]=[]);let e=n.asGuessedType(s.innerHTML),t=(e instanceof Date&&(e=e.getTime()),i[w][o-r]=e,1);for(;o-r>=t&&void 0===v[o-r-t];)v[o-r-t]=null,t++}e++}}o++}this.columns=i,this.headers=a,this.emit({type:"afterParse",columns:i,detail:t,headers:a})}else n.emit({type:"parseError",columns:i,detail:t,headers:a,error:"Not a valid HTML Table"})}getTable(){return e.getTableFromColumns(this.columns,this.headers)}}return s.defaultOptions=Object.assign(Object.assign({},e.defaultOptions),{useRowspanHeaders:!0,useMultiLevelHeaders:!0}),s}),t(e,"Data/Connectors/HTMLTableConnector.js",[e["Data/Connectors/DataConnector.js"],e["Core/Globals.js"],e["Data/Converters/HTMLTableConverter.js"],e["Core/Utilities.js"]],function(e,t,o,s){const r=t["win"],n=s["merge"];class i extends e{constructor(e){e=n(i.defaultOptions,e);super(e),this.converter=new o(e),this.options=e}load(e){var t=this,o=(t.table.deleteColumns(),t.emit({type:"load",detail:e,table:t.table,tableElement:t.tableElement}),t.options)["table"];let s;return"string"==typeof o?(t.tableID=o,s=r.document.getElementById(o)):(s=o,t.tableID=s.id),t.tableElement=s||void 0,t.tableElement?(t.converter.parse(n({tableElement:t.tableElement},t.options),e),t.table.setColumns(t.converter.getTable().getColumns()),t.emit({type:"afterLoad",detail:e,table:t.table,tableElement:t.tableElement}),Promise.resolve(this)):(t.emit({type:"loadError",detail:e,error:o="HTML table not provided, or element with ID not found",table:t.table}),Promise.reject(new Error(o)))}}return i.defaultOptions={table:""},e.registerType("HTMLTable",i),i}),t(e,"Data/Modifiers/ChainModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(n,e){const t=e["merge"];class o extends n{constructor(e,...s){super(),this.chain=s,this.options=t(o.defaultOptions,e);var r=this.options.chain||[];for(let e=0,t=r.length,o;e<t;++e)(o=n.types[r[e].modifier])&&s.unshift(new o(r[e]))}add(e,t){this.emit({type:"addModifier",detail:t,modifier:e}),this.chain.push(e),this.emit({type:"addModifier",detail:t,modifier:e})}clear(e){this.emit({type:"clearChain",detail:e}),this.chain.length=0,this.emit({type:"afterClearChain",detail:e})}modify(t,o){var s=this.options.reverse?this.chain.slice().reverse():this.chain.slice();let r=Promise.resolve(t);for(let e=0,t=s.length;e<t;++e){const n=s[e];r=r.then(e=>n.modify(e.modified,o))}return r=(r=r.then(e=>(t.modified=e.modified,t))).catch(e=>{throw this.emit({type:"error",detail:o,table:t}),e})}modifyCell(e,s,r,n,i){const a=this.options.reverse?this.chain.reverse():this.chain;if(a.length){let o=e.clone();for(let e=0,t=a.length;e<t;++e)a[e].modifyCell(o,s,r,n,i),o=o.modified;e.modified=o}return e}modifyColumns(e,s,r,n){const i=this.options.reverse?this.chain.reverse():this.chain.slice();if(i.length){let o=e.clone();for(let e=0,t=i.length;e<t;++e)i[e].modifyColumns(o,s,r,n),o=o.modified;e.modified=o}return e}modifyRows(e,s,r,n){const i=this.options.reverse?this.chain.reverse():this.chain.slice();if(i.length){let o=e.clone();for(let e=0,t=i.length;e<t;++e)i[e].modifyRows(o,s,r,n),o=o.modified;e.modified=o}return e}modifyTable(e,s){var t=this,r=(t.emit({type:"modify",detail:s,table:e}),t.options.reverse?t.chain.reverse():t.chain.slice());let n=e.modified;for(let e=0,t=r.length,o;e<t;++e)o=r[e],n=o.modifyTable(n,s).modified;return e.modified=n,t.emit({type:"afterModify",detail:s,table:e}),e}remove(e,t){const o=this.chain;this.emit({type:"removeModifier",detail:t,modifier:e}),o.splice(o.indexOf(e),1),this.emit({type:"afterRemoveModifier",detail:t,modifier:e})}}return o.defaultOptions={modifier:"Chain"},n.registerType("Chain",o),o}),t(e,"Data/Modifiers/InvertModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(e,t){const o=t["merge"];class s extends e{constructor(e){super(),this.options=o(s.defaultOptions,e)}modifyCell(e,t,o,s,r){const n=e.modified,i=n.getRowIndexBy("columnNames",t);return void 0===i?n.setColumns(this.modifyTable(e.clone()).getColumns(),void 0,r):n.setCell(""+o,i,s,r),e}modifyColumns(e,n,i,a){const l=e.modified,o=l.getColumn("columnNames")||[];let u=e.getColumnNames(),s=e.getRowCount()!==o.length;if(!s)for(let e=0,t=u.length;e<t;++e)if(u[e]!==o[e]){s=!0;break}if(s)return this.modifyTable(e,a);for(let e=0,t=(u=Object.keys(n)).length,s,o,r;e<t;++e){s=n[o=u[e]],r=l.getRowIndexBy("columnNames",o)||l.getRowCount();for(let e=0,t=i,o=s.length;e<o;++e,++t)l.setCell(""+t,r,s[e],a)}return e}modifyRows(e,r,n,i){const a=e.getColumnNames(),l=e.modified,o=l.getColumn("columnNames")||[];let s=e.getRowCount()!==o.length;if(!s)for(let e=0,t=a.length;e<t;++e)if(a[e]!==o[e]){s=!0;break}if(s)return this.modifyTable(e,i);for(let e=0,o=n,t=r.length,s;e<t;++e,++o)if((s=r[e])instanceof Array)l.setColumn(""+o,s);else for(let e=0,t=a.length;e<t;++e)l.setCell(""+o,e,s[a[e]],i);return e}modifyTable(s,e){this.emit({type:"modify",detail:e,table:s});const t=s.modified;if(s.hasColumns(["columnNames"])){const r=((s.deleteColumns(["columnNames"])||{}).columnNames||[]).map(e=>""+e),n={};for(let e=0,t=s.getRowCount(),o;e<t;++e)(o=s.getRow(e))&&(n[r[e]]=o);t.deleteColumns(),t.setColumns(n)}else{const i={};for(let e=0,t=s.getRowCount(),o;e<t;++e)(o=s.getRow(e))&&(i[""+e]=o);i.columnNames=s.getColumnNames(),t.deleteColumns(),t.setColumns(i)}return this.emit({type:"afterModify",detail:e,table:s}),s}}return s.defaultOptions={modifier:"Invert"},e.registerType("Invert",s),s}),t(e,"Data/Modifiers/RangeModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(e,t){const o=t["merge"];class s extends e{constructor(e){super(),this.options=o(s.defaultOptions,e)}modifyTable(i,e){this.emit({type:"modify",detail:e,table:i});var{ranges:o,strict:a}=this.options;if(o.length){const l=i.getColumns(),u=[],t=i.modified;for(let e=0,t=o.length,r,n;e<t;++e)if(r=o[e],!a||typeof r.minValue==typeof r.maxValue)for(let e=0,t=(n=l[r.column]||[]).length,o,s;e<t;++e){switch(typeof(o=n[e])){default:continue;case"boolean":case"number":case"string":}a&&typeof o!=typeof r.minValue||o>=r.minValue&&o<=r.maxValue&&(s=i.getRow(e))&&u.push(s)}t.deleteRows(),t.setRows(u)}return this.emit({type:"afterModify",detail:e,table:i}),i}}return s.defaultOptions={modifier:"Range",strict:!1,ranges:[]},e.registerType("Range",s),s}),t(e,"Data/Modifiers/SortModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(e,a,t){const o=t["merge"];class f extends e{static ascending(e,t){return(e||0)<(t||0)?-1:(t||0)<(e||0)?1:0}static descending(e,t){return(t||0)<(e||0)?-1:(e||0)<(t||0)?1:0}constructor(e){super(),this.options=o(f.defaultOptions,e)}modifyCell(e,t,o,s,r){var{orderByColumn:n,orderInColumn:i}=this.options;return t===n&&(i?(e.modified.setCell(t,o,s),e.modified.setColumn(i,this.modifyTable(new a({columns:e.getColumns([n,i])})).modified.getColumn(i))):this.modifyTable(e,r)),e}modifyColumns(e,t,o,s){const{orderByColumn:r,orderInColumn:n}=this.options,i=Object.keys(t);return-1<i.indexOf(r)&&(n&&t[i[0]].length?(e.modified.setColumns(t,o),e.modified.setColumn(n,this.modifyTable(new a({columns:e.getColumns([r,n])})).modified.getColumn(n))):this.modifyTable(e,s)),e}modifyRows(e,t,o,s){var{orderByColumn:r,orderInColumn:n}=this.options;return n&&t.length?(e.modified.setRows(t,o),e.modified.setColumn(n,this.modifyTable(new a({columns:e.getColumns([r,n])})).modified.getColumn(n))):this.modifyTable(e,s),e}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});const o=e.getColumnNames(),s=e.getRowCount(),r=e.getRows().map((e,t)=>({index:t,row:e})),{direction:n,orderByColumn:i,orderInColumn:a}=this.options,l="asc"===n?f.ascending:f.descending,u=o.indexOf(i),m=e.modified;if(-1!==u&&r.sort((e,t)=>l(e.row[u],t.row[u])),a){const d=[];for(let e=0;e<s;++e)d[r[e].index]=e;m.setColumns({[a]:d})}else{const c=[];for(let e=0;e<s;++e)c.push(r[e].row);m.setRows(c,0)}return this.emit({type:"afterModify",detail:t,table:e}),e}}return f.defaultOptions={modifier:"Sort",direction:"desc",orderByColumn:"y"},e.registerType("Sort",f),f}),t(e,"masters/modules/data-tools.src.js",[e["Core/Globals.js"],e["Data/Connectors/DataConnector.js"],e["Data/Converters/DataConverter.js"],e["Data/DataCursor.js"],e["Data/Modifiers/DataModifier.js"],e["Data/DataPool.js"],e["Data/DataTable.js"]],function(e,t,o,s,r,n,i){const a=e;a.DataConnector=t,a.DataConverter=o,a.DataCursor=s,a.DataModifier=r,a.DataPool=n,a.DataTable=i})});