!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/modules/treegraph",["highcharts","highcharts/modules/treemap"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(e){"use strict";e=e?e._modules:{};function t(e,t,i,o){e.hasOwnProperty(t)||(e[t]=o.apply(null,i),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:e[t]}})))}t(e,"Series/PathUtilities.js",[],function(){function h(t,i){const o=[];for(let e=0;e<t.length;e++){var s,r,n,a,l,h,d=t[e][1],p=t[e][2];"number"==typeof d&&"number"==typeof p&&(0===e?o.push(["M",d,p]):e!==t.length-1&&i?(r=t[e-1],a=t[e+1],r&&a&&(s=r[1],r=r[2],n=a[1],a=a[2],"number"==typeof s&&"number"==typeof n&&"number"==typeof r&&"number"==typeof a&&s!==n&&r!==a&&(l=s<n?1:-1,h=r<a?1:-1,o.push(["L",d-l*Math.min(Math.abs(d-s),i),p-h*Math.min(Math.abs(p-r),i)],["C",d,p,d,p,d+l*Math.min(Math.abs(d-n),i),p+h*Math.min(Math.abs(p-a),i)])))):o.push(["L",d,p]))}return o}return{applyRadius:h,getLinkPath:{default:function(e){var{x1:e,y1:t,x2:i,y2:o,width:s=0,inverted:r=!1,radius:n,parentVisible:a}=e,l=[["M",e,t],["L",e,t],["C",e,t,e,o,e,o],["L",e,o],["C",e,t,e,o,e,o],["L",e,o]];return a?h([["M",e,t],["L",e+s*(r?-.5:.5),t],["L",e+s*(r?-.5:.5),o],["L",i,o]],n):l},straight:function(e){var{x1:e,y1:t,x2:i,y2:o,width:s=0,inverted:r=!1,parentVisible:n}=e;return n?[["M",e,t],["L",e+s*(r?-1:1),o],["L",i,o]]:[["M",e,t],["L",e,o],["L",e,o]]},curved:function(e){var{x1:e,y1:t,x2:i,y2:o,offset:s=0,width:r=0,inverted:n=!1,parentVisible:a}=e;return a?[["M",e,t],["C",e+s,t,e-s+r*(n?-1:1),o,e+r*(n?-1:1),o],["L",i,o]]:[["M",e,t],["C",e,t,e,o,e,o],["L",i,o]]}}}}),t(e,"Series/Treegraph/TreegraphNode.js",[e["Core/Series/SeriesRegistry.js"]],function(e){var{prototype:{NodeClass:e}}=e["seriesTypes"]["treemap"];class t extends e{constructor(){super(...arguments),this.mod=0,this.shift=0,this.change=0,this.children=[],this.preX=0,this.hidden=!1,this.wasVisited=!1,this.collapsed=!1}nextLeft(){return this.getLeftMostChild()||this.thread}nextRight(){return this.getRightMostChild()||this.thread}getAncestor(e,t){return e.ancestor.children[0]===this.children[0]?e.ancestor:t}getLeftMostSibling(){var e=this.getParent();if(e)for(const t of e.children)if(t&&t.point.visible)return t}hasChildren(){var t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return!0;return!1}getLeftSibling(){var e=this.getParent();if(e){var t=e.children;for(let e=this.relativeXPosition-1;0<=e;e--)if(t[e]&&t[e].point.visible)return t[e]}}getLeftMostChild(){var t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return t[e]}getRightMostChild(){var t=this.children;for(let e=t.length-1;0<=e;e--)if(t[e].point.visible)return t[e]}getParent(){return this.parentNode}getFirstChild(){var t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return t[e]}}return t}),t(e,"Series/Treegraph/TreegraphPoint.js",[e["Core/Series/Point.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(e,t,i){var{prototype:{pointClass:t}}=t["seriesTypes"]["treemap"];const{addEvent:o,fireEvent:s,merge:u,pick:r}=i;class n extends t{constructor(){super(...arguments),this.options=void 0,this.isLink=!1,this.series=void 0,this.node=void 0,this.setState=e.prototype.setState}draw(){super.draw.apply(this,arguments);let e=this.graphic;e&&e.animate({visibility:this.visible?"inherit":"hidden"}),this.renderCollapseButton()}renderCollapseButton(){const e=this,t=e.series,i=e.graphic&&e.graphic.parentGroup,o=t.mapOptionsToLevel[e.node.level||0]||{},s=u(t.options.collapseButton,o.collapseButton,e.options.collapseButton),{width:r,height:n,shape:a,style:l}=s,h=this.series.chart;var d,p,c;e.shapeArgs&&(this.collapseButtonOptions=s,e.collapseButton?e.node.children.length&&s.enabled?({x:d,y:p}=this.getCollapseBtnPosition(s),e.collapseButton.attr({text:e.collapsed?"+":"-",rotation:h.inverted?90:0,rotationOriginX:r/2,rotationOriginY:n/2}).animate({x:d,y:p,opacity:!e.visible||s.onlyOnHover&&"hover"!==e.state&&!e.collapsed?0:1})):(e.collapseButton.destroy(),delete e.collapseButton):e.node.children.length&&s.enabled&&({x:d,y:p}=this.getCollapseBtnPosition(s),c=s.fillColor||e.color||"#cccccc",e.collapseButton=h.renderer.label(e.collapsed?"+":"-",d,p,a).attr({height:n-4,width:r-4,padding:2,fill:c,rotation:h.inverted?90:0,rotationOriginX:r/2,rotationOriginY:n/2,stroke:s.lineColor||"#ffffff","stroke-width":s.lineWidth,"text-align":"center",align:"center",zIndex:1}).addClass("highcharts-tracker").addClass("highcharts-collapse-button").removeClass("highcharts-no-tooltip").css(u({color:"string"==typeof c?h.renderer.getContrast(c):"#333333"},l)).add(i),e.collapseButton.element.point=e,s.onlyOnHover&&!e.collapsed&&e.collapseButton.attr({opacity:0})))}toggleCollapse(e){this.collapsed=r(e,!this.collapsed),s(this.series,"toggleCollapse"),this.series.redraw()}destroy(){this.collapseButton&&(this.collapseButton.destroy(),delete this.collapseButton,this.collapseButton=void 0),super.destroy.apply(this,arguments)}getCollapseBtnPosition(e){var t=this.series.chart.inverted,i=e.width,o=e.height,{x:s=0,y:r=0,width:n=0,height:a=0}=this.shapeArgs||{};return{x:s+e.x+(t?.3*-o:n+-.3*i),y:r+a/2-o/2+e.y}}}return o(n,"mouseOut",function(){const e=this.collapseButton,t=this.collapseButtonOptions;e&&t&&t.onlyOnHover&&!this.collapsed&&e.animate({opacity:0})}),o(n,"mouseOver",function(){this.collapseButton&&this.collapseButton.animate({opacity:1},this.series.options.states&&this.series.options.states.hover&&this.series.options.states.hover.animation)}),o(n,"click",function(){this.toggleCollapse()}),n}),t(e,"Series/Treegraph/TreegraphLink.js",[e["Core/Series/Point.js"],e["Core/Utilities.js"],e["Core/Series/SeriesRegistry.js"]],function(r,e,t){const{pick:n,extend:a}=e;var{prototype:{pointClass:e}}=t["seriesTypes"]["column"];class i extends e{constructor(){super(...arguments),this.isLink=!0,this.node={},this.formatPrefix="link",this.dataLabelOnNull=!0}init(e,t,i,o){const s=super.init.apply(this,arguments);return this.formatPrefix="link",this.dataLabelOnNull=!0,o&&(s.fromNode=o.node.parentNode.point,s.visible=o.visible,s.toNode=o,this.id=s.toNode.id+"-"+s.fromNode.id),s}update(e,t,i,o){var s={id:this.id,formatPrefix:this.formatPrefix};r.prototype.update.call(this,e,!this.isLink&&t,i,o),this.visible=this.toNode.visible,a(this,s),n(t,!0)&&this.series.chart.redraw(i)}}return i}),t(e,"Series/Treegraph/TreegraphLayout.js",[e["Series/Treegraph/TreegraphNode.js"]],function(r){class s{static createDummyNode(e,t,i,o){const s=new r;return s.id=e.id+"-"+i,s.ancestor=e,s.children.push(t),s.parent=e.id,s.parentNode=e,s.point=t.point,s.level=t.level-i,s.relativeXPosition=t.relativeXPosition,s.visible=t.visible,e.children[t.relativeXPosition]=s,t.oldParentNode=e,t.relativeXPosition=0,t.parentNode=s,t.parent=s.id,s}calculatePositions(e){var t=this,i=e.nodeList,e=(this.resetValues(i),e.tree);e&&(t.calculateRelativeX(e,0),t.beforeLayout(i),t.firstWalk(e),t.secondWalk(e,-e.preX),t.afterLayout(i))}beforeLayout(e){for(const o of e){let t=0;for(var i of o.children){if(i&&1<i.level-o.level){let e=i.level-o.level-1;for(;0<e;)i=s.createDummyNode(o,i,e,t),e--}++t}}}resetValues(e){for(const t of e)t.mod=0,(t.ancestor=t).shift=0,t.thread=void 0,t.change=0,t.preX=0}calculateRelativeX(e,t){var i=e.children;for(let e=0,t=i.length;e<t;++e)this.calculateRelativeX(i[e],e);e.relativeXPosition=t}firstWalk(t){let i;if(t.hasChildren()){let e=t.getLeftMostChild();for(const r of t.children)this.firstWalk(r),e=this.apportion(r,e);this.executeShifts(t);var o=t.getLeftMostChild(),s=t.getRightMostChild(),o=(o.preX+s.preX)/2;(i=t.getLeftSibling())?(t.preX=i.preX+1,t.mod=t.preX-o):t.preX=o}else(i=t.getLeftSibling())?(t.preX=i.preX+1,t.mod=t.preX):t.preX=0}secondWalk(e,t){e.yPosition=e.preX+t,e.xPosition=e.level;for(const i of e.children)this.secondWalk(i,t+e.mod)}executeShifts(t){let i=0,o=0;for(let e=t.children.length-1;0<=e;e--){const s=t.children[e];s.preX+=i,s.mod+=i,o+=s.change,i+=s.shift+o}}apportion(l,h){var d=l.getLeftSibling();if(d){let e=l,t=l,i=d,o=e.getLeftMostSibling(),s=e.mod,r=t.mod,n=i.mod,a=o.mod;for(;i&&i.nextRight()&&e&&e.nextLeft();){i=i.nextRight(),o=o.nextLeft(),e=e.nextLeft(),(t=t.nextRight()).ancestor=l;var p=i.preX+n-(e.preX+s)+1;0<p&&(this.moveSubtree(l.getAncestor(i,h),l,p),s+=p,r+=p),n+=i.mod,s+=e.mod,a+=o.mod,r+=t.mod}i&&i.nextRight()&&!t.nextRight()&&(t.thread=i.nextRight(),t.mod+=n-r),e&&e.nextLeft()&&!o.nextLeft()&&(o.thread=e.nextLeft(),o.mod+=s-a),h=l}return h}moveSubtree(e,t,i){var o=t.relativeXPosition-e.relativeXPosition;t.change-=i/o,t.shift+=i,t.preX+=i,t.mod+=i,e.change+=i/o}afterLayout(e){for(const t of e)t.oldParentNode&&(t.relativeXPosition=t.parentNode.relativeXPosition,t.parent=t.oldParentNode.parent,t.parentNode=t.oldParentNode,delete t.oldParentNode.children[t.relativeXPosition],(t.oldParentNode.children[t.relativeXPosition]=t).oldParentNode=void 0)}}return s}),t(e,"Series/Treegraph/TreegraphSeriesDefaults.js",[],function(){return{reversed:!1,marker:{radius:10,lineWidth:0,symbol:"circle",fillOpacity:1,states:{}},link:{color:"#666666",lineWidth:1,radius:10,cursor:"default",type:"curved"},collapseButton:{onlyOnHover:!0,enabled:!0,lineWidth:1,x:0,y:0,height:18,width:18,shape:"circle",style:{cursor:"pointer",fontWeight:"bold",fontSize:"1em"}},tooltip:{linkFormat:"{point.fromNode.id} â†’ {point.toNode.id}",pointFormat:"{point.id}"},dataLabels:{defer:!0,linkTextPath:{attributes:{startOffset:"50%"}},enabled:!0,linkFormatter:()=>"",style:{textOverflow:"none"}}}}),t(e,"Series/Treegraph/TreegraphSeries.js",[e["Series/PathUtilities.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Renderer/SVG/SVGRenderer.js"],e["Series/Treegraph/TreegraphNode.js"],e["Series/Treegraph/TreegraphPoint.js"],e["Series/TreeUtilities.js"],e["Core/Utilities.js"],e["Series/Treegraph/TreegraphLink.js"],e["Series/Treegraph/TreegraphLayout.js"],e["Series/Treegraph/TreegraphSeriesDefaults.js"]],function(e,t,i,o,s,r,n,a,l,h){const f=e["getLinkPath"],{series:{prototype:d},seriesTypes:{treemap:p,column:c}}=t,{symbols:x}=i["prototype"],u=r["getLevelOptions"],{extend:P,merge:T,pick:S,relativeLength:b,splat:g}=n;class v extends p{constructor(){super(...arguments),this.data=void 0,this.options=void 0,this.points=void 0,this.layoutModifier=void 0,this.nodeMap=void 0,this.tree=void 0,this.nodeList=[],this.layoutAlgorythm=void 0,this.links=[],this.mapOptionsToLevel=void 0}init(){super.init.apply(this,arguments),this.layoutAlgorythm=new l}getLayoutModifiers(){const e=this.chart,h=this,d=e.plotSizeX,p=e.plotSizeY;let c=1/0,u=-1/0,f=1/0,g=-1/0,v=0,y=0,m=0,k=0;this.points.forEach(e=>{const t=e.node,i=h.mapOptionsToLevel[e.node.level]||{},o=T(this.options.marker,i.marker,e.options.marker),s=b(o.radius||0,Math.min(d,p)),r=o.symbol,n="circle"!==r&&o.height?b(o.height,p):2*s,a="circle"!==r&&o.width?b(o.width,d):2*s;t.nodeSizeX=a,t.nodeSizeY=n;let l;t.xPosition<=c&&(c=t.xPosition,l=o.lineWidth||0,y=Math.max(a+l,y)),t.xPosition>=u&&(u=t.xPosition,l=o.lineWidth||0,v=Math.max(a+l,v)),t.yPosition<=f&&(f=t.yPosition,l=o.lineWidth||0,k=Math.max(n+l,k)),t.yPosition>=g&&(g=t.yPosition,l=o.lineWidth||0,m=Math.max(n+l,m))});var t=g===f?1:(p-(k+m)/2)/(g-f),i=g===f?p/2:-t*f+k/2,o=u===c?1:(d-(v+v)/2)/(u-c);return{ax:o,bx:u===c?d/2:-o*c+y/2,ay:t,by:i}}getLinks(){const s=this,r=[];return this.data.forEach((e,t)=>{var i,o=s.mapOptionsToLevel[e.node.level||0]||{};e.node.parent?(o=T(o,e.options),!e.linkToParent||e.linkToParent.destroyed?(i=(new s.LinkClass).init(s,o,void 0,e),e.linkToParent=i):e.linkToParent.update({collapsed:o.collapsed},!1),e.linkToParent.index=r.push(e.linkToParent)-1):e.linkToParent&&(s.links.splice(e.linkToParent.index),e.linkToParent.destroy(),delete e.linkToParent)}),r}buildTree(e,t,i,o,s){var r=this.points[t];return i=r&&r.level||i,super.buildTree.call(this,e,t,i,o,s)}markerAttribs(){return{}}setCollapsedStatus(e,t){const i=e.point;i&&(i.collapsed=S(i.collapsed,(this.mapOptionsToLevel[e.level]||{}).collapsed),t=!1!==(i.visible=t)&&!i.collapsed),e.children.forEach(e=>{this.setCollapsedStatus(e,t)})}drawTracker(){c.prototype.drawTracker.apply(this,arguments),c.prototype.drawTracker.call(this,this.links)}translate(){var e=this,t=e.options;let i=r.updateRootId(e),o;d.translate.call(e);var s=e.tree=e.getTree();o=e.nodeMap[i],""===i||o&&o.children.length||(e.setRootNode("",!1),i=e.rootNode,o=e.nodeMap[i]),e.mapOptionsToLevel=u({from:o.level+1,levels:t.levels,to:s.height,defaults:{levelIsConstant:e.options.levelIsConstant,colorByPoint:t.colorByPoint}}),this.setCollapsedStatus(s,!0),e.links=e.getLinks(),e.setTreeValues(s),this.layoutAlgorythm.calculatePositions(e),e.layoutModifier=this.getLayoutModifiers(),this.points.forEach(e=>{this.translateNode(e)}),this.points.forEach(e=>{e.linkToParent&&this.translateLink(e.linkToParent)}),t.colorByPoint||e.setColorRecursive(e.tree)}translateLink(i){var o=i.fromNode,s=i.toNode,r=this.options.link.lineWidth,n=Math.round(r)%2/2,a=S(this.options.link.curveFactor,.5),l=S(i.options.link&&i.options.link.type,this.options.link.type);if(o.shapeArgs&&s.shapeArgs){var h=o.shapeArgs.width||0,d=this.chart.inverted,p=Math.floor((o.shapeArgs.y||0)+(o.shapeArgs.height||0)/2)+n,c=Math.floor((s.shapeArgs.y||0)+(s.shapeArgs.height||0)/2)+n;let e=Math.floor((o.shapeArgs.x||0)+h)+n,t=Math.floor(s.shapeArgs.x||0)+n;d&&(e-=h,t+=s.shapeArgs.width||0);var o=s.node.xPosition-o.node.xPosition,u=(i.shapeType="path",Math.abs(t-e)+h),u=u/o-h,o=u*a*(d?-1:1),h=Math.floor((t+e)/2)+n;i.plotX=h,i.plotY=c,i.shapeArgs={d:f[l]({x1:e,y1:p,x2:t,y2:c,width:u,offset:o,inverted:d,parentVisible:s.visible,radius:this.options.link.radius})},i.dlBox={x:(e+t)/2,y:(p+c)/2,height:r,width:0},i.tooltipPos=d?[(this.chart.plotSizeY||0)-i.dlBox.y,(this.chart.plotSizeX||0)-i.dlBox.x]:[i.dlBox.x,i.dlBox.y]}}drawNodeLabels(e){var t=this.mapOptionsToLevel;let i,o;for(const s of e)o=t[s.node.level],i={style:{}},o&&o.dataLabels&&(i=T(i,o.dataLabels),this._hasPointLabels=!0),s.shapeArgs&&!g(this.options.dataLabels)[0].style.width&&(i.style.width=s.shapeArgs.width,s.dataLabel&&s.dataLabel.css({width:s.shapeArgs.width+"px"})),s.dlOptions=T(i,s.options.dataLabels);d.drawDataLabels.call(this,e)}alignDataLabel(e,t){var i=e.visible;e.visible=!0,super.alignDataLabel.apply(this,arguments),t.animate({opacity:!1===i?0:1}),e.visible=i}drawDataLabels(){this.options.dataLabels&&(this.options.dataLabels=g(this.options.dataLabels),this.drawNodeLabels(this.points),d.drawDataLabels.call(this,this.links))}destroy(){if(this.links){for(const e of this.links)e.destroy();this.links.length=0}return d.destroy.apply(this,arguments)}pointAttribs(e,t){var i=this,o=i.mapOptionsToLevel[e.node.level||0]||{},s=e.options,r=o.states&&o.states[t]||{};e.options.marker=T(i.options.marker,o.marker,e.options.marker);const n=S(r.link&&r.link.color,s.link&&s.link.color,o.link&&o.link.color,i.options.link&&i.options.link.color),a=S(r.link&&r.link.lineWidth,s.link&&s.link.lineWidth,o.link&&o.link.lineWidth,i.options.link&&i.options.link.lineWidth),l=d.pointAttribs.call(i,e,t);return e.isLink&&(l.stroke=n,l["stroke-width"]=a,delete l.fill),e.visible||(l.opacity=0),l}drawPoints(){p.prototype.drawPoints.apply(this,arguments),c.prototype.drawPoints.call(this,this.links)}translateNode(e){const t=this.chart,i=e.node,o=t.plotSizeY,s=t.plotSizeX,{ax:r,bx:n,ay:a,by:l}=this.layoutModifier,h=r*i.xPosition+n,d=a*i.yPosition+l,p=this.mapOptionsToLevel[i.level]||{},c=T(this.options.marker,p.marker,e.options.marker),u=c.symbol,f=i.nodeSizeY,g=i.nodeSizeX,v=this.options.reversed,y=i.x=t.inverted?s-g/2-h:h-g/2,m=i.y=v?d-f/2:o-d-f/2,k=S(e.options.borderRadius,p.borderRadius,this.options.borderRadius);if(e.shapeType="path",!e.visible&&e.linkToParent){var b=e.linkToParent.fromNode;if(b){const L=b.shapeArgs||{},{x:h=0,y:d=0,width:g=0,height:f=0}=L;e.shapeArgs||(e.shapeArgs={}),P(e.shapeArgs,{d:x[u||"circle"](h,d,g,f,k?{r:k}:void 0),x:h,y:d}),e.plotX=b.plotX,e.plotY=b.plotY}}else e.plotX=y,e.plotY=m,e.shapeArgs={d:x[u||"circle"](y,m,g,f,k?{r:k}:void 0),x:y,y:m,width:g,height:f,cursor:e.node.isLeaf?"default":"pointer"};e.tooltipPos=t.inverted?[o-m-f/2,s-y-g/2]:[y+g/2,m]}}return v.defaultOptions=T(p.defaultOptions,h),P(v.prototype,{pointClass:s,NodeClass:o,LinkClass:a}),t.registerSeriesType("treegraph",v),v}),t(e,"masters/modules/treegraph.src.js",[],function(){})});