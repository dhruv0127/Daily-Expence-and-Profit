"use strict";!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/flowmap",["highcharts"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,o,i){t.hasOwnProperty(e)||(t[e]=i.apply(null,o),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t=t?t._modules:{},"Series/FlowMap/FlowMapPoint.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e){({mapline:{prototype:{pointClass:t}}}=t.seriesTypes);const{pick:o,isString:i,isNumber:s}=e;class r extends t{constructor(){super(...arguments),this.series=this.options=void 0}isValid(){let e=!(!this.options.to||!this.options.from);return[this.options.to,this.options.from].forEach(function(t){e=!!(e&&t&&(i(t)||s(o(t[0],t.lat))&&s(o(t[1],t.lon))))}),e}}return r}),e(t,"Series/ColorMapComposition.js",[t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,o){const e=t.seriesTypes["column"]["prototype"],{addEvent:i,defined:s}=o;var r;{function n(t){this.moveToTopOnHover&&this.graphic&&this.graphic.attr({zIndex:t&&"hover"===t.state?1:0})}t=r=r||{};const a=[];t.pointMembers={dataLabelOnNull:!0,moveToTopOnHover:!0,isValid:function(){return null!==this.value&&1/0!==this.value&&-1/0!==this.value&&(void 0===this.value||!isNaN(this.value))}},t.seriesMembers={colorKey:"value",axisTypes:["xAxis","yAxis","colorAxis"],parallelArrays:["x","y","value"],pointArrayMap:["value"],trackerGroups:["group","markerGroup","dataLabelsGroup"],colorAttribs:function(t){const e={};return!s(t.color)||t.state&&"normal"!==t.state||(e[this.colorProp||"fill"]=t.color),e},pointAttribs:e.pointAttribs},t.compose=function(t){var e=t.prototype.pointClass;return o.pushUnique(a,e)&&i(e,"afterSetState",n),t}}return r}),e(t,"Maps/MapSymbols.js",[t["Core/Renderer/SVG/SVGRenderer.js"]],function(t){const{symbols:r}=t["prototype"];return r.bottombutton=function(t,e,o,i,s){if(s){const o=(null==s?void 0:s.r)||0;s.brBoxY=e-o,s.brBoxHeight=i+o}return r.roundedRect(t,e,o,i,s)},r.topbutton=function(t,e,o,i,s){return s&&(s.brBoxHeight=i+((null==s?void 0:s.r)||0)),r.roundedRect(t,e,o,i,s)},r}),e(t,"Core/Chart/MapChart.js",[t["Core/Chart/Chart.js"],t["Core/Defaults.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Utilities.js"]],function(t,e,o,i){const s=e["getOptions"],{merge:r,pick:n}=i;class a extends t{init(t,e){var o=s().credits;t=r({chart:{panning:{enabled:!0,type:"xy"},type:"map"},credits:{mapText:n(o.mapText,' © <a href="{geojson.copyrightUrl}">{geojson.copyrightShort}</a>'),mapTextFull:n(o.mapTextFull,"{geojson.copyright}")},mapView:{},tooltip:{followTouchMove:!1}},t),super.init(t,e)}}var h;return(h=a=a||{}).maps={},h.mapChart=function(t,e,o){return new h(t,e,o)},h.splitPath=function(t){return"string"==typeof t&&(t=(t=t.replace(/([A-Za-z])/g," $1 ").replace(/^\s*/,"").replace(/\s*$/,"")).split(/[ ,;]+/).map(t=>/[A-za-z]/.test(t)?t:parseFloat(t))),o.prototype.pathToSegments(t)},a}),e(t,"Maps/MapUtilities.js",[],function(){return{boundsFromPath:function(t){let o=-Number.MAX_VALUE,i=Number.MAX_VALUE,s=-Number.MAX_VALUE,r=Number.MAX_VALUE,n;if(t.forEach(t=>{var e=t[t.length-2];t=t[t.length-1],"number"==typeof e&&"number"==typeof t&&(i=Math.min(i,e),o=Math.max(o,e),r=Math.min(r,t),s=Math.max(s,t),n=!0)}),n)return{x1:i,y1:r,x2:o,y2:s}},pointInPolygon:function(t,e){let o,i=!1,s=t.x,r=t.y;for(t=0,o=e.length-1;t<e.length;o=t++)e[t][1]>r!=e[o][1]>r&&s<(e[o][0]-e[t][0])*(r-e[t][1])/(e[o][1]-e[t][1])+e[t][0]&&(i=!i);return i}}}),e(t,"Series/Map/MapPoint.js",[t["Series/ColorMapComposition.js"],t["Maps/MapUtilities.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,e,o,i){const r=e["boundsFromPath"],{extend:s,isNumber:n,pick:a}=({scatter:e}=o["seriesTypes"],i);class h extends e.prototype.pointClass{constructor(){super(...arguments),this.series=this.path=this.options=void 0}static getProjectedPath(t,e){return t.projectedPath||(e&&t.geometry?(e.hasCoordinates=!0,t.projectedPath=e.path(t.geometry)):t.projectedPath=t.path),t.projectedPath||[]}applyOptions(t,e){const o=this.series;return t=super.applyOptions.call(this,t,e),e=o.joinBy,o.mapData&&o.mapMap&&((e=void 0!==(e=super.getNestedProperty.call(t,e[1]))&&o.mapMap[e])?s(t,e):-1!==o.pointArrayMap.indexOf("value")&&(t.value=t.value||null)),t}getProjectedBounds(t){var e=h.getProjectedPath(this,t),e=r(e),o=this.properties,i=this.series.chart.mapView;if(e){const r=o&&o["hc-middle-lon"],s=o&&o["hc-middle-lat"];return i&&n(r)&&n(s)?(t=t.forward([r,s]),e.midX=t[0],e.midY=t[1]):(t=o&&o["hc-middle-x"],o=o&&o["hc-middle-y"],e.midX=e.x1+(e.x2-e.x1)*a(this.middleX,n(t)?t:.5),t=a(this.middleY,n(o)?o:.5),this.geometry||(t=1-t),e.midY=e.y2-(e.y2-e.y1)*t),e}}onMouseOver(t){i.clearTimeout(this.colorInterval),!this.isNull&&this.visible||this.series.options.nullInteraction?super.onMouseOver.call(this,t):this.series.onMouseOut(t)}setVisible(t){var e=t?"show":"hide";this.visible=this.options.visible=!!t,this.dataLabel&&this.dataLabel[e](),this.graphic&&this.graphic.attr(this.series.pointAttribs(this))}zoomTo(t){const e=this.series.chart,o=e.mapView;var i,s=this.bounds;if(o&&s){const r=n(this.insetIndex)&&o.insets[this.insetIndex];r&&(i=r.projectedUnitsToPixels({x:s.x1,y:s.y1}),s=r.projectedUnitsToPixels({x:s.x2,y:s.y2}),i=o.pixelsToProjectedUnits({x:i.x,y:i.y}),s=o.pixelsToProjectedUnits({x:s.x,y:s.y}),s={x1:i.x,y1:i.y,x2:s.x,y2:s.y}),o.fitToBounds(s,void 0,!1),this.series.isDirty=!0,e.redraw(t)}}}return s(h.prototype,{dataLabelOnNull:t.pointMembers.dataLabelOnNull,moveToTopOnHover:t.pointMembers.moveToTopOnHover,isValid:t.pointMembers.isValid}),h}),e(t,"Maps/MapViewOptionsDefault.js",[],function(){return{center:[0,0],fitToGeometry:void 0,maxZoom:void 0,padding:0,projection:{name:void 0,parallels:void 0,rotation:void 0},zoom:void 0}}),e(t,"Maps/MapViewInsetsOptionsDefault.js",[],function(){return{borderColor:"#cccccc",borderWidth:1,center:[0,0],padding:"10%",relativeTo:"mapBoundingBox",units:"percent"}}),e(t,"Extensions/GeoJSON.js",[t["Core/Chart/Chart.js"],t["Core/FormatUtilities.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(t,e,o,i){function n(t,i){if(i=i||Object.keys(t.objects)[0],(i=t.objects[i])["hc-decoded-geojson"])return i["hc-decoded-geojson"];let s=t.arcs;if(t.transform){const{scale:i,translate:r}=t.transform;s=t.arcs.map(t=>{let e=0,o=0;return t.map(t=>((t=t.slice())[0]=(e+=t[0])*i[0]+r[0],t[1]=(o+=t[1])*i[1]+r[1],t))})}const r=t=>"number"==typeof t[0]?t.reduce((t,e,o)=>{let i=e<0?s[~e]:s[e];return e<0?(i=i.slice(0,0===o?i.length:i.length-1)).reverse():o&&(i=i.slice(1)),t.concat(i)},[]):t.map(r),e=i.geometries.map(t=>({type:"Feature",properties:t.properties,geometry:{type:t.type,coordinates:t.coordinates||r(t.arcs)}}));return t={type:"FeatureCollection",copyright:t.copyright,copyrightShort:t.copyrightShort,copyrightUrl:t.copyrightUrl,features:e,"hc-recommended-mapview":i["hc-recommended-mapview"],bbox:t.bbox,title:t.title},i["hc-decoded-geojson"]=t}function s(t,s="map",e){const r=[];return(t="Topology"===t.type?n(t):t).features.forEach(function(t){var e=(o=t.geometry||{}).type,o=o.coordinates;t=t.properties;let i;if(("map"!==s&&"mapbubble"!==s||"Polygon"!==e&&"MultiPolygon"!==e)&&("mapline"!==s||"LineString"!==e&&"MultiLineString"!==e)?"mappoint"===s&&"Point"===e&&o.length&&(i={geometry:{coordinates:o,type:e}}):o.length&&(i={geometry:{coordinates:o,type:e}}),i){e=t&&(t.name||t.NAME),o=t&&t.lon;const s=t&&t.lat;r.push(h(i,{lat:"number"==typeof s?s:void 0,lon:"number"==typeof o?o:void 0,name:"string"==typeof e?e:void 0,properties:t}))}}),e&&t.copyrightShort&&(e.chart.mapCredits=a(e.chart.options.credits.mapText,{geojson:t}),e.chart.mapCreditsFull=a(e.chart.options.credits.mapTextFull,{geojson:t})),r}const a=e["format"],d=o["win"],{error:u,extend:h,merge:r,wrap:p}=i;return t.prototype.transformFromLatLon=function(t,e){var o,i,s,r,n,a,h,p,l,c=this.options.chart.proj4||d.proj4;if(c)return{jsonmarginX:o=0,jsonmarginY:i=0,jsonres:s=1,scale:r=1,xoffset:n=0,xpan:a=0,yoffset:h=0,ypan:p=0}=e,t=c(e.crs,[t.lon,t.lat]),c=e.cosAngle||e.rotation&&Math.cos(e.rotation),l=e.sinAngle||e.rotation&&Math.sin(e.rotation),{x:(((e=e.rotation?[t[0]*c+t[1]*l,-t[0]*l+t[1]*c]:t)[0]-n)*r+a)*s+o,y:-(((h-e[1])*r+p)*s-i)};u(21,!1,this)},t.prototype.transformToLatLon=function(t,e){const o=this.options.chart.proj4||d.proj4;var i,s,r,n,a,h,p,l;if(o){if(null!==t.y)return{jsonmarginX:p=0,jsonmarginY:i=0,jsonres:s=1,scale:r=1,xoffset:n=0,xpan:l=0,yoffset:a=0,ypan:h=0}=e,t={x:((t.x-p)/s-l)/r+n,y:((t.y-i)/s+h)/r+a},p=e.cosAngle||e.rotation&&Math.cos(e.rotation),l=e.sinAngle||e.rotation&&Math.sin(e.rotation),{lat:(e=o(e.crs,"WGS84",e.rotation?{x:t.x*p+t.y*-l,y:t.x*l+t.y*p}:t)).y,lon:e.x}}else u(21,!1,this)},t.prototype.fromPointToLatLon=function(t){return this.mapView&&this.mapView.projectedUnitsToLonLat(t)},t.prototype.fromLatLonToPoint=function(t){return this.mapView&&this.mapView.lonLatToProjectedUnits(t)},p(t.prototype,"addCredits",function(t,e){e=r(!0,this.options.credits,e),this.mapCredits&&(e.href=null),t.call(this,e),this.credits&&this.mapCreditsFull&&this.credits.attr({title:this.mapCreditsFull})}),{geojson:o.geojson=s,topo2geo:o.topo2geo=n}}),e(t,"Core/Geometry/PolygonClip.js",[],function(){const p=(t,e,o)=>(e[0]-t[0])*(o[1]-t[1])>(e[1]-t[1])*(o[0]-t[0]),l=(t,e,o,i)=>{var s=[t[0]-e[0],t[1]-e[1]],r=[o[0]-i[0],o[1]-i[1]];return t=t[0]*e[1]-t[1]*e[0],o=o[0]*i[1]-o[1]*i[0],i=1/(s[0]*r[1]-s[1]*r[0]),(s=[(t*r[0]-o*s[0])*i,(t*r[1]-o*s[1])*i]).isIntersection=!0,s};var t,i;return(i=t=t||{}).clipLineString=(t,e)=>{const o=[];for(t=i.clipPolygon(t,e,!1),e=1;e<t.length;e++)t[e].isIntersection&&t[e-1].isIntersection&&(o.push(t.splice(0,e)),e=0),e===t.length-1&&o.push(t);return o},i.clipPolygon=(e,o,i=!0)=>{let s=o[o.length-1],r,n,a=e;for(let t=0;t<o.length;t++){var h=a;e=o[t],a=[],r=i?h[h.length-1]:h[0];for(let t=0;t<h.length;t++)n=h[t],p(s,e,n)?(p(s,e,r)||a.push(l(s,e,r,n)),a.push(n)):p(s,e,r)&&a.push(l(s,e,r,n)),r=n;s=e}return a},t}),e(t,"Maps/Projections/LambertConformalConic.js",[],function(){const n=Math.sign||(t=>0===t?0:0<t?1:-1),a=Math.PI/180,h=Math.PI/2;return class{constructor(t){var e=(o=(t.parallels||[]).map(t=>t*a))[0]||0,o=null!=(i=o[1])?i:e,i=Math.cos(e);"object"==typeof t.projectedBounds&&(this.projectedBounds=t.projectedBounds),t=e===o?Math.sin(e):Math.log(i/Math.cos(o))/Math.log(Math.tan((h+o)/2)/Math.tan((h+e)/2)),Math.abs(t)<1e-10&&(t=1e-10*(n(t)||1)),this.n=t,this.c=i*Math.pow(Math.tan((h+e)/2),t)/t}forward(t){var e=t[0]*a,{c:o,n:i,projectedBounds:s}=this;t=t[1]*a,0<o?t<1e-6-h&&(t=1e-6-h):t>h-1e-6&&(t=h-1e-6);var r=[t=(r=o/Math.pow(Math.tan((h+t)/2),i))*Math.sin(i*e)*63.78137,e=63.78137*(o-r*Math.cos(i*e))];return s&&(t<s.x1||t>s.x2||e<s.y1||e>s.y2)&&(r.outside=!0),r}inverse(t){var e=t[0]/63.78137,{c:o,n:i}=this,s=(t=o-(t=t[1]/63.78137),n(i)*Math.sqrt(e*e+t*t));let r=Math.atan2(e,Math.abs(t))*n(t);return t*i<0&&(r-=Math.PI*n(e)*n(t)),[r/i/a,(2*Math.atan(Math.pow(o/s,1/i))-h)/a]}}}),e(t,"Maps/Projections/EqualEarth.js",[],function(){const h=Math.sqrt(3)/2;return class{constructor(){this.bounds={x1:-200.37508342789243,x2:200.37508342789243,y1:-97.52595454902263,y2:97.52595454902263}}forward(t){var e=Math.PI/180,o=Math.asin(h*Math.sin(t[1]*e)),i=o*o,s=i*i*i;return[t[0]*e*Math.cos(o)*74.03120656864502/(h*(1.340264+3*-.081106*i+s*(7*893e-6+.034164*i))),74.03120656864502*o*(1.340264+-.081106*i+s*(893e-6+.003796*i))]}inverse(t){var e=t[0]/74.03120656864502,o=(t=t[1]/74.03120656864502,180/Math.PI);let i=t,s;for(s=0;s<12;++s){var r=(a=i*i)*a*a,n=i*(1.340264+-.081106*a+r*(893e-6+.003796*a))-t,a=1.340264+3*-.081106*a+r*(7*893e-6+.034164*a);if(i-=n/=a,Math.abs(n)<1e-9)break}return a=i*i,[o*h*e*(1.340264+3*-.081106*a+a*a*a*(7*893e-6+.034164*a))/Math.cos(i),o*Math.asin(Math.sin(i)/h)]}}}),e(t,"Maps/Projections/Miller.js",[],function(){const e=Math.PI/4,o=Math.PI/180;return class{constructor(){this.bounds={x1:-200.37508342789243,x2:200.37508342789243,y1:-146.91480769173063,y2:146.91480769173063}}forward(t){return[t[0]*o*63.78137,79.7267125*Math.log(Math.tan(e+.4*t[1]*o))]}inverse(t){return[t[0]/63.78137/o,2.5*(Math.atan(Math.exp(t[1]/63.78137*.8))-e)/o]}}}),e(t,"Maps/Projections/Orthographic.js",[],function(){const r=Math.PI/180;return class{constructor(){this.antimeridianCutting=!1,this.bounds={x1:-63.78460826781007,x2:63.78460826781007,y1:-63.78460826781007,y2:63.78460826781007}}forward(t){var e=t[0];return t=t[1]*r,t=[Math.cos(t)*Math.sin(e*r)*63.78460826781007,63.78460826781007*Math.sin(t)],(e<-90||90<e)&&(t.outside=!0),t}inverse(t){var e=t[0]/63.78460826781007,o=(t=t[1]/63.78460826781007,Math.sqrt(e*e+t*t)),i=Math.asin(o),s=Math.sin(i);return[Math.atan2(e*s,o*Math.cos(i))/r,Math.asin(o&&t*s/o)/r]}}}),e(t,"Maps/Projections/WebMercator.js",[],function(){const o=Math.PI/180;return class{constructor(){this.bounds={x1:-200.37508342789243,x2:200.37508342789243,y1:-200.3750834278071,y2:200.3750834278071},this.maxLatitude=85.0511287798}forward(t){var e=Math.sin(t[1]*o),e=[63.78137*t[0]*o,63.78137*Math.log((1+e)/(1-e))/2];return 85.0511287798<Math.abs(t[1])&&(e.outside=!0),e}inverse(t){return[t[0]/(63.78137*o),(2*Math.atan(Math.exp(t[1]/63.78137))-Math.PI/2)/o]}}}),e(t,"Maps/Projections/ProjectionRegistry.js",[t["Maps/Projections/LambertConformalConic.js"],t["Maps/Projections/EqualEarth.js"],t["Maps/Projections/Miller.js"],t["Maps/Projections/Orthographic.js"],t["Maps/Projections/WebMercator.js"]],function(t,e,o,i,s){return{EqualEarth:e,LambertConformalConic:t,Miller:o,Orthographic:i,WebMercator:s}}),e(t,"Maps/Projection.js",[t["Core/Geometry/PolygonClip.js"],t["Maps/Projections/ProjectionRegistry.js"],t["Core/Utilities.js"]],function(t,e,o){const{clipLineString:y,clipPolygon:M}=t,{clamp:l,erase:c}=o,g=2*Math.PI/360,d=t=>(t<-180&&(t+=360),180<t&&(t-=360),t);class x{static add(t,e){x.registry[t]=e}static greatCircle(t,e,o){const{atan2:i,cos:s,sin:r,sqrt:n}=Math,a=t[1]*g,h=t[0]*g,p=e[1]*g,l=e[0]*g;var c=p-a,d=l-h,c=r(c/2)*r(c/2)+s(a)*s(p)*r(d/2)*r(d/2),u=(c=2*i(n(c),n(1-c)),Math.round(6371e3*c/5e5)),d=[];if(o&&d.push(t),1<u)for(u=t=1/u;u<.999;u+=t){var m=r((1-u)*c)/r(c);const t=r(u*c)/r(c);var f=m*s(a)*s(h)+t*s(p)*s(l);const e=m*s(a)*r(h)+t*s(p)*r(l);m=m*r(a)+t*r(p),m=i(m,n(f*f+e*e)),f=i(e,f),d.push([f/g,m/g])}return o&&d.push(e),d}static insertGreatCircles(t){let e=t.length-1;for(;e--;){var o;10<Math.max(Math.abs(t[e][0]-t[e+1][0]),Math.abs(t[e][1]-t[e+1][1]))&&((o=x.greatCircle(t[e],t[e+1])).length&&t.splice(e+1,0,...o))}}static toString(t){const{name:e,rotation:o}=t||{};return[e,o&&o.join(",")].join(";")}constructor(t={}){this.hasGeoProjection=this.hasCoordinates=!1,this.maxLatitude=90;var{name:e,projectedBounds:o,rotation:i}=this.options=t;this.rotator=i?this.getRotator(i):void 0;const s=e?x.registry[e]:void 0,{def:r,rotator:n}=(s&&(this.def=new s(t)),this);r&&(this.maxLatitude=r.maxLatitude||90,this.hasGeoProjection=!0),n&&r?(this.forward=t=>r.forward(n.forward(t)),this.inverse=t=>n.inverse(r.inverse(t))):r?(this.forward=t=>r.forward(t),this.inverse=t=>r.inverse(t)):n&&(this.forward=n.forward,this.inverse=n.inverse),this.bounds="world"===o?r&&r.bounds:o}lineIntersectsBounds(t){var{x1:e,x2:o,y1:i,y2:s}=this.bounds||{},r=(t,e,o)=>{var[i,s]=t;if(t=e?0:1,"number"==typeof o&&i[e]>=o!=s[e]>=o)return t=i[t]+(o-i[e])/(s[e]-i[e])*(s[t]-i[t]),e?[t,o]:[o,t]};let n,a=t[0];return((n=r(t,0,e))||(n=r(t,0,o)))&&(a=n,t[1]=n),a=(n=r(t,1,i))||(n=r(t,1,s))?n:a}getRotator(t){const s=t[0]*g,e=(t[1]||0)*g,r=(t=(t[2]||0)*g,Math.cos(e)),n=Math.sin(e),a=Math.cos(t),h=Math.sin(t);if(0!=s||0!=e||0!==t)return{forward:t=>{var e=t[0]*g+s,o=t[1]*g,i=Math.cos(o);return t=Math.cos(e)*i,e=Math.sin(e)*i,i=(o=Math.sin(o))*r+t*n,[Math.atan2(e*a-i*h,t*r-o*n)/g,Math.asin(i*a+e*h)/g]},inverse:t=>{var e=t[0]*g,o=t[1]*g,i=Math.cos(o);return t=Math.cos(e)*i,e=Math.sin(e)*i,i=(o=Math.sin(o))*a-e*h,[(Math.atan2(e*a+o*h,t*r+i*n)-s)/g,Math.asin(i*r-t*n)/g]}}}forward(t){return t}inverse(t){return t}cutOnAntimeridian(r,n){const a=[],t=[r];if(r.forEach((t,e)=>{let o=r[e-1];if(!e){if(!n)return;o=r[r.length-1]}var i=o[0],s=t[0];(i<-90||90<i)&&(s<-90||90<s)&&0<i!=0<s&&(s=l((180-(i+360)%360)/((s+360)%360-(i+360)%360),0,1),a.push({i:e,lat:o[1]+s*(t[1]-o[1]),direction:i<0?1:-1,previousLonLat:o,lonLat:t}))}),a.length)if(n){var e;1==a.length%2&&(e=a.slice().sort((t,e)=>Math.abs(e.lat)-Math.abs(t.lat))[0],c(a,e));for(var o=a.length-2;0<=o;){var i=a[o].i,s=d(180+1e-6*a[o].direction),h=d(180-1e-6*a[o].direction);(i=r.splice(i,a[o+1].i-i,...x.greatCircle([s,a[o].lat],[s,a[o+1].lat],!0))).push(...x.greatCircle([h,a[o+1].lat],[h,a[o].lat],!0)),t.push(i),o-=2}if(e)for(i=0;i<t.length;i++){const{direction:r,lat:l}=e;if(-1<(h=(o=t[i]).indexOf(e.lonLat))){i=(l<0?-1:1)*this.maxLatitude;var p=d(180+1e-6*r),s=d(180-1e-6*r);const a=x.greatCircle([p,l],[p,i],!0);for(p+=120*r;-180<p&&p<180;p+=120*r)a.push([p,i]);a.push(...x.greatCircle([s,i],[s,e.lat],!0)),o.splice(h,0,...a);break}}}else for(e=a.length;e--;)(o=r.splice(a[e].i,r.length,[d(180+1e-6*a[e].direction),a[e].lat])).unshift([d(180-1e-6*a[e].direction),a[e].lat]),t.push(o);return t}path(t){const{bounds:l,def:e,rotator:o}=this,c=[],d="Polygon"===t.type||"MultiPolygon"===t.type,u=this.hasGeoProjection,m=!e||!1!==e.antimeridianCutting,i=m?o:void 0,f=m&&e||this;let g;l&&(g=[[l.x1,l.y1],[l.x2,l.y1],[l.x2,l.y2],[l.x1,l.y2]]);const s=t=>{let e=[t=t.map(e=>{if(m){let t=(e=i?i.forward(e):e)[0];e=[t=Math.abs(t-180)<1e-6?t<180?179.999999:180.000001:t,e[1]]}return e})];u&&(x.insertGreatCircles(t),m&&(e=this.cutOnAntimeridian(t,d))),e.forEach(e=>{if(!(e.length<2)){var o,i,s=!1,r=!1,n=t=>{s?c.push(["L",t[0],t[1]]):(c.push(["M",t[0],t[1]]),s=!0)},a=!1,h=!1,p=e.map(t=>((t=f.forward(t)).outside?a=!0:h=!0,1/0===t[1]?t[1]=1e10:-1/0===t[1]&&(t[1]=-1e10),t));if(m){if(d&&p.push(p[0]),a){if(!h)return;if(g)if(d)p=M(p,g);else if(l)return void y(p,g).forEach(t=>{s=!1,t.forEach(n)})}p.forEach(n)}else for(let t=0;t<p.length;t++){const M=e[t],h=p[t];r=!!h.outside||(d&&!o&&(o=M,e.push(M),p.push(h)),r&&i&&(d&&u?x.greatCircle(i,M).forEach(t=>n(f.forward(t))):s=!1),n(h),i=M,!1)}}})};return"LineString"===t.type?s(t.coordinates):"MultiLineString"===t.type?t.coordinates.forEach(t=>s(t)):"Polygon"===t.type?(t.coordinates.forEach(t=>s(t)),c.length&&c.push(["Z"])):"MultiPolygon"===t.type&&(t.coordinates.forEach(t=>{t.forEach(t=>s(t))}),c.length&&c.push(["Z"])),c}}return x.registry=e,x}),e(t,"Maps/MapView.js",[t["Maps/MapViewOptionsDefault.js"],t["Maps/MapViewInsetsOptionsDefault.js"],t["Extensions/GeoJSON.js"],t["Core/Chart/MapChart.js"],t["Maps/MapUtilities.js"],t["Maps/Projection.js"],t["Core/Utilities.js"]],function(r,o,t,e,i,n,s){const a=t["topo2geo"],h=e["maps"],{boundsFromPath:p,pointInPolygon:l}=i,{addEvent:c,clamp:d,fireEvent:u,isArray:m,isNumber:f,isObject:g,isString:y,merge:M,pick:x,relativeLength:j}=s,v=(t,e)=>{var{width:e,height:o}=e;return Math.log(400.979322/Math.max((t.x2-t.x1)/(e/256),(t.y2-t.y1)/(o/256)))/Math.log(2)};class b{static mergeInsets(t,e){const o=t=>{const o={};return t.forEach((t,e)=>{o[t&&t.id||"i"+e]=t}),o},i=M(o(t),o(e));return Object.keys(i).map(t=>i[t])}createInsets(){const e=this.options,t=e.insets;t&&t.forEach(t=>{t=new w(this,M(e.insetOptions,t)),this.insets.push(t)})}constructor(t,e){this.allowTransformAnimation=!0,this.insets=[],this.padding=[0,0,0,0],this.eventsToUnbind=[];let s;if(!(this instanceof w)){var o=[t.options.chart.map,...(t.options.series||[]).map(t=>t.mapData)].map(t=>this.getGeoMap(t));const r=[],n=(o.forEach(t=>{if(t&&(s=s||t["hc-recommended-mapview"],t.bbox)){const[e,o,s,i]=t.bbox;r.push({x1:e,y1:o,x2:s,y2:i})}}),r.length&&b.compositeBounds(r));if(n){const{x1:r,y1:t,x2:e,y2:s}=n;var i=180<e-r&&90<s-t?{name:"EqualEarth"}:{name:"LambertConformalConic",parallels:[t,s],rotation:[-(r+e)/2]}}this.geoMap=o[0]}this.userOptions=e||{},i=M(r,{projection:i},s,e),o=s&&s.insets,e=e&&e.insets,o&&e&&(i.insets=b.mergeInsets(o,e)),this.chart=t,this.center=i.center,this.options=i,this.projection=new n(i.projection),this.playingField=t.plotBox,this.zoom=i.zoom||0,this.createInsets(),this.eventsToUnbind.push(c(t,"afterSetChartSize",()=>{this.playingField=this.getField(),void 0!==this.minZoom&&this.minZoom!==this.zoom||(this.fitToBounds(void 0,void 0,!1),!this.chart.hasRendered&&f(this.userOptions.zoom)&&(this.zoom=this.userOptions.zoom),this.userOptions.center&&M(!0,this.center,this.userOptions.center))})),this.setUpEvents()}fitToBounds(t,e,o=!0,i){var s,r=t||this.getProjectedBounds();r&&(s=x(e,t?0:this.options.padding),e=this.getField(!1),s=m(s)?s:[s,s,s,s],this.padding=[j(s[0],e.height),j(s[1],e.width),j(s[2],e.height),j(s[3],e.width)],this.playingField=this.getField(),e=v(r,this.playingField),t||(this.minZoom=e),t=this.projection.inverse([(r.x2+r.x1)/2,(r.y2+r.y1)/2]),this.setView(t,e,o,i))}getField(t=!0){return{x:(t=t?this.padding:[0,0,0,0])[3],y:t[0],width:this.chart.plotWidth-t[1]-t[3],height:this.chart.plotHeight-t[0]-t[2]}}getGeoMap(t){return y(t)?h[t]&&"Topology"===h[t].type?a(h[t]):h[t]:g(t,!0)?"FeatureCollection"===t.type?t:"Topology"===t.type?a(t):void 0:void 0}getMapBBox(){var t,e,o=this.getProjectedBounds(),i=this.getScale();if(o)return t=this.padding,e=this.projectedUnitsToPixels({x:o.x1,y:o.y2}),{width:(o.x2-o.x1)*i+t[1]+t[3],height:(o.y2-o.y1)*i+t[0]+t[2],x:e.x-t[3],y:e.y-t[0]}}getProjectedBounds(){const e=this.projection;var t=this.chart.series.reduce((t,e)=>{var o=e.getProjectedBounds&&e.getProjectedBounds();return o&&!1!==e.options.affectsMapView&&t.push(o),t},[]),o=this.options.fitToGeometry;return o?(this.fitToGeometryCache||("MultiPoint"===o.type?(t=(o=o.coordinates.map(t=>e.forward(t))).map(t=>t[0]),o=o.map(t=>t[1]),this.fitToGeometryCache={x1:Math.min.apply(0,t),x2:Math.max.apply(0,t),y1:Math.min.apply(0,o),y2:Math.max.apply(0,o)}):this.fitToGeometryCache=p(e.path(o))),this.fitToGeometryCache):this.projection.bounds||b.compositeBounds(t)}getScale(){return 256/400.979322*Math.pow(2,this.zoom)}getSVGTransform(){var{x:t,y:e,width:o,height:i}=this.playingField,s=this.projection.forward(this.center),r=this.projection.hasCoordinates?-1:1,n=this.getScale();return{scaleX:n,scaleY:r*=n,translateX:t+o/2-s[0]*n,translateY:e+i/2-s[1]*r}}lonLatToPixels(t){if(t=this.lonLatToProjectedUnits(t))return this.projectedUnitsToPixels(t)}lonLatToProjectedUnits(t){const e=this.chart,o=e.mapTransforms;if(o){for(const s in o)if(Object.hasOwnProperty.call(o,s)&&o[s].hitZone){var i=e.transformFromLatLon(t,o[s]);if(i&&l(i,o[s].hitZone.coordinates[0]))return i}return e.transformFromLatLon(t,o.default)}for(i of this.insets)if(i.options.geoBounds&&l({x:t.lon,y:t.lat},i.options.geoBounds.coordinates[0]))return t=i.projection.forward([t.lon,t.lat]),t=i.projectedUnitsToPixels({x:t[0],y:t[1]}),this.pixelsToProjectedUnits(t);if(!(t=this.projection.forward([t.lon,t.lat])).outside)return{x:t[0],y:t[1]}}projectedUnitsToLonLat(t){var e,o=this.chart,i=o.mapTransforms;if(i){for(const e in i)if(Object.hasOwnProperty.call(i,e)&&i[e].hitZone&&l(t,i[e].hitZone.coordinates[0]))return o.transformToLatLon(t,i[e]);return o.transformToLatLon(t,i.default)}o=this.projectedUnitsToPixels(t);for(e of this.insets)if(e.hitZone&&l(o,e.hitZone.coordinates[0]))return t=e.pixelsToProjectedUnits(o),e=e.projection.inverse([t.x,t.y]),{lon:e[0],lat:e[1]};return{lon:(e=this.projection.inverse([t.x,t.y]))[0],lat:e[1]}}redraw(t){this.chart.series.forEach(t=>{t.useMapGeometry&&(t.isDirty=!0)}),this.chart.redraw(t)}setView(t,e,o=!0,i){if(t&&(this.center=t),"number"==typeof e&&("number"==typeof this.minZoom&&(e=Math.max(e,this.minZoom)),"number"==typeof this.options.maxZoom&&(e=Math.min(e,this.options.maxZoom)),f(e)&&(this.zoom=e)),h=this.getProjectedBounds()){t=this.projection.forward(this.center);const{x:o,y:i,width:p,height:l}=this.playingField;e=this.getScale();var s,r,n=this.projectedUnitsToPixels({x:h.x1,y:h.y1}),a=this.projectedUnitsToPixels({x:h.x2,y:h.y2}),h=[(h.x1+h.x2)/2,(h.y1+h.y2)/2];this.chart.series.some(t=>t.isDrilling)||(s=n.x,r=a.y,a=a.x,n=n.y,a-s<p?t[0]=h[0]:s<o&&a<o+p?t[0]+=Math.max(s-o,a-p-o)/e:a>o+p&&s>o&&(t[0]+=Math.min(a-p-o,s-o)/e),n-r<l?t[1]=h[1]:r<i&&n<i+l?t[1]-=Math.max(r-i,n-l-i)/e:n>i+l&&r>i&&(t[1]-=Math.min(n-l-i,r-i)/e),this.center=this.projection.inverse(t)),this.insets.forEach(t=>{t.options.field&&(t.hitZone=t.getHitZone(),t.playingField=t.getField())}),this.render()}u(this,"afterSetView"),o&&this.redraw(i)}projectedUnitsToPixels(t){var e=this.getScale(),o=this.projection.forward(this.center),i=this.playingField;return{x:i.x+i.width/2-e*(o[0]-t.x),y:i.y+i.height/2+e*(o[1]-t.y)}}pixelsToLonLat(t){return this.projectedUnitsToLonLat(this.pixelsToProjectedUnits(t))}pixelsToProjectedUnits(t){var{x:e,y:o}=t,i=(t=this.getScale(),this.projection.forward(this.center)),s=this.playingField;return{x:i[0]+(e-(s.x+s.width/2))/t,y:i[1]-(o-(s.y+s.height/2))/t}}setUpEvents(){const a=this["chart"];let h,p,l;var t=t=>{var e=a.pointer.pinchDown,o=this.projection;let{mouseDownX:i,mouseDownY:s}=a;if(1===e.length&&(i=e[0].chartX,s=e[0].chartY),"number"==typeof i&&"number"==typeof s){var e=i+","+s,{chartX:r,chartY:n}=t.originalEvent;if(e!==p&&(p=e,h=this.projection.forward(this.center),l=(this.projection.options.rotation||[0,0]).slice()),e=(e=o.def&&o.def.bounds)&&v(e,this.playingField)||-1/0,"Orthographic"===o.options.name&&(this.minZoom||1/0)<1.3*e){if(e=440/(this.getScale()*Math.min(a.plotWidth,a.plotHeight)),l){o=(i-r)*e-l[0],e=d(-l[1]-(s-n)*e,-80,80);const h=this.zoom;this.update({projection:{rotation:[-o,-e]}},!1),this.fitToBounds(void 0,void 0,!1),this.zoom=h,a.redraw(!1)}}else f(r)&&f(n)&&(o=this.getScale(),o=this.projection.inverse([h[0]+(i-r)/o,h[1]-(s-n)/o*(this.projection.hasCoordinates?1:-1)]),this.setView(o,void 0,!0,!1));t.preventDefault()}};c(a,"pan",t),c(a,"touchpan",t),c(a,"selection",t=>{var e,o,i,s;t.resetSelection?this.zoomBy():(i=t.x-a.plotLeft,s=t.y-a.plotTop,{y:e,x:o}=this.pixelsToProjectedUnits({x:i,y:s}),{y:i,x:s}=this.pixelsToProjectedUnits({x:i+t.width,y:s+t.height}),this.fitToBounds({x1:o,y1:e,x2:s,y2:i},void 0,!0,!t.originalEvent.touches&&void 0),/^touch/.test(t.originalEvent.type)||a.showResetZoom(),t.preventDefault())})}render(){this.group||(this.group=this.chart.renderer.g("map-view").attr({zIndex:4}).add())}update(t,e=!0,o){var i=(i=t.projection)&&n.toString(i)!==n.toString(this.options.projection);let s=!1;M(!0,this.userOptions,t),M(!0,this.options,t),"insets"in t&&(this.insets.forEach(t=>t.destroy()),this.insets.length=0,s=!0),(i||"fitToGeometry"in t)&&delete this.fitToGeometryCache,(i||s)&&(this.chart.series.forEach(t=>{const e=t.transformGroups;if(t.clearBounds&&t.clearBounds(),t.isDirty=!0,t.isDirtyData=!0,s&&e)for(;1<e.length;)(t=e.pop())&&t.destroy()}),i&&(this.projection=new n(this.options.projection)),s&&this.createInsets(),t.center||!Object.hasOwnProperty.call(t,"zoom")||f(t.zoom)||this.fitToBounds(void 0,void 0,!1)),t.center||f(t.zoom)?this.setView(this.options.center,t.zoom,!1):"fitToGeometry"in t&&this.fitToBounds(void 0,void 0,!1),e&&this.chart.redraw(o)}zoomBy(t,e,o,i){var s,r=this.chart;const n=this.projection.forward(this.center);let[a,h]=e?this.projection.forward(e):[];if("number"==typeof t){if(t=this.zoom+t,o){const[t,i]=o;o=this.getScale(),e=i-r.plotTop-r.plotHeight/2,a=n[0]+(t-r.plotLeft-r.plotWidth/2)/o,h=n[1]+e/o}"number"==typeof a&&"number"==typeof h&&(r=1-Math.pow(2,this.zoom)/Math.pow(2,t),s=n[1]-h,n[0]-=(n[0]-a)*r,n[1]+=s*r,s=this.projection.inverse(n)),this.setView(s,t,void 0,i)}else this.fitToBounds(void 0,void 0,void 0,i)}}b.compositeBounds=t=>{if(t.length)return t.slice(1).reduce((t,e)=>(t.x1=Math.min(t.x1,e.x1),t.y1=Math.min(t.y1,e.y1),t.x2=Math.max(t.x2,e.x2),t.y2=Math.max(t.y2,e.y2),t),M(t[0]))};class w extends b{constructor(t,e){super(t.chart,e),this.id=e.id,this.mapView=t,this.options=M(o,e),this.allBounds=[],this.options.geoBounds&&(t=t.projection.path(this.options.geoBounds),this.geoBoundsProjectedBox=p(t),this.geoBoundsProjectedPolygon=t.map(t=>[t[1]||0,t[2]||0]))}getField(t=!0){if(e=this.hitZone){var e,o=t?this.padding:[0,0,0,0],i=(e=e.coordinates[0]).map(t=>t[0]),s=e.map(t=>t[1]),r=(e=Math.min.apply(0,i)+o[3],i=Math.max.apply(0,i)-o[1],Math.min.apply(0,s)+o[0]),o=Math.max.apply(0,s)-o[2];if(f(e)&&f(r))return{x:e,y:r,width:i-e,height:o-r}}return super.getField.call(this,t)}getHitZone(){const{chart:t,mapView:e,options:o}=this;var i=(o.field||{})["coordinates"];if(i){if(i=i[0],"percent"===o.units){const s="mapBoundingBox"===o.relativeTo&&e.getMapBBox()||M(t.plotBox,{x:0,y:0});i=i.map(t=>[j(t[0]+"%",s.width,s.x),j(t[1]+"%",s.height,s.y)])}return{type:"Polygon",coordinates:[i]}}}getProjectedBounds(){return b.compositeBounds(this.allBounds)}isInside(t){var{geoBoundsProjectedBox:e,geoBoundsProjectedPolygon:o}=this;return!!(e&&t.x>=e.x1&&t.x<=e.x2&&t.y>=e.y1&&t.y<=e.y2&&o&&l(t,o))}render(){const{chart:r,mapView:e,options:n}=this;var o=n.borderPath||n.field;if(o&&e.group){let t=!0;this.border||(this.border=r.renderer.path().addClass("highcharts-mapview-inset-border").add(e.group),t=!1),r.styledMode||this.border.attr({stroke:n.borderColor,"stroke-width":n.borderWidth});const a=Math.round(this.border.strokeWidth())%2/2,h="mapBoundingBox"===n.relativeTo&&e.getMapBBox()||e.playingField;o=(o.coordinates||[]).reduce((t,e)=>e.reduce((t,e,o)=>{let[i,s]=e;return"percent"===n.units&&(i=r.plotLeft+j(i+"%",h.width,h.x),s=r.plotTop+j(s+"%",h.height,h.y)),i=Math.floor(i)+a,s=Math.floor(s)+a,t.push(0===o?["M",i,s]:["L",i,s]),t},t),[]),this.border[t?"animate":"attr"]({d:o})}}destroy(){this.border&&(this.border=this.border.destroy()),this.eventsToUnbind.forEach(t=>t())}setUpEvents(){}}return c(e,"afterInit",function(){this.mapView=new b(this,this.options.mapView)}),b}),e(t,"Series/Map/MapSeries.js",[t["Core/Animation/AnimationUtilities.js"],t["Series/ColorMapComposition.js"],t["Series/CenteredUtilities.js"],t["Core/Globals.js"],t["Core/Chart/MapChart.js"],t["Series/Map/MapPoint.js"],t["Maps/MapView.js"],t["Core/Series/Series.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Renderer/SVG/SVGRenderer.js"],t["Core/Utilities.js"]],function(t,e,o,c,i,d,n,s,r,a,h){const p=t["animObject"],l=(t=c["noop"],i)["splitPath"],{column:u,scatter:m}=r["seriesTypes"],{extend:f,find:g,fireEvent:y,getNestedProperty:M,isArray:x,defined:j,isNumber:v,isObject:b,merge:w,objectEach:P,pick:T,splat:C}=h;class L extends m{constructor(){super(...arguments),this.points=this.options=this.joinBy=this.group=this.data=this.chart=void 0,this.processedData=[]}animate(t){const{chart:e,group:o}=this,i=p(this.options.animation);t?o.attr({translateX:e.plotLeft+e.plotWidth/2,translateY:e.plotTop+e.plotHeight/2,scaleX:.001,scaleY:.001}):o.animate({translateX:e.plotLeft,translateY:e.plotTop,scaleX:1,scaleY:1},i)}clearBounds(){this.points.forEach(t=>{delete t.bounds,delete t.insetIndex,delete t.projectedPath}),delete this.bounds}doFullTranslate(){return!(!this.isDirtyData&&!this.chart.isResizing&&this.hasRendered)}drawMapDataLabels(){s.prototype.drawDataLabels.call(this),this.dataLabelsGroup&&this.dataLabelsGroup.clip(this.chart.clipRect)}drawPoints(){const p=this,{chart:l,group:o,transformGroups:i=[]}=this,{mapView:c,renderer:d}=l;c&&((this.transformGroups=i)[0]||(i[0]=d.g().add(o)),c.insets.forEach((t,e)=>{i[e+1]||i.push(d.g().add(o))}),this.doFullTranslate()&&(this.points.forEach(t=>{const{graphic:e,shapeArgs:o}=t;t.group=i["number"==typeof t.insetIndex?t.insetIndex+1:0],e&&e.parentGroup!==t.group&&e.add(t.group),o&&l.hasRendered&&!l.styledMode&&(o.fill=this.pointAttribs(t,t.state).fill)}),u.prototype.drawPoints.apply(this),this.points.forEach(e=>{const r=e.graphic;if(r){const n=r.animate;let t="";e.name&&(t+="highcharts-name-"+e.name.replace(/ /g,"-").toLowerCase()),e.properties&&e.properties["hc-key"]&&(t+=" highcharts-key-"+e.properties["hc-key"].toString().toLowerCase()),t&&r.addClass(t),l.styledMode&&r.css(this.pointAttribs(e,e.selected?"select":void 0)),r.animate=function(t,e,o){var i=v(t["stroke-width"])&&!v(r["stroke-width"]),s=v(r["stroke-width"])&&!v(t["stroke-width"]);if(i||s){const n=T(p.getStrokeWidth(p.options),1)/(l.mapView&&l.mapView.getScale()||1);i&&(r["stroke-width"]=n),s&&(t["stroke-width"]=n)}return n.call(r,t,e,s?function(){r.element.removeAttribute("stroke-width"),delete r["stroke-width"],o&&o.apply(this,arguments)}:o)}}})),i.forEach((o,t)=>{const i=(0===t?c:c.insets[t-1]).getSVGTransform(),s=T(this.getStrokeWidth(this.options),1),r=i.scaleX,n=0<i.scaleY?1:-1,a=i=>{(p.points||[]).forEach(t=>{const e=t.graphic;let o;e&&e["stroke-width"]&&(o=this.getStrokeWidth(t.options))&&e.attr({"stroke-width":o/i})})};if(d.globalAnimation&&l.hasRendered&&c.allowTransformAnimation){const p=Number(o.attr("translateX")),c=Number(o.attr("translateY")),h=Number(o.attr("scaleX")),e=(t,e)=>{t=h+(r-h)*e.pos,o.attr({translateX:p+(i.translateX-p)*e.pos,translateY:c+(i.translateY-c)*e.pos,scaleX:t,scaleY:t*n,"stroke-width":s/t}),a(t)};if(t={},"boolean"!=typeof(t=l.options.chart?w({},l.options.chart.animation):t)){const p=t.step;t.step=function(t){p&&p.apply(this,arguments),e.apply(this,arguments)}}o.attr({animator:0}).animate({animator:1},t,function(){"boolean"!=typeof d.globalAnimation&&d.globalAnimation.complete&&d.globalAnimation.complete({applyDrilldown:!0})})}else o.attr(w(i,{"stroke-width":s/r})),a(r)}),this.isDrilling||this.drawMapDataLabels())}getProjectedBounds(){if(!this.bounds&&this.chart.mapView){const{insets:s,projection:r}=this.chart.mapView,t=[];(this.points||[]).forEach(function(e){if(e.path||e.geometry){if("string"==typeof e.path?e.path=l(e.path):x(e.path)&&"M"===e.path[0]&&(e.path=a.prototype.pathToSegments(e.path)),!e.bounds){let t=e.getProjectedBounds(r);if(t){e.labelrank=T(e.labelrank,(t.x2-t.x1)*(t.y2-t.y1));const{midX:r,midY:o}=t;if(s&&v(r)&&v(o)){const i=g(s,t=>t.isInside({x:r,y:o}));i&&(delete e.projectedPath,(t=e.getProjectedBounds(i.projection))&&i.allBounds.push(t),e.insetIndex=s.indexOf(i))}e.bounds=t}}e.bounds&&void 0===e.insetIndex&&t.push(e.bounds)}}),this.bounds=n.compositeBounds(t)}return this.bounds}getStrokeWidth(t){var e=this.pointAttrToOptions;return t[e&&e["stroke-width"]||"borderWidth"]}hasData(){return!!this.processedXData.length}pointAttribs(t,e){var o;const{mapView:i,styledMode:s}=t.series.chart,r=s?this.colorAttribs(t):u.prototype.pointAttribs.call(this,t,e);let n=this.getStrokeWidth(t.options);if(e){e=w(this.options.states[e],t.options.states&&t.options.states[e]||{});const i=this.getStrokeWidth(e);j(i)&&(n=i),r.stroke=null!=(o=e.borderColor)?o:t.color}return n&&i&&(n/=i.getScale()),o=this.getStrokeWidth(this.options),r.dashstyle&&i&&v(o)&&(n=o/i.getScale()),t.visible||(r.fill=this.options.nullColor),j(n)?r["stroke-width"]=n:delete r["stroke-width"],r["stroke-linecap"]=r["stroke-linejoin"]=this.options.linecap,r}updateData(){return!this.processedData&&super.updateData.apply(this,arguments)}setData(t,e=!0,o,i){delete this.bounds,super.setData.call(this,t,!1,void 0,i),this.processData(),this.generatePoints(),e&&this.chart.redraw(o)}processData(){const s=this.options,t=s.data;var e=this.chart.options.chart;const r=this.joinBy,n=s.keys||this.pointArrayMap,o=[],i={};var a=(a=this.chart.mapView)&&(b(s.mapData,!0)?a.getGeoMap(s.mapData):a.geoMap),h=this.chart.mapTransforms;(this.chart.mapTransforms=h=e.mapTransforms||a&&a["hc-transform"]||h)&&P(h,function(t){t.rotation&&(t.cosAngle=Math.cos(t.rotation),t.sinAngle=Math.sin(t.rotation))});let p;x(s.mapData)?p=s.mapData:a&&"FeatureCollection"===a.type&&(this.mapTitle=a.title,p=c.geojson(a,this.type,this));const l=this.processedData=[];if(t&&t.forEach(function(e,o){let i=0;if(v(e))l[o]={value:e};else if(x(e)){l[o]={},!s.keys&&e.length>n.length&&"string"==typeof e[0]&&(l[o]["hc-key"]=e[0],++i);for(let t=0;t<n.length;++t,++i)n[t]&&void 0!==e[i]&&(0<n[t].indexOf(".")?d.prototype.setNestedProperty(l[o],e[i],n[t]):l[o][n[t]]=e[i])}else l[o]=t[o];r&&"_i"===r[0]&&(l[o]._i=o)}),p){for(this.mapData=p,this.mapMap={},h=0;h<p.length;h++)a=(e=p[h]).properties,e._i=h,r[0]&&a&&a[r[0]]&&(e[r[0]]=a[r[0]]),i[e[r[0]]]=e;if(this.mapMap=i,r[1]){const s=r[1];l.forEach(function(t){t=M(s,t),i[t]&&o.push(i[t])})}if(s.allAreas){if(r[1]){const s=r[1];l.forEach(function(t){o.push(M(s,t))})}const s="|"+o.map(function(t){return t&&t[r[0]]}).join("|")+"|";p.forEach(function(t){r[0]&&-1!==s.indexOf("|"+t[r[0]]+"|")||l.push(w(t,{value:null}))})}}this.processedXData=Array(l.length)}setOptions(t){let e=(t=s.prototype.setOptions.call(this,t)).joinBy;return null===e&&(e="_i"),(e=this.joinBy=C(e))[1]||(e[1]=e[0]),t}translate(){const o=this.doFullTranslate(),i=this.chart.mapView,s=i&&i.projection;if(!this.chart.hasRendered||!this.isDirtyData&&this.hasRendered||(this.processData(),this.generatePoints(),delete this.bounds,!i||i.userOptions.center||v(i.userOptions.zoom)||i.zoom!==i.minZoom?this.getProjectedBounds():i.fitToBounds(void 0,void 0,!1)),i){const r=i.getSVGTransform();this.points.forEach(function(t){var e=v(t.insetIndex)&&i.insets[t.insetIndex].getSVGTransform()||r;e&&t.bounds&&v(t.bounds.midX)&&v(t.bounds.midY)&&(t.plotX=t.bounds.midX*e.scaleX+e.translateX,t.plotY=t.bounds.midY*e.scaleY+e.translateY),o&&(t.shapeType="path",t.shapeArgs={d:d.getProjectedPath(t,s)}),t.projectedPath&&!t.projectedPath.length?t.setVisible(!1):t.setVisible(!0)})}y(this,"afterTranslate")}}return L.defaultOptions=w(m.defaultOptions,{affectsMapView:!0,animation:!1,dataLabels:{crop:!1,formatter:function(){const t=this.series.chart["numberFormatter"],e=this.point["value"];return v(e)?t(e,-1):""},inside:!0,overflow:!1,padding:0,verticalAlign:"middle"},linecap:"round",marker:null,nullColor:"#f7f7f7",stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:"{point.name}: {point.value}<br/>"},turboThreshold:0,allAreas:!0,borderColor:"#e6e6e6",borderWidth:1,joinBy:"hc-key",states:{hover:{halo:void 0,borderColor:"#666666",borderWidth:2},normal:{animation:!0},select:{color:"#cccccc"}},legendSymbol:"rectangle"}),f(L.prototype,{type:"map",axisTypes:e.seriesMembers.axisTypes,colorAttribs:e.seriesMembers.colorAttribs,colorKey:e.seriesMembers.colorKey,directTouch:!0,drawDataLabels:t,drawGraph:t,forceDL:!0,getCenter:o.getCenter,getExtremesFromAll:!0,getSymbol:t,isCartesian:!1,parallelArrays:e.seriesMembers.parallelArrays,pointArrayMap:e.seriesMembers.pointArrayMap,pointClass:d,preserveAspectRatio:!0,searchPoint:t,trackerGroups:e.seriesMembers.trackerGroups,useMapGeometry:!0}),e.compose(L),r.registerSeriesType("map",L),L}),e(t,"Series/FlowMap/FlowMapSeries.js",[t["Series/FlowMap/FlowMapPoint.js"],t["Series/Map/MapSeries.js"],t["Core/Series/SeriesRegistry.js"],t["Core/Utilities.js"]],function(t,o,e,i){const{series:{prototype:{pointClass:d}},seriesTypes:{column:s,mapline:r}}=e,{addEvent:u,arrayMax:n,arrayMin:a,defined:v,extend:h,isArray:m,merge:b,pick:w,relativeLength:P}=i;class T extends r{constructor(){super(...arguments),this.centerOfPoints=this.greatestWeight=this.smallestWeight=this.points=this.options=this.data=void 0}static getLength(t,e){return Math.sqrt(t*t+e*e)}static normalize(t,e){var o=this.getLength(t,e);return[t/o,e/o]}static markerEndPath(t,e,o,i){var s,r,n,a,h=P(i.width||0,this.getLength(e[0]-t[0],e[1]-t[1])),p=i.markerType||"arrow",[l,c]=this.normalize(e[0]-t[0],e[1]-t[1]);return i=[],"arrow"===p&&([s,r]=t,i.push(["L",s-=l*h,r-=c*h]),i.push(["L",o[0],o[1]]),[s,r]=e,i.push(["L",s+=l*h,r+=c*h])),"mushroom"===p&&([s,r]=t,[p,n]=e,[o,a]=o,e=2*(o-(e=(p-s)/2+s))+e,t=2*(a-(t=(n-r)/2+r))+t,i.push(["L",s-=l*h,r-=c*h]),i.push(["Q",e,t,p+=l*h,n+=c*h])),i}animate(t){const e=this.points;t||e.forEach(t=>{if(t.shapeArgs&&m(t.shapeArgs.d)&&t.shapeArgs.d.length){var o=t.shapeArgs.d,i=o[0][1],s=o[0][2];if(i&&s){const r=[];for(let e=0;e<o.length;e++){r.push([...o[e]]);for(let t=1;t<o[e].length;t++)r[e][t]=t%2?i:s}t.graphic&&(t.graphic.attr({d:r}),t.graphic.animate({d:o}))}}})}getLinkWidth(t){var e=this.options.width,o=t.options.weight||this.options.weight;if(t.options.weight=o,e&&!o)return e;if(t=this.smallestWeight,e=this.greatestWeight,!v(o)||!t||!e)return 0;var i=this.options.minWidth;return(o-t)*(this.options.maxWidth-i)/(e-t||1)+i}autoCurve(t,e,o,i,s,r){var n=o-t,a=i-e;return t=(o-t)/2+t-s,e=(i-e)/2+e-r,n=(n=(n=180*(n=Math.atan2(n*e-a*t,n*t+a*e))/Math.PI)<0?360+n:n)*Math.PI/180,.7*-Math.sin(n)}pointAttribs(t,e){return(e=o.prototype.pointAttribs.call(this,t,e)).fill=w(t.options.fillColor,t.options.color,"none"===this.options.fillColor?null:this.options.fillColor,this.color),e["fill-opacity"]=w(t.options.fillOpacity,this.options.fillOpacity),e["stroke-width"]=w(t.options.lineWidth,this.options.lineWidth,1),t.options.opacity&&(e.opacity=t.options.opacity),e}translate(){!this.chart.hasRendered||!this.isDirtyData&&this.hasRendered||(this.processData(),this.generatePoints());const p=[];let l=0,c=0;this.points.forEach(t=>{const e=this.chart,o=e.mapView,i=t.options,s=()=>{t.series.isDirty=!0},r=t=>{if((t=e.get(t))instanceof d&&t.plotX&&t.plotY)return u(t,"update",s),{x:t.plotX,y:t.plotY}},n=t=>m(t)?{lon:t[0],lat:t[1]}:t;let a,h;"string"==typeof i.from?a=r(i.from):"object"==typeof i.from&&o&&(a=o.lonLatToPixels(n(i.from))),"string"==typeof i.to?h=r(i.to):"object"==typeof i.to&&o&&(h=o.lonLatToPixels(n(i.to))),t.fromPos=a,t.toPos=h,a&&h&&(l+=(a.x+h.x)/2,c+=(a.y+h.y)/2),w(t.options.weight,this.options.weight)&&p.push(w(t.options.weight,this.options.weight))}),this.smallestWeight=a(p),this.greatestWeight=n(p),this.centerOfPoints={x:l/this.points.length,y:c/this.points.length},this.points.forEach(t=>{this.getLinkWidth(t)?(t.fromPos&&(t.plotX=t.fromPos.x,t.plotY=t.fromPos.y),t.shapeType="path",t.shapeArgs=this.getPointShapeArgs(t),t.color=w(t.options.color,t.series.color)):t.shapeArgs={d:[]}})}getPointShapeArgs(t){var{fromPos:e,toPos:o}=t;if(!e||!o)return{};var i=this.getLinkWidth(t)/2,s=t.options,r=b(this.options.markerEnd,s.markerEnd),n=w(s.growTowards,this.options.growTowards),a=e.x||0,e=e.y||0,h=o.x||0,p=o.y||0,s=w(s.curveFactor,this.options.curveFactor),l=r&&r.enabled&&r.height||0;if(v(s)||(s=this.autoCurve(a,e,h,p,this.centerOfPoints.x,this.centerOfPoints.y)),l){var l=P(l,4*i),c=a+(u=.5*(h-a)),d=e+(m=.5*(p-e));const t=u;var u=m,m=-t,[f,g]=T.normalize(c+u*s-h,d+m*s-p);h+=f*=l,p+=g*=l}d=a+(c=.5*(h-a)),u=e+(l=.5*(p-e)),m=c,c=l,l=-m;let[y,M]=T.normalize(c,l),[x,j]=(m=1+.25*Math.sqrt(s*s),y*=i*m,M*=i*m,c=d+c*s,s=u+l*s,T.normalize(c-a,s-e));m=x,x=j*i,j=-m*i;var[f,g]=T.normalize(c-h,s-p);return m=f,f=-g*i,g=m*i,n&&(x/=i,j/=i,y/=4,M/=4),i={d:[["M",a-x,e-j],["Q",c-y,s-M,h-f,p-g],["L",h+f,p+g],["Q",c+y,s+M,a+x,e+j],["Z"]]},r&&r.enabled&&i.d&&(r=T.markerEndPath([h-f,p-g],[h+f,p+g],[o.x,o.y],r),i.d.splice(2,0,...r)),p=t.options.from,h=t.options.to,r=p.lat,p=p.lon,n=h.lat,h=h.lon,r&&p&&(t.options.from=+r+", "+ +p),n&&h&&(t.options.to=+n+", "+ +h),i}}return T.defaultOptions=b(r.defaultOptions,{animation:!0,dataLabels:{enabled:!1},fillOpacity:.5,markerEnd:{enabled:!0,height:"40%",width:"40%",markerType:"arrow"},width:1,maxWidth:25,minWidth:5,lineWidth:void 0,tooltip:{headerFormat:'<span style="font-size: 0.8em">{series.name}</span><br/>',pointFormat:"{point.options.from} → {point.options.to}: <b>{point.options.weight}</b>"}}),h(T.prototype,{pointClass:t,pointArrayMap:["from","to","weight"],drawPoints:s.prototype.drawPoints,useMapGeometry:!0}),e.registerSeriesType("flowmap",T),T}),e(t,"masters/modules/flowmap.src.js",[],function(){})});